<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>一个简单的区块链货币，python实现 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="一个简单的区块链货币，python实现" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="点击上方“程序人生”，选择“置顶公众号” 第一时间关注程序猿（媛）身边的故事 图片来源：哈利波特 作者 Vincent__Law 原文 https://blog.csdn.net/vincent__law/article/details/79606357 版权归原作者所有，如需转载，请联系原作者。 区块链的特点和定义，有很多资料可以查询。但对于程序员，代码对于加深理解有着非常大的作用，以下代码为python实现的一个区块链货币，用来帮助理解。代码中配有注释，copy下来可以直接run，测试代码在最后。 理解前提：理解区块链的“账本”的比喻，基于区块链的电子货币的概念，“挖矿”。 源码同时放到了我的github上。 Github（https://github.com/Warmriver/blockChainHW） import hashlib &nbsp;import random &nbsp;import time &nbsp; &nbsp;# 区块链中交易 &nbsp;class Transaction: &nbsp; &nbsp; &nbsp;def __init__(self, from_addr, to_addr, amount): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp; &nbsp; &nbsp;fromAddr: 交易的发起人的地址 &nbsp; &nbsp; &nbsp; &nbsp;toAdddr: 交易的收款人的地址 &nbsp; &nbsp; &nbsp; &nbsp;amount: 交易金额 &nbsp; &nbsp; &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.from_addr = from_addr &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.to_addr = to_addr &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.amount = amount &nbsp; &nbsp; &nbsp;def __str__(self): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return str(self.from_addr) + &quot; send &quot; + str(self.amount) + &quot; to &quot; + str(self.to_addr) &nbsp; &nbsp;class Block: &nbsp; &nbsp; &nbsp;def __init__(self, transactions, timestamp, data = &#39;&#39;, previous_hash = &#39;0&#39;, nonce = 0): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp; &nbsp; &nbsp;transactions:交易列表，实际应用时并不能这么传递，因为交易的量很很大 &nbsp; &nbsp; &nbsp; &nbsp;timestamp:时间戳 &nbsp; &nbsp; &nbsp; &nbsp;data:数据 &nbsp; &nbsp; &nbsp; &nbsp;nonce:随机数，使用这个数字的改变来更改block的hash值 &nbsp; &nbsp; &nbsp; &nbsp;previous_hash:上一个模块的hash值 &nbsp; &nbsp; &nbsp; &nbsp;hash:模块的hash值 &nbsp; &nbsp; &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.transactions = transactions &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.timestamp = timestamp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.data = data &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.previous_hash = previous_hash &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.nonce = nonce &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.hash = self.calculate_block_hash() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# 计算hash值，上一个block的hash值也在材料中 &nbsp; &nbsp; &nbsp;def calculate_block_hash(self): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;combination = str(self.timestamp) + str(self.data) + str(self.previous_hash) + str(self.nonce) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for trans in self.transactions: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;combination += str(trans) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return hashlib.sha256(bytes(combination,&#39;utf-8&#39;)).hexdigest() &nbsp; &nbsp; &nbsp;# 挖掘，为了限制用户节点的挖掘能力，增加proof of work机制，增加挖掘的难度，difficulty越大，hash碰撞越难 &nbsp; &nbsp; &nbsp;def mineblock(self,difficult): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;start = 0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;while [v for v in self.hash[start:difficult]] != [&#39;0&#39; for v in range(start, difficult)]: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# while [v for v in self.hash[start:difficult]] != [&#39;0&#39; for v in range(start, difficult)]: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.nonce += 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.hash = self.calculate_block_hash() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;print(&quot;挖到了一个 block，&quot;+self.hash+&quot;,difficulty为&quot;, difficult) &nbsp;# 区块链 &nbsp;class BlockChain: &nbsp; &nbsp; &nbsp;def __init__(self): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp; &nbsp; &nbsp;diffculty:难度 &nbsp; &nbsp; &nbsp; &nbsp;chain:区块链，这里用数组表示 &nbsp; &nbsp; &nbsp; &nbsp;pending_transactions:等待被挖掘的交易列表 &nbsp; &nbsp; &nbsp; &nbsp;reward_coin:奖励金，对记账用户的奖励，即区块链货币，设置为一个block奖励1.2个， &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;单一用户修改此项并不会生效，因为每个人都有账本，必须说服多数派，拥有大于百分之50的同意。 &nbsp; &nbsp; &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.difficult = 3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.chain = [self.genesis_block()] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.pending_transactions = [] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.reward_coin = 1.2 &nbsp; &nbsp; &nbsp;# 创世块 &nbsp; &nbsp; &nbsp;def genesis_block(self): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;first_transaction = Transaction(&quot;24monkey&quot;, &quot;24monkey&quot;, 50) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return Block([first_transaction], int(time.time()),&quot;创世模块&quot;) &nbsp; &nbsp; &nbsp;# 获得区块链最新的block &nbsp; &nbsp; &nbsp;def get_latest_block(self): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return self.chain[len(self.chain) - 1] &nbsp; &nbsp; &nbsp;# 记录交易 &nbsp; &nbsp; &nbsp;def transaction_record(self, transaction): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.pending_transactions.append(transaction) &nbsp; &nbsp; &nbsp;# 对区块链中行为进行交易，mining &nbsp; &nbsp; &nbsp;def mine_pending_transactions(self, reward_addr): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;new_block = Block(self.pending_transactions, int(time.time()), ) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;new_block.mineblock(self.difficult) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;print(&quot;成功记录一笔交易，挖到了一个block&quot;) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.chain.append(new_block) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.pending_transactions = [Transaction(&#39;&#39;, reward_addr, self.reward_coin)] &nbsp; &nbsp; &nbsp;# 增加block &nbsp; &nbsp; &nbsp;def add_block(self, block): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;block.previous_hash = self.get_latest_block().hash &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;block.mineblock(self.difficult) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.chain.append(block) &nbsp; &nbsp; &nbsp;# 获得一个账户的balance &nbsp; &nbsp; &nbsp;def get_balance(self, addr): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;balance = 0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for block in self.chain: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for transaction in block.transactions: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if transaction.from_addr == addr: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;balance -= transaction.amount &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;elif transaction.to_addr == addr: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;balance += transaction.amount &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return balance &nbsp; &nbsp; &nbsp;# 账本是否本篡改，篡改者需要篡改所有的block且说服他人，篡改很困难 &nbsp; &nbsp; &nbsp;def check_chain_validity(self): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for i in range(1,len(self.chain)): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;current_block = self.chain[i] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;previous_block = self.chain[i-1] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(current_block.hash != current_block.calculate_block_hash()): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return False &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(current_block.previous_hash != previous_block.hash): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return False &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return True &nbsp;def time_s(): &nbsp; &nbsp; &nbsp;return int(time.time()) &nbsp; &nbsp; &nbsp;if __name__ == &#39;__main__&#39;: &nbsp; &nbsp; &nbsp;# 初始化一个区块链 &nbsp; &nbsp; &nbsp;vin_coin = BlockChain() &nbsp; &nbsp; &nbsp;# 两笔交易 &nbsp; &nbsp; &nbsp;trans_a = Transaction(&quot;shiki_addr&quot;, &quot;vincent_addr&quot;, 44) &nbsp; &nbsp; &nbsp;trans_b = Transaction(&quot;vincent_addr&quot;, &quot;shiki_addr&quot;, 44) &nbsp; &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp;测试挖矿，proof of work的难度测试 &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp; &nbsp;vin_coin.add_block(Block([trans_a], time_s(), {&quot; reason &quot; : &quot; I owed you&quot;})) &nbsp; &nbsp; &nbsp;vin_coin.add_block(Block([trans_b], time_s(), {&quot; reason &quot; : &quot; I gave it back to you cause I love you&quot;})) &nbsp; &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp;测试篡改数据的测试 &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp; &nbsp;print(&quot;vin币chain合法吗？&quot;, vin_coin.check_chain_validity()) &nbsp; &nbsp; &nbsp;vin_coin.chain[1].transactions[0].amount = 40 &nbsp; &nbsp; &nbsp;# 修改一个block后，重新计算这个block的hash，并不能成功 &nbsp; &nbsp; &nbsp;vin_coin.chain[1].hash = vin_coin.chain[1].calculate_block_hash() &nbsp; &nbsp; &nbsp;print(&quot;vin币chain合法吗？&quot;, vin_coin.check_chain_validity()) &nbsp; &nbsp; &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp;测试vin币奖励机制 &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp; &nbsp;vin_coin.transaction_record(trans_a) &nbsp; &nbsp; &nbsp;vin_coin.transaction_record(trans_b) &nbsp; &nbsp; &nbsp;vin_coin.mine_pending_transactions(&quot;记录者1&quot;) &nbsp; &nbsp; &nbsp;# 由于记录者1获得奖励的事件还没有入账，所以查不到 &nbsp; &nbsp; &nbsp;print(&quot;记录者1的账户: &quot;, vin_coin.get_balance(&quot;记录者1&quot;)) &nbsp; &nbsp; &nbsp;# 记录者2确认了记录者1的行为，记录者1的账户余额不足 &nbsp; &nbsp; &nbsp;vin_coin.mine_pending_transactions(&quot;记录者2&quot;) &nbsp; &nbsp; &nbsp;print(&quot;记录者1的账户: &quot;, vin_coin.get_balance(&quot;记录者1&quot;)) - The End - 点击图片get往期内容 阅读更多" />
<meta property="og:description" content="点击上方“程序人生”，选择“置顶公众号” 第一时间关注程序猿（媛）身边的故事 图片来源：哈利波特 作者 Vincent__Law 原文 https://blog.csdn.net/vincent__law/article/details/79606357 版权归原作者所有，如需转载，请联系原作者。 区块链的特点和定义，有很多资料可以查询。但对于程序员，代码对于加深理解有着非常大的作用，以下代码为python实现的一个区块链货币，用来帮助理解。代码中配有注释，copy下来可以直接run，测试代码在最后。 理解前提：理解区块链的“账本”的比喻，基于区块链的电子货币的概念，“挖矿”。 源码同时放到了我的github上。 Github（https://github.com/Warmriver/blockChainHW） import hashlib &nbsp;import random &nbsp;import time &nbsp; &nbsp;# 区块链中交易 &nbsp;class Transaction: &nbsp; &nbsp; &nbsp;def __init__(self, from_addr, to_addr, amount): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp; &nbsp; &nbsp;fromAddr: 交易的发起人的地址 &nbsp; &nbsp; &nbsp; &nbsp;toAdddr: 交易的收款人的地址 &nbsp; &nbsp; &nbsp; &nbsp;amount: 交易金额 &nbsp; &nbsp; &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.from_addr = from_addr &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.to_addr = to_addr &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.amount = amount &nbsp; &nbsp; &nbsp;def __str__(self): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return str(self.from_addr) + &quot; send &quot; + str(self.amount) + &quot; to &quot; + str(self.to_addr) &nbsp; &nbsp;class Block: &nbsp; &nbsp; &nbsp;def __init__(self, transactions, timestamp, data = &#39;&#39;, previous_hash = &#39;0&#39;, nonce = 0): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp; &nbsp; &nbsp;transactions:交易列表，实际应用时并不能这么传递，因为交易的量很很大 &nbsp; &nbsp; &nbsp; &nbsp;timestamp:时间戳 &nbsp; &nbsp; &nbsp; &nbsp;data:数据 &nbsp; &nbsp; &nbsp; &nbsp;nonce:随机数，使用这个数字的改变来更改block的hash值 &nbsp; &nbsp; &nbsp; &nbsp;previous_hash:上一个模块的hash值 &nbsp; &nbsp; &nbsp; &nbsp;hash:模块的hash值 &nbsp; &nbsp; &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.transactions = transactions &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.timestamp = timestamp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.data = data &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.previous_hash = previous_hash &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.nonce = nonce &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.hash = self.calculate_block_hash() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# 计算hash值，上一个block的hash值也在材料中 &nbsp; &nbsp; &nbsp;def calculate_block_hash(self): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;combination = str(self.timestamp) + str(self.data) + str(self.previous_hash) + str(self.nonce) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for trans in self.transactions: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;combination += str(trans) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return hashlib.sha256(bytes(combination,&#39;utf-8&#39;)).hexdigest() &nbsp; &nbsp; &nbsp;# 挖掘，为了限制用户节点的挖掘能力，增加proof of work机制，增加挖掘的难度，difficulty越大，hash碰撞越难 &nbsp; &nbsp; &nbsp;def mineblock(self,difficult): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;start = 0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;while [v for v in self.hash[start:difficult]] != [&#39;0&#39; for v in range(start, difficult)]: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# while [v for v in self.hash[start:difficult]] != [&#39;0&#39; for v in range(start, difficult)]: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.nonce += 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.hash = self.calculate_block_hash() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;print(&quot;挖到了一个 block，&quot;+self.hash+&quot;,difficulty为&quot;, difficult) &nbsp;# 区块链 &nbsp;class BlockChain: &nbsp; &nbsp; &nbsp;def __init__(self): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp; &nbsp; &nbsp;diffculty:难度 &nbsp; &nbsp; &nbsp; &nbsp;chain:区块链，这里用数组表示 &nbsp; &nbsp; &nbsp; &nbsp;pending_transactions:等待被挖掘的交易列表 &nbsp; &nbsp; &nbsp; &nbsp;reward_coin:奖励金，对记账用户的奖励，即区块链货币，设置为一个block奖励1.2个， &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;单一用户修改此项并不会生效，因为每个人都有账本，必须说服多数派，拥有大于百分之50的同意。 &nbsp; &nbsp; &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.difficult = 3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.chain = [self.genesis_block()] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.pending_transactions = [] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.reward_coin = 1.2 &nbsp; &nbsp; &nbsp;# 创世块 &nbsp; &nbsp; &nbsp;def genesis_block(self): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;first_transaction = Transaction(&quot;24monkey&quot;, &quot;24monkey&quot;, 50) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return Block([first_transaction], int(time.time()),&quot;创世模块&quot;) &nbsp; &nbsp; &nbsp;# 获得区块链最新的block &nbsp; &nbsp; &nbsp;def get_latest_block(self): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return self.chain[len(self.chain) - 1] &nbsp; &nbsp; &nbsp;# 记录交易 &nbsp; &nbsp; &nbsp;def transaction_record(self, transaction): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.pending_transactions.append(transaction) &nbsp; &nbsp; &nbsp;# 对区块链中行为进行交易，mining &nbsp; &nbsp; &nbsp;def mine_pending_transactions(self, reward_addr): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;new_block = Block(self.pending_transactions, int(time.time()), ) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;new_block.mineblock(self.difficult) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;print(&quot;成功记录一笔交易，挖到了一个block&quot;) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.chain.append(new_block) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.pending_transactions = [Transaction(&#39;&#39;, reward_addr, self.reward_coin)] &nbsp; &nbsp; &nbsp;# 增加block &nbsp; &nbsp; &nbsp;def add_block(self, block): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;block.previous_hash = self.get_latest_block().hash &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;block.mineblock(self.difficult) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.chain.append(block) &nbsp; &nbsp; &nbsp;# 获得一个账户的balance &nbsp; &nbsp; &nbsp;def get_balance(self, addr): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;balance = 0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for block in self.chain: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for transaction in block.transactions: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if transaction.from_addr == addr: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;balance -= transaction.amount &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;elif transaction.to_addr == addr: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;balance += transaction.amount &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return balance &nbsp; &nbsp; &nbsp;# 账本是否本篡改，篡改者需要篡改所有的block且说服他人，篡改很困难 &nbsp; &nbsp; &nbsp;def check_chain_validity(self): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for i in range(1,len(self.chain)): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;current_block = self.chain[i] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;previous_block = self.chain[i-1] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(current_block.hash != current_block.calculate_block_hash()): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return False &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(current_block.previous_hash != previous_block.hash): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return False &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return True &nbsp;def time_s(): &nbsp; &nbsp; &nbsp;return int(time.time()) &nbsp; &nbsp; &nbsp;if __name__ == &#39;__main__&#39;: &nbsp; &nbsp; &nbsp;# 初始化一个区块链 &nbsp; &nbsp; &nbsp;vin_coin = BlockChain() &nbsp; &nbsp; &nbsp;# 两笔交易 &nbsp; &nbsp; &nbsp;trans_a = Transaction(&quot;shiki_addr&quot;, &quot;vincent_addr&quot;, 44) &nbsp; &nbsp; &nbsp;trans_b = Transaction(&quot;vincent_addr&quot;, &quot;shiki_addr&quot;, 44) &nbsp; &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp;测试挖矿，proof of work的难度测试 &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp; &nbsp;vin_coin.add_block(Block([trans_a], time_s(), {&quot; reason &quot; : &quot; I owed you&quot;})) &nbsp; &nbsp; &nbsp;vin_coin.add_block(Block([trans_b], time_s(), {&quot; reason &quot; : &quot; I gave it back to you cause I love you&quot;})) &nbsp; &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp;测试篡改数据的测试 &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp; &nbsp;print(&quot;vin币chain合法吗？&quot;, vin_coin.check_chain_validity()) &nbsp; &nbsp; &nbsp;vin_coin.chain[1].transactions[0].amount = 40 &nbsp; &nbsp; &nbsp;# 修改一个block后，重新计算这个block的hash，并不能成功 &nbsp; &nbsp; &nbsp;vin_coin.chain[1].hash = vin_coin.chain[1].calculate_block_hash() &nbsp; &nbsp; &nbsp;print(&quot;vin币chain合法吗？&quot;, vin_coin.check_chain_validity()) &nbsp; &nbsp; &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp;测试vin币奖励机制 &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp; &nbsp;vin_coin.transaction_record(trans_a) &nbsp; &nbsp; &nbsp;vin_coin.transaction_record(trans_b) &nbsp; &nbsp; &nbsp;vin_coin.mine_pending_transactions(&quot;记录者1&quot;) &nbsp; &nbsp; &nbsp;# 由于记录者1获得奖励的事件还没有入账，所以查不到 &nbsp; &nbsp; &nbsp;print(&quot;记录者1的账户: &quot;, vin_coin.get_balance(&quot;记录者1&quot;)) &nbsp; &nbsp; &nbsp;# 记录者2确认了记录者1的行为，记录者1的账户余额不足 &nbsp; &nbsp; &nbsp;vin_coin.mine_pending_transactions(&quot;记录者2&quot;) &nbsp; &nbsp; &nbsp;print(&quot;记录者1的账户: &quot;, vin_coin.get_balance(&quot;记录者1&quot;)) - The End - 点击图片get往期内容 阅读更多" />
<link rel="canonical" href="http://0.0.0.0:4000/2018/05/07/%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E5%8C%BA%E5%9D%97%E9%93%BE%E8%B4%A7%E5%B8%81-python%E5%AE%9E%E7%8E%B0.html" />
<meta property="og:url" content="http://0.0.0.0:4000/2018/05/07/%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E5%8C%BA%E5%9D%97%E9%93%BE%E8%B4%A7%E5%B8%81-python%E5%AE%9E%E7%8E%B0.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-05-07T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"点击上方“程序人生”，选择“置顶公众号” 第一时间关注程序猿（媛）身边的故事 图片来源：哈利波特 作者 Vincent__Law 原文 https://blog.csdn.net/vincent__law/article/details/79606357 版权归原作者所有，如需转载，请联系原作者。 区块链的特点和定义，有很多资料可以查询。但对于程序员，代码对于加深理解有着非常大的作用，以下代码为python实现的一个区块链货币，用来帮助理解。代码中配有注释，copy下来可以直接run，测试代码在最后。 理解前提：理解区块链的“账本”的比喻，基于区块链的电子货币的概念，“挖矿”。 源码同时放到了我的github上。 Github（https://github.com/Warmriver/blockChainHW） import hashlib &nbsp;import random &nbsp;import time &nbsp; &nbsp;# 区块链中交易 &nbsp;class Transaction: &nbsp; &nbsp; &nbsp;def __init__(self, from_addr, to_addr, amount): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp; &nbsp; &nbsp;fromAddr: 交易的发起人的地址 &nbsp; &nbsp; &nbsp; &nbsp;toAdddr: 交易的收款人的地址 &nbsp; &nbsp; &nbsp; &nbsp;amount: 交易金额 &nbsp; &nbsp; &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.from_addr = from_addr &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.to_addr = to_addr &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.amount = amount &nbsp; &nbsp; &nbsp;def __str__(self): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return str(self.from_addr) + &quot; send &quot; + str(self.amount) + &quot; to &quot; + str(self.to_addr) &nbsp; &nbsp;class Block: &nbsp; &nbsp; &nbsp;def __init__(self, transactions, timestamp, data = &#39;&#39;, previous_hash = &#39;0&#39;, nonce = 0): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp; &nbsp; &nbsp;transactions:交易列表，实际应用时并不能这么传递，因为交易的量很很大 &nbsp; &nbsp; &nbsp; &nbsp;timestamp:时间戳 &nbsp; &nbsp; &nbsp; &nbsp;data:数据 &nbsp; &nbsp; &nbsp; &nbsp;nonce:随机数，使用这个数字的改变来更改block的hash值 &nbsp; &nbsp; &nbsp; &nbsp;previous_hash:上一个模块的hash值 &nbsp; &nbsp; &nbsp; &nbsp;hash:模块的hash值 &nbsp; &nbsp; &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.transactions = transactions &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.timestamp = timestamp &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.data = data &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.previous_hash = previous_hash &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.nonce = nonce &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.hash = self.calculate_block_hash() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# 计算hash值，上一个block的hash值也在材料中 &nbsp; &nbsp; &nbsp;def calculate_block_hash(self): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;combination = str(self.timestamp) + str(self.data) + str(self.previous_hash) + str(self.nonce) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for trans in self.transactions: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;combination += str(trans) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return hashlib.sha256(bytes(combination,&#39;utf-8&#39;)).hexdigest() &nbsp; &nbsp; &nbsp;# 挖掘，为了限制用户节点的挖掘能力，增加proof of work机制，增加挖掘的难度，difficulty越大，hash碰撞越难 &nbsp; &nbsp; &nbsp;def mineblock(self,difficult): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;start = 0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;while [v for v in self.hash[start:difficult]] != [&#39;0&#39; for v in range(start, difficult)]: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# while [v for v in self.hash[start:difficult]] != [&#39;0&#39; for v in range(start, difficult)]: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.nonce += 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.hash = self.calculate_block_hash() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;print(&quot;挖到了一个 block，&quot;+self.hash+&quot;,difficulty为&quot;, difficult) &nbsp;# 区块链 &nbsp;class BlockChain: &nbsp; &nbsp; &nbsp;def __init__(self): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp; &nbsp; &nbsp;diffculty:难度 &nbsp; &nbsp; &nbsp; &nbsp;chain:区块链，这里用数组表示 &nbsp; &nbsp; &nbsp; &nbsp;pending_transactions:等待被挖掘的交易列表 &nbsp; &nbsp; &nbsp; &nbsp;reward_coin:奖励金，对记账用户的奖励，即区块链货币，设置为一个block奖励1.2个， &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;单一用户修改此项并不会生效，因为每个人都有账本，必须说服多数派，拥有大于百分之50的同意。 &nbsp; &nbsp; &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.difficult = 3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.chain = [self.genesis_block()] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.pending_transactions = [] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.reward_coin = 1.2 &nbsp; &nbsp; &nbsp;# 创世块 &nbsp; &nbsp; &nbsp;def genesis_block(self): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;first_transaction = Transaction(&quot;24monkey&quot;, &quot;24monkey&quot;, 50) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return Block([first_transaction], int(time.time()),&quot;创世模块&quot;) &nbsp; &nbsp; &nbsp;# 获得区块链最新的block &nbsp; &nbsp; &nbsp;def get_latest_block(self): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return self.chain[len(self.chain) - 1] &nbsp; &nbsp; &nbsp;# 记录交易 &nbsp; &nbsp; &nbsp;def transaction_record(self, transaction): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.pending_transactions.append(transaction) &nbsp; &nbsp; &nbsp;# 对区块链中行为进行交易，mining &nbsp; &nbsp; &nbsp;def mine_pending_transactions(self, reward_addr): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;new_block = Block(self.pending_transactions, int(time.time()), ) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;new_block.mineblock(self.difficult) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;print(&quot;成功记录一笔交易，挖到了一个block&quot;) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.chain.append(new_block) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.pending_transactions = [Transaction(&#39;&#39;, reward_addr, self.reward_coin)] &nbsp; &nbsp; &nbsp;# 增加block &nbsp; &nbsp; &nbsp;def add_block(self, block): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;block.previous_hash = self.get_latest_block().hash &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;block.mineblock(self.difficult) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;self.chain.append(block) &nbsp; &nbsp; &nbsp;# 获得一个账户的balance &nbsp; &nbsp; &nbsp;def get_balance(self, addr): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;balance = 0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for block in self.chain: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for transaction in block.transactions: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if transaction.from_addr == addr: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;balance -= transaction.amount &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;elif transaction.to_addr == addr: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;balance += transaction.amount &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return balance &nbsp; &nbsp; &nbsp;# 账本是否本篡改，篡改者需要篡改所有的block且说服他人，篡改很困难 &nbsp; &nbsp; &nbsp;def check_chain_validity(self): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for i in range(1,len(self.chain)): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;current_block = self.chain[i] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;previous_block = self.chain[i-1] &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(current_block.hash != current_block.calculate_block_hash()): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return False &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if(current_block.previous_hash != previous_block.hash): &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return False &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return True &nbsp;def time_s(): &nbsp; &nbsp; &nbsp;return int(time.time()) &nbsp; &nbsp; &nbsp;if __name__ == &#39;__main__&#39;: &nbsp; &nbsp; &nbsp;# 初始化一个区块链 &nbsp; &nbsp; &nbsp;vin_coin = BlockChain() &nbsp; &nbsp; &nbsp;# 两笔交易 &nbsp; &nbsp; &nbsp;trans_a = Transaction(&quot;shiki_addr&quot;, &quot;vincent_addr&quot;, 44) &nbsp; &nbsp; &nbsp;trans_b = Transaction(&quot;vincent_addr&quot;, &quot;shiki_addr&quot;, 44) &nbsp; &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp;测试挖矿，proof of work的难度测试 &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp; &nbsp;vin_coin.add_block(Block([trans_a], time_s(), {&quot; reason &quot; : &quot; I owed you&quot;})) &nbsp; &nbsp; &nbsp;vin_coin.add_block(Block([trans_b], time_s(), {&quot; reason &quot; : &quot; I gave it back to you cause I love you&quot;})) &nbsp; &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp;测试篡改数据的测试 &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp; &nbsp;print(&quot;vin币chain合法吗？&quot;, vin_coin.check_chain_validity()) &nbsp; &nbsp; &nbsp;vin_coin.chain[1].transactions[0].amount = 40 &nbsp; &nbsp; &nbsp;# 修改一个block后，重新计算这个block的hash，并不能成功 &nbsp; &nbsp; &nbsp;vin_coin.chain[1].hash = vin_coin.chain[1].calculate_block_hash() &nbsp; &nbsp; &nbsp;print(&quot;vin币chain合法吗？&quot;, vin_coin.check_chain_validity()) &nbsp; &nbsp; &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp;测试vin币奖励机制 &nbsp; &nbsp;&quot;&quot;&quot; &nbsp; &nbsp; &nbsp;vin_coin.transaction_record(trans_a) &nbsp; &nbsp; &nbsp;vin_coin.transaction_record(trans_b) &nbsp; &nbsp; &nbsp;vin_coin.mine_pending_transactions(&quot;记录者1&quot;) &nbsp; &nbsp; &nbsp;# 由于记录者1获得奖励的事件还没有入账，所以查不到 &nbsp; &nbsp; &nbsp;print(&quot;记录者1的账户: &quot;, vin_coin.get_balance(&quot;记录者1&quot;)) &nbsp; &nbsp; &nbsp;# 记录者2确认了记录者1的行为，记录者1的账户余额不足 &nbsp; &nbsp; &nbsp;vin_coin.mine_pending_transactions(&quot;记录者2&quot;) &nbsp; &nbsp; &nbsp;print(&quot;记录者1的账户: &quot;, vin_coin.get_balance(&quot;记录者1&quot;)) - The End - 点击图片get往期内容 阅读更多","@type":"BlogPosting","url":"http://0.0.0.0:4000/2018/05/07/%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E5%8C%BA%E5%9D%97%E9%93%BE%E8%B4%A7%E5%B8%81-python%E5%AE%9E%E7%8E%B0.html","headline":"一个简单的区块链货币，python实现","dateModified":"2018-05-07T00:00:00+08:00","datePublished":"2018-05-07T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/2018/05/07/%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E5%8C%BA%E5%9D%97%E9%93%BE%E8%B4%A7%E5%B8%81-python%E5%AE%9E%E7%8E%B0.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>

  </head>
  <body>
    <div class="wrapper">
      <header  class="without-description" >
        <h1>一个简单的区块链货币，python实现</h1>
        
        
        <ul>
            <li><a href="https://blog.uzzz.org/" target="_blank"><strong>柚子社区<br/>(国际版)</strong></a></li>
            <li><a href="https://blog.uzzz.org.cn/" target="_blank"><strong>柚子社区<br/>(国内版)</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

      <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-e2445db1a8.css"> 
 <div class="htmledit_views"> 
  <div class="rich_media_content"> 
   <p style="font-size:16px;color:rgb(62,62,62);background-color:rgb(255,255,255);text-align:center;letter-spacing:.5px;"><span style="color:rgb(136,136,136);font-size:14px;">点击上方“</span><span style="font-size:14px;color:rgb(61,170,214);">程序人生</span><span style="color:rgb(136,136,136);font-size:14px;">”，选择“置顶公众号”</span><br></p>
   <p style="font-size:16px;color:rgb(62,62,62);background-color:rgb(255,255,255);text-align:center;letter-spacing:.5px;"><span style="color:rgb(136,136,136);font-size:14px;">第一时间关注程序猿（媛）身边的故事</span></p>
   <p style="font-size:16px;color:rgb(62,62,62);background-color:rgb(255,255,255);text-align:center;letter-spacing:.5px;"><span style="color:rgb(136,136,136);font-size:14px;"></span></p>
   <p><img class="__bg_gif" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_gif/1hReHaqafaeLiacicLK0Gic8dXkdiagWCVEWUV0lK9DwYlUJ5ibK8iaib2jwibY78QKc1SYBPJvAUhSejlQaLIbZ2I3ayw/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" alt="640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1"></p>
   <p style="color:rgb(105,115,117);font-size:14px;letter-spacing:1px;background-color:rgb(254,255,255);text-align:right;line-height:2em;"><span style="background-color:rgb(255,255,255);font-family:'Optima-Regular', 'PingFangTC-light';font-size:13px;color:rgb(178,178,178);">图片来源：哈利波特</span></p>
   <p style="color:rgb(105,115,117);font-size:14px;letter-spacing:1px;background-color:rgb(254,255,255);line-height:2em;"><span style="color:rgb(204,204,204);font-size:11px;font-weight:700;letter-spacing:.5px;text-align:justify;background-color:rgb(255,255,255);font-family:'Optima-Regular', 'PingFangTC-light';"></span></p>
   <p style="color:rgb(105,115,117);font-size:14px;letter-spacing:1px;background-color:rgb(254,255,255);line-height:2em;"><span style="text-align:right;background-color:rgb(255,255,255);font-size:13px;color:rgb(61,170,214);font-family:'Optima-Regular', 'PingFangTC-light';">作者</span></p>
   <p style="color:rgb(105,115,117);font-size:14px;letter-spacing:1px;background-color:rgb(254,255,255);line-height:2em;"><span style="background-color:rgb(255,255,255);color:rgb(136,136,136);font-size:13px;text-align:right;font-family:'Optima-Regular', 'PingFangTC-light';letter-spacing:.5px;">Vincent__Law</span></p>
   <p style="color:rgb(105,115,117);font-size:14px;letter-spacing:1px;background-color:rgb(254,255,255);line-height:2em;"><span style="text-align:justify;letter-spacing:.5px;background-color:rgb(255,255,255);font-size:13px;font-family:'Optima-Regular', 'PingFangTC-light';color:rgb(61,170,214);">原文</span></p>
   <p style="color:rgb(105,115,117);font-size:14px;letter-spacing:1px;background-color:rgb(254,255,255);line-height:2em;"><span style="text-align:justify;letter-spacing:.5px;background-color:rgb(255,255,255);color:rgb(136,136,136);font-size:13px;font-family:'Optima-Regular', 'PingFangTC-light';">https://blog.csdn.net/vincent__law/article/details/79606357</span></p>
   <p style="color:rgb(105,115,117);font-size:14px;letter-spacing:1px;background-color:rgb(254,255,255);line-height:2em;"><span style="color:rgb(204,204,204);font-size:11px;font-weight:700;letter-spacing:.5px;text-align:justify;background-color:rgb(255,255,255);font-family:'Optima-Regular', 'PingFangTC-light';">版权归原作者所有，</span><span style="background-color:rgb(255,255,255);color:rgb(204,204,204);font-family:'Optima-Regular', 'PingFangTC-light';font-size:11px;font-weight:700;letter-spacing:.5px;text-align:justify;">如需转载，请联系原作者。</span></p>
   <p style="text-align:center;letter-spacing:.5px;"><br></p>
   <p style="font-size:16px;color:rgb(79,79,79);line-height:26px;text-align:justify;"><span style="font-size:15px;font-family:'Optima-Regular', 'PingFangTC-light';">区块链的特点和定义，有很多资料可以查询。但对于程序员，代码对于加深理解有着非常大的作用，以下代码为python实现的一个区块链货币，用来帮助理解。代码中配有注释，copy下来可以直接run，测试代码在最后。</span></p>
   <p style="font-size:16px;color:rgb(79,79,79);line-height:26px;text-align:justify;"><span style="font-size:15px;font-family:'Optima-Regular', 'PingFangTC-light';">理解前提：理解区块链的“账本”的比喻，基于区块链的电子货币的概念，“挖矿”。</span></p>
   <p style="font-size:16px;color:rgb(79,79,79);line-height:26px;text-align:justify;"><span style="font-size:15px;font-family:'Optima-Regular', 'PingFangTC-light';">源码同时放到了我的github上。</span></p>
   <p style="font-size:16px;color:rgb(79,79,79);line-height:26px;text-align:justify;"><span style="font-size:15px;font-family:'Optima-Regular', 'PingFangTC-light';">Github（<span style="font-family:'Optima-Regular', 'PingFangTC-light';font-size:15px;color:rgb(61,170,214);">https://github.com/Warmriver/blockChainHW</span>）</span></p>
   <pre style="background:none;"><code style="font-size:.85em;background:rgb(40,44,52);color:rgb(171,178,191);" class="hljs-default">import hashlib &nbsp;<br>import random &nbsp;<br>import time &nbsp;<br> &nbsp;<br><span class="hljs-default-comment" style="color:rgb(92,99,112);background:rgba(0,0,0,0);width:101px;font-weight:400;font-style:italic;"># 区块链中交易 &nbsp;</span><br><span class="hljs-default-class" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:144px;font-weight:400;font-style:normal;"><span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:36px;font-weight:400;font-style:normal;">class</span> <span class="hljs-default-title" style="color:rgb(230,192,123);background:rgba(0,0,0,0);width:80px;font-weight:400;font-style:normal;">Transaction</span>: &nbsp;</span><br> &nbsp; &nbsp;<span class="hljs-default-function" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:332px;font-weight:400;font-style:normal;"><span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:21px;font-weight:400;font-style:normal;">def</span> <span class="hljs-default-title" style="color:rgb(97,174,238);background:rgba(0,0,0,0);width:57px;font-weight:400;font-style:normal;">__init__</span><span class="hljs-default-params" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:246px;font-weight:400;font-style:normal;">(<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:28px;font-weight:400;font-style:normal;">self</span>, from_addr, to_addr, amount)</span></span>: &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:14px;font-weight:400;font-style:normal;">""</span><span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:245px;font-weight:400;font-style:normal;">" <br> &nbsp; &nbsp; &nbsp; &nbsp;fromAddr: 交易的发起人的地址 <br> &nbsp; &nbsp; &nbsp; &nbsp;toAdddr: 交易的收款人的地址 <br> &nbsp; &nbsp; &nbsp; &nbsp;amount: 交易金额 <br> &nbsp; &nbsp; &nbsp; &nbsp;"</span><span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:14px;font-weight:400;font-style:normal;">""</span> &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:28px;font-weight:400;font-style:normal;">self</span>.from_addr = from_addr &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:28px;font-weight:400;font-style:normal;">self</span>.to_addr = to_addr &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:28px;font-weight:400;font-style:normal;">self</span>.amount = amount &nbsp;<br> &nbsp; &nbsp;<span class="hljs-default-function" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:122px;font-weight:400;font-style:normal;"><span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:21px;font-weight:400;font-style:normal;">def</span> <span class="hljs-default-title" style="color:rgb(97,174,238);background:rgba(0,0,0,0);width:50px;font-weight:400;font-style:normal;">__str__</span><span class="hljs-default-params" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:43px;font-weight:400;font-style:normal;">(<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>)</span></span>: &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:43px;font-weight:400;font-style:normal;">return</span> str(<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>.from_addr) + <span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:58px;font-weight:400;font-style:normal;">" send "</span> + str(<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>.amount) + <span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:43px;font-weight:400;font-style:normal;">" to "</span> + str(<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>.to_addr) &nbsp;<br> &nbsp;<br><span class="hljs-default-class" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:101px;font-weight:400;font-style:normal;"><span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:36px;font-weight:400;font-style:normal;">class</span> <span class="hljs-default-title" style="color:rgb(230,192,123);background:rgba(0,0,0,0);width:36px;font-weight:400;font-style:normal;">Block</span>: &nbsp;</span><br> &nbsp; &nbsp;<span class="hljs-default-function" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:621px;font-weight:400;font-style:normal;"><span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:21px;font-weight:400;font-style:normal;">def</span> <span class="hljs-default-title" style="color:rgb(97,174,238);background:rgba(0,0,0,0);width:57px;font-weight:400;font-style:normal;">__init__</span><span class="hljs-default-params" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:535px;font-weight:400;font-style:normal;">(<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:28px;font-weight:400;font-style:normal;">self</span>, transactions, timestamp, data = <span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:15px;font-weight:400;font-style:normal;">''</span>, previous_hash = <span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:21px;font-weight:400;font-style:normal;">'0'</span>, nonce = <span class="hljs-default-number" style="color:rgb(209,154,102);background:rgba(0,0,0,0);width:8px;font-weight:400;font-style:normal;">0</span>)</span></span>: &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:14px;font-weight:400;font-style:normal;">""</span><span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:483px;font-weight:400;font-style:normal;">" <br> &nbsp; &nbsp; &nbsp; &nbsp;transactions:交易列表，实际应用时并不能这么传递，因为交易的量很很大 <br> &nbsp; &nbsp; &nbsp; &nbsp;timestamp:时间戳 <br> &nbsp; &nbsp; &nbsp; &nbsp;data:数据 <br> &nbsp; &nbsp; &nbsp; &nbsp;nonce:随机数，使用这个数字的改变来更改block的hash值 <br> &nbsp; &nbsp; &nbsp; &nbsp;previous_hash:上一个模块的hash值 <br> &nbsp; &nbsp; &nbsp; &nbsp;hash:模块的hash值 <br> &nbsp; &nbsp; &nbsp; &nbsp;"</span><span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:14px;font-weight:400;font-style:normal;">""</span> &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:28px;font-weight:400;font-style:normal;">self</span>.transactions = transactions &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:28px;font-weight:400;font-style:normal;">self</span>.timestamp = timestamp &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:28px;font-weight:400;font-style:normal;">self</span>.data = data &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:28px;font-weight:400;font-style:normal;">self</span>.previous_hash = previous_hash &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:28px;font-weight:400;font-style:normal;">self</span>.nonce = nonce &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:28px;font-weight:400;font-style:normal;">self</span>.hash = <span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>.calculate_block_hash() &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp;<span class="hljs-default-comment" style="color:rgb(92,99,112);background:rgba(0,0,0,0);width:291px;font-weight:400;font-style:italic;"># 计算hash值，上一个block的hash值也在材料中 &nbsp;</span><br> &nbsp; &nbsp;<span class="hljs-default-function" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:216px;font-weight:400;font-style:normal;"><span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:21px;font-weight:400;font-style:normal;">def</span> <span class="hljs-default-title" style="color:rgb(97,174,238);background:rgba(0,0,0,0);width:144px;font-weight:400;font-style:normal;">calculate_block_hash</span><span class="hljs-default-params" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:43px;font-weight:400;font-style:normal;">(<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>)</span></span>: &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;combination = str(<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>.timestamp) + str(<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:28px;font-weight:400;font-style:normal;">self</span>.data) + str(<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>.previous_hash) + str(<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>.nonce) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:21px;font-weight:400;font-style:normal;">for</span> trans <span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:14px;font-weight:400;font-style:normal;">in</span> <span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>.<span class="hljs-default-symbol" style="color:rgb(97,174,238);background:rgba(0,0,0,0);width:94px;font-weight:400;font-style:normal;">transactions:</span> &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;combination += str(trans) &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:43px;font-weight:400;font-style:normal;">return</span> hashlib.sha256(bytes(combination,<span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:50px;font-weight:400;font-style:normal;">'utf-8'</span>)).hexdigest() &nbsp;<br> &nbsp; &nbsp;<span class="hljs-default-comment" style="color:rgb(92,99,112);background:rgba(0,0,0,0);width:668px;font-weight:400;font-style:italic;"># 挖掘，为了限制用户节点的挖掘能力，增加proof of work机制，增加挖掘的难度，difficulty越大，hash碰撞越难 &nbsp;</span><br> &nbsp; &nbsp;<span class="hljs-default-function" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:209px;font-weight:400;font-style:normal;"><span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:21px;font-weight:400;font-style:normal;">def</span> <span class="hljs-default-title" style="color:rgb(97,174,238);background:rgba(0,0,0,0);width:65px;font-weight:400;font-style:normal;">mineblock</span><span class="hljs-default-params" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:115px;font-weight:400;font-style:normal;">(<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>,difficult)</span></span>: &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;start = <span class="hljs-default-number" style="color:rgb(209,154,102);background:rgba(0,0,0,0);width:8px;font-weight:400;font-style:normal;">0</span> &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:36px;font-weight:400;font-style:normal;">while</span> [v <span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:21px;font-weight:400;font-style:normal;">for</span> v <span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:14px;font-weight:400;font-style:normal;">in</span> <span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:28px;font-weight:400;font-style:normal;">self</span>.hash[<span class="hljs-default-symbol" style="color:rgb(97,174,238);background:rgba(0,0,0,0);width:43px;font-weight:400;font-style:normal;">start:</span>difficult]] != [<span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:21px;font-weight:400;font-style:normal;">'0'</span> <span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:21px;font-weight:400;font-style:normal;">for</span> v <span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:14px;font-weight:400;font-style:normal;">in</span> range(start, difficult)]: &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-comment" style="color:rgb(92,99,112);background:rgba(0,0,0,0);width:664px;font-weight:400;font-style:italic;"># while [v for v in self.hash[start:difficult]] != ['0' for v in range(start, difficult)]: &nbsp;</span><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>.nonce += <span class="hljs-default-number" style="color:rgb(209,154,102);background:rgba(0,0,0,0);width:7px;font-weight:400;font-style:normal;">1</span> &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>.hash = <span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>.calculate_block_hash() &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;print(<span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:130px;font-weight:400;font-style:normal;">"挖到了一个 block，"</span>+<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>.hash+<span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:106px;font-weight:400;font-style:normal;">",difficulty为"</span>, difficult) &nbsp;<br><span class="hljs-default-comment" style="color:rgb(92,99,112);background:rgba(0,0,0,0);width:65px;font-weight:400;font-style:italic;"># 区块链 &nbsp;</span><br><span class="hljs-default-class" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:137px;font-weight:400;font-style:normal;"><span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:36px;font-weight:400;font-style:normal;">class</span> <span class="hljs-default-title" style="color:rgb(230,192,123);background:rgba(0,0,0,0);width:72px;font-weight:400;font-style:normal;">BlockChain</span>: &nbsp;</span><br> &nbsp; &nbsp;<span class="hljs-default-function" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:130px;font-weight:400;font-style:normal;"><span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:21px;font-weight:400;font-style:normal;">def</span> <span class="hljs-default-title" style="color:rgb(97,174,238);background:rgba(0,0,0,0);width:57px;font-weight:400;font-style:normal;">__init__</span><span class="hljs-default-params" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:44px;font-weight:400;font-style:normal;">(<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:28px;font-weight:400;font-style:normal;">self</span>)</span></span>: &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:14px;font-weight:400;font-style:normal;">""</span><span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:682px;font-weight:400;font-style:normal;">" <br> &nbsp; &nbsp; &nbsp; &nbsp;diffculty:难度 <br> &nbsp; &nbsp; &nbsp; &nbsp;chain:区块链，这里用数组表示 <br> &nbsp; &nbsp; &nbsp; &nbsp;pending_transactions:等待被挖掘的交易列表 <br> &nbsp; &nbsp; &nbsp; &nbsp;reward_coin:奖励金，对记账用户的奖励，即区块链货币，设置为一个block奖励1.2个， <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;单一用户修改此项并不会生效，因为每个人都有账本，必须说服多数派，拥有大于百分之50的同意。 <br> &nbsp; &nbsp; &nbsp; &nbsp;"</span><span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:14px;font-weight:400;font-style:normal;">""</span> &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:28px;font-weight:400;font-style:normal;">self</span>.difficult = <span class="hljs-default-number" style="color:rgb(209,154,102);background:rgba(0,0,0,0);width:8px;font-weight:400;font-style:normal;">3</span> &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:28px;font-weight:400;font-style:normal;">self</span>.chain = [<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>.genesis_block()] &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:28px;font-weight:400;font-style:normal;">self</span>.pending_transactions = [] &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:28px;font-weight:400;font-style:normal;">self</span>.reward_coin = <span class="hljs-default-number" style="color:rgb(209,154,102);background:rgba(0,0,0,0);width:22px;font-weight:400;font-style:normal;">1.2</span> &nbsp;<br> &nbsp; &nbsp;<span class="hljs-default-comment" style="color:rgb(92,99,112);background:rgba(0,0,0,0);width:65px;font-weight:400;font-style:italic;"># 创世块 &nbsp;</span><br> &nbsp; &nbsp;<span class="hljs-default-function" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:166px;font-weight:400;font-style:normal;"><span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:21px;font-weight:400;font-style:normal;">def</span> <span class="hljs-default-title" style="color:rgb(97,174,238);background:rgba(0,0,0,0);width:93px;font-weight:400;font-style:normal;">genesis_block</span><span class="hljs-default-params" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:44px;font-weight:400;font-style:normal;">(<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>)</span></span>: &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;first_transaction = Transaction(<span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:72px;font-weight:400;font-style:normal;">"24monkey"</span>, <span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:73px;font-weight:400;font-style:normal;">"24monkey"</span>, <span class="hljs-default-number" style="color:rgb(209,154,102);background:rgba(0,0,0,0);width:15px;font-weight:400;font-style:normal;">50</span>) &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:43px;font-weight:400;font-style:normal;">return</span> Block([first_transaction], int(time.time()),<span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:62px;font-weight:400;font-style:normal;">"创世模块"</span>) &nbsp;<br> &nbsp; &nbsp;<span class="hljs-default-comment" style="color:rgb(92,99,112);background:rgba(0,0,0,0);width:161px;font-weight:400;font-style:italic;"># 获得区块链最新的block &nbsp;</span><br> &nbsp; &nbsp;<span class="hljs-default-function" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:188px;font-weight:400;font-style:normal;"><span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:21px;font-weight:400;font-style:normal;">def</span> <span class="hljs-default-title" style="color:rgb(97,174,238);background:rgba(0,0,0,0);width:115px;font-weight:400;font-style:normal;">get_latest_block</span><span class="hljs-default-params" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:44px;font-weight:400;font-style:normal;">(<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>)</span></span>: &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:43px;font-weight:400;font-style:normal;">return</span> <span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>.chain[len(<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:28px;font-weight:400;font-style:normal;">self</span>.chain) - <span class="hljs-default-number" style="color:rgb(209,154,102);background:rgba(0,0,0,0);width:7px;font-weight:400;font-style:normal;">1</span>] &nbsp;<br> &nbsp; &nbsp;<span class="hljs-default-comment" style="color:rgb(92,99,112);background:rgba(0,0,0,0);width:77px;font-weight:400;font-style:italic;"># 记录交易 &nbsp;</span><br> &nbsp; &nbsp;<span class="hljs-default-function" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:296px;font-weight:400;font-style:normal;"><span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:21px;font-weight:400;font-style:normal;">def</span> <span class="hljs-default-title" style="color:rgb(97,174,238);background:rgba(0,0,0,0);width:130px;font-weight:400;font-style:normal;">transaction_record</span><span class="hljs-default-params" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:137px;font-weight:400;font-style:normal;">(<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>, transaction)</span></span>: &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:28px;font-weight:400;font-style:normal;">self</span>.pending_transactions.append(transaction) &nbsp;<br> &nbsp; &nbsp;<span class="hljs-default-comment" style="color:rgb(92,99,112);background:rgba(0,0,0,0);width:216px;font-weight:400;font-style:italic;"># 对区块链中行为进行交易，mining &nbsp;</span><br> &nbsp; &nbsp;<span class="hljs-default-function" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:346px;font-weight:400;font-style:normal;"><span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:21px;font-weight:400;font-style:normal;">def</span> <span class="hljs-default-title" style="color:rgb(97,174,238);background:rgba(0,0,0,0);width:180px;font-weight:400;font-style:normal;">mine_pending_transactions</span><span class="hljs-default-params" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:137px;font-weight:400;font-style:normal;">(<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>, reward_addr)</span></span>: &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;new_block = Block(<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>.pending_transactions, int(time.time()), ) &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;new_block.mineblock(<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>.difficult) &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;print(<span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:219px;font-weight:400;font-style:normal;">"成功记录一笔交易，挖到了一个block"</span>) &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:28px;font-weight:400;font-style:normal;">self</span>.chain.append(new_block) &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:28px;font-weight:400;font-style:normal;">self</span>.pending_transactions = [Transaction(<span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:14px;font-weight:400;font-style:normal;">''</span>, reward_addr, <span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:28px;font-weight:400;font-style:normal;">self</span>.reward_coin)] &nbsp;<br> &nbsp; &nbsp;<span class="hljs-default-comment" style="color:rgb(92,99,112);background:rgba(0,0,0,0);width:89px;font-weight:400;font-style:italic;"># 增加block &nbsp;</span><br> &nbsp; &nbsp;<span class="hljs-default-function" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:188px;font-weight:400;font-style:normal;"><span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:21px;font-weight:400;font-style:normal;">def</span> <span class="hljs-default-title" style="color:rgb(97,174,238);background:rgba(0,0,0,0);width:65px;font-weight:400;font-style:normal;">add_block</span><span class="hljs-default-params" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:94px;font-weight:400;font-style:normal;">(<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>, block)</span></span>: &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;block.previous_hash = <span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:28px;font-weight:400;font-style:normal;">self</span>.get_latest_block().hash &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;block.mineblock(<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>.difficult) &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:28px;font-weight:400;font-style:normal;">self</span>.chain.append(block) &nbsp;<br> &nbsp; &nbsp;<span class="hljs-default-comment" style="color:rgb(92,99,112);background:rgba(0,0,0,0);width:163px;font-weight:400;font-style:italic;"># 获得一个账户的balance &nbsp;</span><br> &nbsp; &nbsp;<span class="hljs-default-function" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:195px;font-weight:400;font-style:normal;"><span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:21px;font-weight:400;font-style:normal;">def</span> <span class="hljs-default-title" style="color:rgb(97,174,238);background:rgba(0,0,0,0);width:79px;font-weight:400;font-style:normal;">get_balance</span><span class="hljs-default-params" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:87px;font-weight:400;font-style:normal;">(<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>, addr)</span></span>: &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;balance = <span class="hljs-default-number" style="color:rgb(209,154,102);background:rgba(0,0,0,0);width:7px;font-weight:400;font-style:normal;">0</span> &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:21px;font-weight:400;font-style:normal;">for</span> block <span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:14px;font-weight:400;font-style:normal;">in</span> <span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>.<span class="hljs-default-symbol" style="color:rgb(97,174,238);background:rgba(0,0,0,0);width:43px;font-weight:400;font-style:normal;">chain:</span> &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:22px;font-weight:400;font-style:normal;">for</span> transaction <span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:15px;font-weight:400;font-style:normal;">in</span> block.<span class="hljs-default-symbol" style="color:rgb(97,174,238);background:rgba(0,0,0,0);width:94px;font-weight:400;font-style:normal;">transactions:</span> &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:15px;font-weight:400;font-style:normal;">if</span> transaction.from_addr == <span class="hljs-default-symbol" style="color:rgb(97,174,238);background:rgba(0,0,0,0);width:36px;font-weight:400;font-style:normal;">addr:</span> &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;balance -= transaction.amount &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;elif transaction.to_addr == <span class="hljs-default-symbol" style="color:rgb(97,174,238);background:rgba(0,0,0,0);width:36px;font-weight:400;font-style:normal;">addr:</span> &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;balance += transaction.amount &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:43px;font-weight:400;font-style:normal;">return</span> balance &nbsp;<br> &nbsp; &nbsp;<span class="hljs-default-comment" style="color:rgb(92,99,112);background:rgba(0,0,0,0);width:413px;font-weight:400;font-style:italic;"># 账本是否本篡改，篡改者需要篡改所有的block且说服他人，篡改很困难 &nbsp;</span><br> &nbsp; &nbsp;<span class="hljs-default-function" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:216px;font-weight:400;font-style:normal;"><span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:21px;font-weight:400;font-style:normal;">def</span> <span class="hljs-default-title" style="color:rgb(97,174,238);background:rgba(0,0,0,0);width:144px;font-weight:400;font-style:normal;">check_chain_validity</span><span class="hljs-default-params" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:43px;font-weight:400;font-style:normal;">(<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>)</span></span>: &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:21px;font-weight:400;font-style:normal;">for</span> i <span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:14px;font-weight:400;font-style:normal;">in</span> range(<span class="hljs-default-number" style="color:rgb(209,154,102);background:rgba(0,0,0,0);width:7px;font-weight:400;font-style:normal;">1</span>,len(<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>.chain)): &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;current_block = <span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>.chain[i] &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;previous_block = <span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:29px;font-weight:400;font-style:normal;">self</span>.chain[i-<span class="hljs-default-number" style="color:rgb(209,154,102);background:rgba(0,0,0,0);width:7px;font-weight:400;font-style:normal;">1</span>] &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:15px;font-weight:400;font-style:normal;">if</span>(current_block.hash != current_block.calculate_block_hash()): &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:44px;font-weight:400;font-style:normal;">return</span> False &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:15px;font-weight:400;font-style:normal;">if</span>(current_block.previous_hash != previous_block.hash): &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:44px;font-weight:400;font-style:normal;">return</span> False &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:43px;font-weight:400;font-style:normal;">return</span> True &nbsp;<br><span class="hljs-default-function" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:86px;font-weight:400;font-style:normal;"><span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:21px;font-weight:400;font-style:normal;">def</span> <span class="hljs-default-title" style="color:rgb(97,174,238);background:rgba(0,0,0,0);width:43px;font-weight:400;font-style:normal;">time_s</span><span class="hljs-default-params" style="color:rgb(171,178,191);background:rgba(0,0,0,0);width:14px;font-weight:400;font-style:normal;">()</span></span>: &nbsp;<br> &nbsp; &nbsp;<span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:43px;font-weight:400;font-style:normal;">return</span> int(time.time()) &nbsp;<br> &nbsp;<br> &nbsp;<br><span class="hljs-default-keyword" style="color:rgb(198,120,221);background:rgba(0,0,0,0);width:14px;font-weight:400;font-style:normal;">if</span> __name_<span class="hljs-default-number" style="color:rgb(209,154,102);background:rgba(0,0,0,0);width:7px;font-weight:400;font-style:normal;">_</span> == <span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:72px;font-weight:400;font-style:normal;">'__main__'</span>: &nbsp;<br> &nbsp; &nbsp;<span class="hljs-default-comment" style="color:rgb(92,99,112);background:rgba(0,0,0,0);width:125px;font-weight:400;font-style:italic;"># 初始化一个区块链 &nbsp;</span><br> &nbsp; &nbsp;vin_coin = BlockChain() &nbsp;<br> &nbsp; &nbsp;<span class="hljs-default-comment" style="color:rgb(92,99,112);background:rgba(0,0,0,0);width:77px;font-weight:400;font-style:italic;"># 两笔交易 &nbsp;</span><br> &nbsp; &nbsp;trans_a = Transaction(<span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:86px;font-weight:400;font-style:normal;">"shiki_addr"</span>, <span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:101px;font-weight:400;font-style:normal;">"vincent_addr"</span>, <span class="hljs-default-number" style="color:rgb(209,154,102);background:rgba(0,0,0,0);width:15px;font-weight:400;font-style:normal;">44</span>) &nbsp;<br> &nbsp; &nbsp;trans_b = Transaction(<span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:101px;font-weight:400;font-style:normal;">"vincent_addr"</span>, <span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:87px;font-weight:400;font-style:normal;">"shiki_addr"</span>, <span class="hljs-default-number" style="color:rgb(209,154,102);background:rgba(0,0,0,0);width:15px;font-weight:400;font-style:normal;">44</span>) &nbsp;<br> &nbsp; &nbsp;<span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:14px;font-weight:400;font-style:normal;">""</span><span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:250px;font-weight:400;font-style:normal;">" <br> &nbsp; &nbsp;测试挖矿，proof of work的难度测试 <br> &nbsp; &nbsp;"</span><span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:14px;font-weight:400;font-style:normal;">""</span> &nbsp;<br> &nbsp; &nbsp;vin_coin.add_block(Block([trans_a], time_s(), {<span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:72px;font-weight:400;font-style:normal;">" reason "</span> : <span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:94px;font-weight:400;font-style:normal;">" I owed you"</span>})) &nbsp;<br> &nbsp; &nbsp;vin_coin.add_block(Block([trans_b], time_s(), {<span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:72px;font-weight:400;font-style:normal;">" reason "</span> : <span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:296px;font-weight:400;font-style:normal;">" I gave it back to you cause I love you"</span>})) &nbsp;<br> &nbsp; &nbsp;<span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:14px;font-weight:400;font-style:normal;">""</span><span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:144px;font-weight:400;font-style:normal;">" <br> &nbsp; &nbsp;测试篡改数据的测试 <br> &nbsp; &nbsp;"</span><span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:14px;font-weight:400;font-style:normal;">""</span> &nbsp;<br> &nbsp; &nbsp;print(<span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:132px;font-weight:400;font-style:normal;">"vin币chain合法吗？"</span>, vin_coin.check_chain_validity()) &nbsp;<br> &nbsp; &nbsp;vin_coin.chain[<span class="hljs-default-number" style="color:rgb(209,154,102);background:rgba(0,0,0,0);width:7px;font-weight:400;font-style:normal;">1</span>].transactions[<span class="hljs-default-number" style="color:rgb(209,154,102);background:rgba(0,0,0,0);width:7px;font-weight:400;font-style:normal;">0</span>].amount = <span class="hljs-default-number" style="color:rgb(209,154,102);background:rgba(0,0,0,0);width:15px;font-weight:400;font-style:normal;">40</span> &nbsp;<br> &nbsp; &nbsp;<span class="hljs-default-comment" style="color:rgb(92,99,112);background:rgba(0,0,0,0);width:358px;font-weight:400;font-style:italic;"># 修改一个block后，重新计算这个block的hash，并不能成功 &nbsp;</span><br> &nbsp; &nbsp;vin_coin.chain[<span class="hljs-default-number" style="color:rgb(209,154,102);background:rgba(0,0,0,0);width:7px;font-weight:400;font-style:normal;">1</span>].hash = vin_coin.chain[<span class="hljs-default-number" style="color:rgb(209,154,102);background:rgba(0,0,0,0);width:7px;font-weight:400;font-style:normal;">1</span>].calculate_block_hash() &nbsp;<br> &nbsp; &nbsp;print(<span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:132px;font-weight:400;font-style:normal;">"vin币chain合法吗？"</span>, vin_coin.check_chain_validity()) &nbsp;<br> &nbsp;<br> &nbsp; &nbsp;<span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:14px;font-weight:400;font-style:normal;">""</span><span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:142px;font-weight:400;font-style:normal;">" <br> &nbsp; &nbsp;测试vin币奖励机制 <br> &nbsp; &nbsp;"</span><span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:14px;font-weight:400;font-style:normal;">""</span> &nbsp;<br> &nbsp; &nbsp;vin_coin.transaction_record(trans_a) &nbsp;<br> &nbsp; &nbsp;vin_coin.transaction_record(trans_b) &nbsp;<br> &nbsp; &nbsp;vin_coin.mine_pending_transactions(<span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:57px;font-weight:400;font-style:normal;">"记录者1"</span>) &nbsp;<br> &nbsp; &nbsp;<span class="hljs-default-comment" style="color:rgb(92,99,112);background:rgba(0,0,0,0);width:312px;font-weight:400;font-style:italic;"># 由于记录者1获得奖励的事件还没有入账，所以查不到 &nbsp;</span><br> &nbsp; &nbsp;print(<span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:108px;font-weight:400;font-style:normal;">"记录者1的账户: "</span>, vin_coin.get_balance(<span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:58px;font-weight:400;font-style:normal;">"记录者1"</span>)) &nbsp;<br> &nbsp; &nbsp;<span class="hljs-default-comment" style="color:rgb(92,99,112);background:rgba(0,0,0,0);width:326px;font-weight:400;font-style:italic;"># 记录者2确认了记录者1的行为，记录者1的账户余额不足 &nbsp;</span><br> &nbsp; &nbsp;vin_coin.mine_pending_transactions(<span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:57px;font-weight:400;font-style:normal;">"记录者2"</span>) &nbsp;<br> &nbsp; &nbsp;print(<span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:108px;font-weight:400;font-style:normal;">"记录者1的账户: "</span>, vin_coin.get_balance(<span class="hljs-default-string" style="color:rgb(152,195,121);background:rgba(0,0,0,0);width:58px;font-weight:400;font-style:normal;">"记录者1"</span>))</code></pre>
   <p style="font-size:16px;color:rgb(62,62,62);background-color:rgb(255,255,255);text-align:center;letter-spacing:.5px;"><span style="font-size:15px;font-family:Zapfino;color:rgb(136,136,136);"><br></span></p>
   <p style="font-size:16px;color:rgb(62,62,62);background-color:rgb(255,255,255);text-align:center;letter-spacing:.5px;"><span style="font-size:15px;font-family:Zapfino;color:rgb(136,136,136);">- The End -</span></p>
   <p style="font-size:16px;color:rgb(62,62,62);letter-spacing:.5px;background-color:rgb(255,255,255);text-align:center;"><br></p>
   <p style="font-size:16px;color:rgb(62,62,62);letter-spacing:.5px;background-color:rgb(255,255,255);text-align:center;"><strong style="font-size:14px;color:rgb(2,2,2);"><strong>点击图片get往期内容</strong></strong></p>
   <p style="font-size:16px;color:rgb(62,62,62);letter-spacing:.5px;background-color:rgb(255,255,255);text-align:center;"><strong style="font-size:14px;color:rgb(2,2,2);"></strong></p>
   <p><a href="https://mp.weixin.qq.com/s?__biz=MzA5MzY4NTQwMA==&amp;mid=2651003893&amp;idx=1&amp;sn=64cb81bc7dec3abae1316d42a458eb1e&amp;chksm=8bada802bcda211470334e1065686b4b1c3028d48fb7c020619dbcf000476943a3a069dca7c6&amp;scene=21#wechat_redirect" rel="nofollow"><img class="img_loading" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_png/1hReHaqafaeLiacicLK0Gic8dXkdiagWCVEW1EiceybC9Z6vbwL4W2fbEMfVDxeibiaG2g9ATyKZEkFibib3tos4FxntRaw/640?wx_fmt=png" style="width:670px;" alt="640?wx_fmt=png"></a></p>
   <p style="font-size:16px;color:rgb(62,62,62);background-color:rgb(255,255,255);"><img class="__bg_gif img_loading" style="letter-spacing:.5px;font-size:14px;color:rgb(2,2,2);text-align:justify;width:670px;" src="https://ss.csdn.net/p?https://mmbiz.qpic.cn/mmbiz_gif/1hReHaqafaerOd463prtf1AbbmqA1xJK50Rct0FxeaKJ2zv0qsYOPayG6g2YKnzLQ5gmI1nt9PUPib6qKOB5g8Q/640?wx_fmt=gif" alt="640?wx_fmt=gif"></p> 
  </div> 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/csdnsevenn/article/details/80225770,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/csdnsevenn/article/details/80225770,&quot;}">阅读更多</a> 
</div>
      <br />
        <a href="https://blog.uzzz.org/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://blog.uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://blog.uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?ee64533f3c6a7a284cd39a37ee732c8b";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
    
    <script>
    (function(){
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        }
        else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
    </script>

  </body>
</html>
