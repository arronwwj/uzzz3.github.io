<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>一步步教小白使用C++构建区块链 | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="一步步教小白使用C++构建区块链" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="&nbsp; &nbsp; &nbsp; &nbsp; 最近你可能听说过很多关于区块链的消息，想知道大家都在谈论什么。&nbsp;区块链是一种分类账本，它的实现原理使得很难改变它所包含的数据；有人说区块链是不可改变的，它的目的是保持其正确的，不变性意味着永久性；但是硬盘上没有任何东西 永远可以被认为是永久性不变的；我们把这些哲学辩论留给非技术人员。而我现在要做的是向您展示如何使用C ++编写区块链。 区块头结构 区块链头结构 挖矿过程-工作量证明 区块HASH计算 创世块的产生 添加区块 主函数 源码下载 免责声明 本教程是参考Savjee使用NodeJS编写一篇文章; 有一段时间没有编写任何C ++代码，代码可能会有点生疏。（译者注：运行该C++程序，可以生成区块并组成区块链，也具备工作量证明POW功能） 首先要做的是打开一个新的C++项目，我使用JetBrains中的CLion，但任何C++ IDE甚至文本编辑器都可以（译者注：译者使用的是VIM）。 我们将创建TestChain项目，继续下一步创建项目。如果您使用CLion，您会看到main.cpp文件已经创建并打开; 我们暂时不使用该主函数文件。在主项目文件夹中创建一个名为Block.h的文件，您应该可以通过右键单击项目工具窗口中的TestChain目录并选择：New&gt;C/C ++ Header File来新建。在文件内部，添加下面的代码（如果您使用CLion将所有代码放在#define TESTCHAIN_BLOCK_H和#endif的行之间)(译者注：防止头文件被重复调用) #include &lt;cstdint&gt; #include &lt;iostream&gt; 上面语句的意思是告诉编译器包含cstdint和iostream库。在它下面添加这一行： using namespace std; 上面语句是为std命名空间创建了一个快捷方式。其作用是不需要通过其使用全名引用std命名空间中的声明，例如，如果有上面语句则书写string就可以使用字符串，否则需要使用全名访问字符串，如std::string。 到现在为止感觉还挺好; 让我们进一步完善充实。 区块链由一系列包含数据的区块组成，每个区块都包含前一区块的加密HASH，这就表示很难改变某一个区块的内容，而后面的区块内容也同样发生改变（译者注：如果改变中间某个区块的内容，则这个区块之后的所有区块的内容都需要被改变才有效）; 因此区块链被赋予了不变的特性。 区块头结构 接下来我们创建我们的块类，将以下几行添加到Block.h头文件中： class Block { public: string sPrevHash; Block(uint32_t nIndexIn, const string &amp;sDataIn); string GetHash(); void MineBlock(uint32_t nDifficulty); private: uint32_t _nIndex; int64_t _nNonce; string _sData; string _sHash; time_t _tTime; string _CalculateHash() const; }; 不出所料，第1行 类Block第2行 公有修饰符 public第3行 公有变量sPrevHash,保存区块的前一个区块第5行 构造函数，需要的参数为nIndexIn和sDataInconst和&amp;一起使用，表示参数为引用传递，其值不可被修改，其目的是提高效率并且节省内存第7行 GetHash()函数,获得HASH值第9行 MineBlock()函数，挖矿，其参数nDifficulty表示指定的难度值第11行 私有修饰符private，表示后面的变量为私有变量，不能被其他类访问第12-16行 私有变量 _nIndex 区块索引值，第几个区块，从0开始计算， _nNonce 区块随机数， _sData 区块描述字符 _sHash 区块HASH值 _tTime 区块生成时间 第18行 _CalculateHash()，计算HASH值。使用const关键字，是为了确保函数的输出不能被修改，这在处理区块链时非常有用。 现在是在主项目文件夹中创建Blockchain.h头文件的时候了。让我们开始添加这些行（如果您使用CLion将所有代码#define TESTCHAIN_BLOCKCHAIN_H 和 #endif之间） #include &lt;cstdint&gt; #include &lt;vector&gt; #include &quot;Block.h&quot; using namespace std; 上面语句告知编译器包含cstdint和vector向量库，以及调用我们刚创建的Block.h头文件，并创建std namespace快捷方式。 区块链头结构 现在让我们创建区块链类，将以下代码行添加到Blockchain.h头文件中： class Blockchain { public: Blockchain(); void AddBlock(Block bNew); private: uint32_t _nDifficulty; vector&lt;Block&gt; _vChain; Block _GetLastBlock() const; }; 第1行 创建区块链类第2行 public修饰符第3行 默认构造函数第5行 AddBlock() 增加区块函数，参数为我们前面创建的Block类的对象bNew第7行 private修饰符，后面的变量和方法是私有的第8-9行 私有变量 _nDifficulty难度值 _vChain保存区块的变量第11行 _GetLastBlock()获取最新的区块，由const关键字，表示输出的内容不可更改 因为区块链使用密码学，所以我们区块链需要一些加密函数。 我们将使用SHA256哈希来创建块的哈希值，（我们可以编写自己的SHA256函数，但是没必要重复造轮子），为了让编码更加简单，引用了来自Zedwood的C++ sha256函数，该链接中有sha256.h，sha256.cpp和LICENSE.txt文件，我们将它们保存在项目文件夹中。（译者注：可以使用译者提供的centos系统可以变编译运行的代码） 好的，让我们继续 接下来我们的区块创建一个源文件Block.cpp并保存到主项目文件夹中首先添加这些行，告诉编译器包含我们之前添加的Block.h和sha256.h文件。 #include &quot;Block.h&quot; #include &quot;sha256.h&quot; 下面实现区块构造函数： Block::Block(uint32_t nIndexIn, const string &amp;sDataIn) : _nIndex(nIndexIn), _sData(sDataIn) { _nNonce = -1; _tTime = time(nullptr); } 第1行 将参数的内容赋值给变量_nIndex和_sData中。第2行 _nNonce变量设置为-1。第3行 _tTime变量设置为当前时间。 实现访问区块的HASH函数： string Block::GetHash() { return _sHash; } 第2行 返回私有变量_sHash的值 您可能已经清楚，比特币数字货币中设计区块链技术非常受欢迎，使得分类账不能被修改或者保密;这意味着，当一个用户将比特币发送给另一个用户时，比特币网络上的节点将转账交易写到区块链中的一个区块中。另一台计算机作为一个节点运行比特币软件（因为比特币网络是P2P，所以该节点可以是世界上任何一个人运行）;这个过程被称为“挖矿”，每当他们在区块链上成功创建一个有效的区块时，该节点将获得相应的比特币奖励。 如果想成功创建一个有效的区块并因此获得奖励，矿工必须创建一个有效的区块加密HASH添加到区块链中。 有效区块HASH是通过计算HASH开头零的数量来实现的；如果零的数量等于或大于网络设置的难度，则表示有效，否则将增加随机数后重新创建散列;直到生成一个有效的散列。 这个过程称为工作量证明（Proof of Work，PoW）。 挖矿过程-工作量证明 接下来，我们实现MineBlock方法来复现上述过程 void Block::MineBlock(uint32_t nDifficulty) { char cstr[nDifficulty + 1]; for (uint32_t i = 0; i &lt; nDifficulty; ++i) { cstr[i] = &#39;0&#39;; } cstr[nDifficulty] = &#39;\0&#39;; string str(cstr); do { _nNonce++; _sHash = _CalculateHash(); } while (_sHash.substr(0, nDifficulty) != str); cout &lt;&lt; &quot;Block mined: &quot; &lt;&lt; _sHash &lt;&lt; endl; } 第1行 MineBlock函数在block.h文件中声明，参数nDifficulty为难度第2行 创建一个难度大于nDifficulty的值的字符数据第3-6行 用0填充数组，最后一个字符填充为终止符\0第8行 将字符数组转换为string字符串第10-13行 循环增加随机数，并且计算HASH值保存到_sHash中。循环结束的条件是比较生成的HASH值和刚刚创建的零串，一旦匹配则跳出循环，否则继续生成HASH第15行 一旦找到匹配，就会向输出发送该区块的HASH值，表示该块已成功开采。 区块HASH计算 我们前面已经看到它好几次，所以接下来添加_CalculateHash方法： inline string Block::_CalculateHash() const { stringstream ss; ss &lt;&lt; _nIndex &lt;&lt; _tTime &lt;&lt; _sData &lt;&lt; _nNonce &lt;&lt; sPrevHash; return sha256(ss.str()); } 第1行 该函数在Block.h头文件中声明，inline关键字修饰，表示编译器编译时将该函数代码嵌入到其他函数中，减少了函数的调用开销（译者注：inline通常用在循环体内）第2行 创建一个字符串流ss。第3行 将_nIndex，_tTime，_sData，_nNonce和sPrevHash的值附加到流字符串流ss中。第5行 将字符串流ss的sha256值输出 增加区块链文件Blockchain.cpp到主项目文件夹中。 下面的代码编译器包含添加的Blockchain.h文件。 #include &quot;Blockchain.h&quot; 创世块的产生 接下来，我们实现区块链构造函数 Blockchain::Blockchain() { _vChain.emplace_back(Block(0, &quot;Genesis Block&quot;)); _nDifficulty = 3; } 第1行 区块链构造函数，生成“创世块”。因为将区块添加到区块链中时，需要添加前一个区块HASH值，所以区块链必须从某处开始，我们称最开始的那个区块为“创世块”。第2行 将生成的区块放在向量_vChain中。emplace_back()函数，在容器_vChain尾部添加一个元素，这个元素原地构造，不需要触发拷贝构造和转移构造。第3行 设置工作量POW的难度值（即区块HASH前面有多少个零） 添加区块 现在，我们实现区块增加函数 void Blockchain::AddBlock(Block bNew) { bNew.sPrevHash = _GetLastBlock().GetHash(); bNew.MineBlock(_nDifficulty); _vChain.push_back(bNew); } 第1行 该函数是在Blockchain.h文件中申明，参数为区块对象第2行 将上一区块的hash值（_vChain的最后一个区块HASH值）保存到sPrevHash中第3行 挖矿，参数为_nDifficulty难度值第4行 将新挖的区块保存到_vChain向量的末尾 让我们实现区块链的最后一个方法 Block Blockchain::_GetLastBlock() const { return _vChain.back(); } 第1行 该函数是在Blockchain.h头文件中声明第2行 返回向量_vChain的最后一个元素 主函数 新建main.cpp（挖掘三个区块后退出程序） #include &quot;Blockchain.h&quot; int main() { Blockchain bChain = Blockchain(); cout &lt;&lt; &quot;Mining block 1...&quot; &lt;&lt; endl; bChain.AddBlock(Block(1, &quot;Block 1 Data&quot;)); cout &lt;&lt; &quot;Mining block 2...&quot; &lt;&lt; endl; bChain.AddBlock(Block(2, &quot;Block 2 Data&quot;)); cout &lt;&lt; &quot;Mining block 3...&quot; &lt;&lt; endl; bChain.AddBlock(Block(3, &quot;Block 3 Data&quot;)); return 0; } 源码目录结构以及编译情况挖矿过程 请点击下载源码 源码介绍文档请阅读《一步步教小白使用C++构建区块链》 作者：davenash链接：http://davenash.com/2017/10/build-a-blockchain-with-c/版权声明：作者保留权利。文章为作者独立观点，不代表B链网立场。严禁修改，转载请注明原文链接 阅读更多" />
<meta property="og:description" content="&nbsp; &nbsp; &nbsp; &nbsp; 最近你可能听说过很多关于区块链的消息，想知道大家都在谈论什么。&nbsp;区块链是一种分类账本，它的实现原理使得很难改变它所包含的数据；有人说区块链是不可改变的，它的目的是保持其正确的，不变性意味着永久性；但是硬盘上没有任何东西 永远可以被认为是永久性不变的；我们把这些哲学辩论留给非技术人员。而我现在要做的是向您展示如何使用C ++编写区块链。 区块头结构 区块链头结构 挖矿过程-工作量证明 区块HASH计算 创世块的产生 添加区块 主函数 源码下载 免责声明 本教程是参考Savjee使用NodeJS编写一篇文章; 有一段时间没有编写任何C ++代码，代码可能会有点生疏。（译者注：运行该C++程序，可以生成区块并组成区块链，也具备工作量证明POW功能） 首先要做的是打开一个新的C++项目，我使用JetBrains中的CLion，但任何C++ IDE甚至文本编辑器都可以（译者注：译者使用的是VIM）。 我们将创建TestChain项目，继续下一步创建项目。如果您使用CLion，您会看到main.cpp文件已经创建并打开; 我们暂时不使用该主函数文件。在主项目文件夹中创建一个名为Block.h的文件，您应该可以通过右键单击项目工具窗口中的TestChain目录并选择：New&gt;C/C ++ Header File来新建。在文件内部，添加下面的代码（如果您使用CLion将所有代码放在#define TESTCHAIN_BLOCK_H和#endif的行之间)(译者注：防止头文件被重复调用) #include &lt;cstdint&gt; #include &lt;iostream&gt; 上面语句的意思是告诉编译器包含cstdint和iostream库。在它下面添加这一行： using namespace std; 上面语句是为std命名空间创建了一个快捷方式。其作用是不需要通过其使用全名引用std命名空间中的声明，例如，如果有上面语句则书写string就可以使用字符串，否则需要使用全名访问字符串，如std::string。 到现在为止感觉还挺好; 让我们进一步完善充实。 区块链由一系列包含数据的区块组成，每个区块都包含前一区块的加密HASH，这就表示很难改变某一个区块的内容，而后面的区块内容也同样发生改变（译者注：如果改变中间某个区块的内容，则这个区块之后的所有区块的内容都需要被改变才有效）; 因此区块链被赋予了不变的特性。 区块头结构 接下来我们创建我们的块类，将以下几行添加到Block.h头文件中： class Block { public: string sPrevHash; Block(uint32_t nIndexIn, const string &amp;sDataIn); string GetHash(); void MineBlock(uint32_t nDifficulty); private: uint32_t _nIndex; int64_t _nNonce; string _sData; string _sHash; time_t _tTime; string _CalculateHash() const; }; 不出所料，第1行 类Block第2行 公有修饰符 public第3行 公有变量sPrevHash,保存区块的前一个区块第5行 构造函数，需要的参数为nIndexIn和sDataInconst和&amp;一起使用，表示参数为引用传递，其值不可被修改，其目的是提高效率并且节省内存第7行 GetHash()函数,获得HASH值第9行 MineBlock()函数，挖矿，其参数nDifficulty表示指定的难度值第11行 私有修饰符private，表示后面的变量为私有变量，不能被其他类访问第12-16行 私有变量 _nIndex 区块索引值，第几个区块，从0开始计算， _nNonce 区块随机数， _sData 区块描述字符 _sHash 区块HASH值 _tTime 区块生成时间 第18行 _CalculateHash()，计算HASH值。使用const关键字，是为了确保函数的输出不能被修改，这在处理区块链时非常有用。 现在是在主项目文件夹中创建Blockchain.h头文件的时候了。让我们开始添加这些行（如果您使用CLion将所有代码#define TESTCHAIN_BLOCKCHAIN_H 和 #endif之间） #include &lt;cstdint&gt; #include &lt;vector&gt; #include &quot;Block.h&quot; using namespace std; 上面语句告知编译器包含cstdint和vector向量库，以及调用我们刚创建的Block.h头文件，并创建std namespace快捷方式。 区块链头结构 现在让我们创建区块链类，将以下代码行添加到Blockchain.h头文件中： class Blockchain { public: Blockchain(); void AddBlock(Block bNew); private: uint32_t _nDifficulty; vector&lt;Block&gt; _vChain; Block _GetLastBlock() const; }; 第1行 创建区块链类第2行 public修饰符第3行 默认构造函数第5行 AddBlock() 增加区块函数，参数为我们前面创建的Block类的对象bNew第7行 private修饰符，后面的变量和方法是私有的第8-9行 私有变量 _nDifficulty难度值 _vChain保存区块的变量第11行 _GetLastBlock()获取最新的区块，由const关键字，表示输出的内容不可更改 因为区块链使用密码学，所以我们区块链需要一些加密函数。 我们将使用SHA256哈希来创建块的哈希值，（我们可以编写自己的SHA256函数，但是没必要重复造轮子），为了让编码更加简单，引用了来自Zedwood的C++ sha256函数，该链接中有sha256.h，sha256.cpp和LICENSE.txt文件，我们将它们保存在项目文件夹中。（译者注：可以使用译者提供的centos系统可以变编译运行的代码） 好的，让我们继续 接下来我们的区块创建一个源文件Block.cpp并保存到主项目文件夹中首先添加这些行，告诉编译器包含我们之前添加的Block.h和sha256.h文件。 #include &quot;Block.h&quot; #include &quot;sha256.h&quot; 下面实现区块构造函数： Block::Block(uint32_t nIndexIn, const string &amp;sDataIn) : _nIndex(nIndexIn), _sData(sDataIn) { _nNonce = -1; _tTime = time(nullptr); } 第1行 将参数的内容赋值给变量_nIndex和_sData中。第2行 _nNonce变量设置为-1。第3行 _tTime变量设置为当前时间。 实现访问区块的HASH函数： string Block::GetHash() { return _sHash; } 第2行 返回私有变量_sHash的值 您可能已经清楚，比特币数字货币中设计区块链技术非常受欢迎，使得分类账不能被修改或者保密;这意味着，当一个用户将比特币发送给另一个用户时，比特币网络上的节点将转账交易写到区块链中的一个区块中。另一台计算机作为一个节点运行比特币软件（因为比特币网络是P2P，所以该节点可以是世界上任何一个人运行）;这个过程被称为“挖矿”，每当他们在区块链上成功创建一个有效的区块时，该节点将获得相应的比特币奖励。 如果想成功创建一个有效的区块并因此获得奖励，矿工必须创建一个有效的区块加密HASH添加到区块链中。 有效区块HASH是通过计算HASH开头零的数量来实现的；如果零的数量等于或大于网络设置的难度，则表示有效，否则将增加随机数后重新创建散列;直到生成一个有效的散列。 这个过程称为工作量证明（Proof of Work，PoW）。 挖矿过程-工作量证明 接下来，我们实现MineBlock方法来复现上述过程 void Block::MineBlock(uint32_t nDifficulty) { char cstr[nDifficulty + 1]; for (uint32_t i = 0; i &lt; nDifficulty; ++i) { cstr[i] = &#39;0&#39;; } cstr[nDifficulty] = &#39;\0&#39;; string str(cstr); do { _nNonce++; _sHash = _CalculateHash(); } while (_sHash.substr(0, nDifficulty) != str); cout &lt;&lt; &quot;Block mined: &quot; &lt;&lt; _sHash &lt;&lt; endl; } 第1行 MineBlock函数在block.h文件中声明，参数nDifficulty为难度第2行 创建一个难度大于nDifficulty的值的字符数据第3-6行 用0填充数组，最后一个字符填充为终止符\0第8行 将字符数组转换为string字符串第10-13行 循环增加随机数，并且计算HASH值保存到_sHash中。循环结束的条件是比较生成的HASH值和刚刚创建的零串，一旦匹配则跳出循环，否则继续生成HASH第15行 一旦找到匹配，就会向输出发送该区块的HASH值，表示该块已成功开采。 区块HASH计算 我们前面已经看到它好几次，所以接下来添加_CalculateHash方法： inline string Block::_CalculateHash() const { stringstream ss; ss &lt;&lt; _nIndex &lt;&lt; _tTime &lt;&lt; _sData &lt;&lt; _nNonce &lt;&lt; sPrevHash; return sha256(ss.str()); } 第1行 该函数在Block.h头文件中声明，inline关键字修饰，表示编译器编译时将该函数代码嵌入到其他函数中，减少了函数的调用开销（译者注：inline通常用在循环体内）第2行 创建一个字符串流ss。第3行 将_nIndex，_tTime，_sData，_nNonce和sPrevHash的值附加到流字符串流ss中。第5行 将字符串流ss的sha256值输出 增加区块链文件Blockchain.cpp到主项目文件夹中。 下面的代码编译器包含添加的Blockchain.h文件。 #include &quot;Blockchain.h&quot; 创世块的产生 接下来，我们实现区块链构造函数 Blockchain::Blockchain() { _vChain.emplace_back(Block(0, &quot;Genesis Block&quot;)); _nDifficulty = 3; } 第1行 区块链构造函数，生成“创世块”。因为将区块添加到区块链中时，需要添加前一个区块HASH值，所以区块链必须从某处开始，我们称最开始的那个区块为“创世块”。第2行 将生成的区块放在向量_vChain中。emplace_back()函数，在容器_vChain尾部添加一个元素，这个元素原地构造，不需要触发拷贝构造和转移构造。第3行 设置工作量POW的难度值（即区块HASH前面有多少个零） 添加区块 现在，我们实现区块增加函数 void Blockchain::AddBlock(Block bNew) { bNew.sPrevHash = _GetLastBlock().GetHash(); bNew.MineBlock(_nDifficulty); _vChain.push_back(bNew); } 第1行 该函数是在Blockchain.h文件中申明，参数为区块对象第2行 将上一区块的hash值（_vChain的最后一个区块HASH值）保存到sPrevHash中第3行 挖矿，参数为_nDifficulty难度值第4行 将新挖的区块保存到_vChain向量的末尾 让我们实现区块链的最后一个方法 Block Blockchain::_GetLastBlock() const { return _vChain.back(); } 第1行 该函数是在Blockchain.h头文件中声明第2行 返回向量_vChain的最后一个元素 主函数 新建main.cpp（挖掘三个区块后退出程序） #include &quot;Blockchain.h&quot; int main() { Blockchain bChain = Blockchain(); cout &lt;&lt; &quot;Mining block 1...&quot; &lt;&lt; endl; bChain.AddBlock(Block(1, &quot;Block 1 Data&quot;)); cout &lt;&lt; &quot;Mining block 2...&quot; &lt;&lt; endl; bChain.AddBlock(Block(2, &quot;Block 2 Data&quot;)); cout &lt;&lt; &quot;Mining block 3...&quot; &lt;&lt; endl; bChain.AddBlock(Block(3, &quot;Block 3 Data&quot;)); return 0; } 源码目录结构以及编译情况挖矿过程 请点击下载源码 源码介绍文档请阅读《一步步教小白使用C++构建区块链》 作者：davenash链接：http://davenash.com/2017/10/build-a-blockchain-with-c/版权声明：作者保留权利。文章为作者独立观点，不代表B链网立场。严禁修改，转载请注明原文链接 阅读更多" />
<link rel="canonical" href="http://0.0.0.0:4000/2018/05/09/%E4%B8%80%E6%AD%A5%E6%AD%A5%E6%95%99%E5%B0%8F%E7%99%BD%E4%BD%BF%E7%94%A8C++%E6%9E%84%E5%BB%BA%E5%8C%BA%E5%9D%97%E9%93%BE.html" />
<meta property="og:url" content="http://0.0.0.0:4000/2018/05/09/%E4%B8%80%E6%AD%A5%E6%AD%A5%E6%95%99%E5%B0%8F%E7%99%BD%E4%BD%BF%E7%94%A8C++%E6%9E%84%E5%BB%BA%E5%8C%BA%E5%9D%97%E9%93%BE.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-05-09T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"&nbsp; &nbsp; &nbsp; &nbsp; 最近你可能听说过很多关于区块链的消息，想知道大家都在谈论什么。&nbsp;区块链是一种分类账本，它的实现原理使得很难改变它所包含的数据；有人说区块链是不可改变的，它的目的是保持其正确的，不变性意味着永久性；但是硬盘上没有任何东西 永远可以被认为是永久性不变的；我们把这些哲学辩论留给非技术人员。而我现在要做的是向您展示如何使用C ++编写区块链。 区块头结构 区块链头结构 挖矿过程-工作量证明 区块HASH计算 创世块的产生 添加区块 主函数 源码下载 免责声明 本教程是参考Savjee使用NodeJS编写一篇文章; 有一段时间没有编写任何C ++代码，代码可能会有点生疏。（译者注：运行该C++程序，可以生成区块并组成区块链，也具备工作量证明POW功能） 首先要做的是打开一个新的C++项目，我使用JetBrains中的CLion，但任何C++ IDE甚至文本编辑器都可以（译者注：译者使用的是VIM）。 我们将创建TestChain项目，继续下一步创建项目。如果您使用CLion，您会看到main.cpp文件已经创建并打开; 我们暂时不使用该主函数文件。在主项目文件夹中创建一个名为Block.h的文件，您应该可以通过右键单击项目工具窗口中的TestChain目录并选择：New&gt;C/C ++ Header File来新建。在文件内部，添加下面的代码（如果您使用CLion将所有代码放在#define TESTCHAIN_BLOCK_H和#endif的行之间)(译者注：防止头文件被重复调用) #include &lt;cstdint&gt; #include &lt;iostream&gt; 上面语句的意思是告诉编译器包含cstdint和iostream库。在它下面添加这一行： using namespace std; 上面语句是为std命名空间创建了一个快捷方式。其作用是不需要通过其使用全名引用std命名空间中的声明，例如，如果有上面语句则书写string就可以使用字符串，否则需要使用全名访问字符串，如std::string。 到现在为止感觉还挺好; 让我们进一步完善充实。 区块链由一系列包含数据的区块组成，每个区块都包含前一区块的加密HASH，这就表示很难改变某一个区块的内容，而后面的区块内容也同样发生改变（译者注：如果改变中间某个区块的内容，则这个区块之后的所有区块的内容都需要被改变才有效）; 因此区块链被赋予了不变的特性。 区块头结构 接下来我们创建我们的块类，将以下几行添加到Block.h头文件中： class Block { public: string sPrevHash; Block(uint32_t nIndexIn, const string &amp;sDataIn); string GetHash(); void MineBlock(uint32_t nDifficulty); private: uint32_t _nIndex; int64_t _nNonce; string _sData; string _sHash; time_t _tTime; string _CalculateHash() const; }; 不出所料，第1行 类Block第2行 公有修饰符 public第3行 公有变量sPrevHash,保存区块的前一个区块第5行 构造函数，需要的参数为nIndexIn和sDataInconst和&amp;一起使用，表示参数为引用传递，其值不可被修改，其目的是提高效率并且节省内存第7行 GetHash()函数,获得HASH值第9行 MineBlock()函数，挖矿，其参数nDifficulty表示指定的难度值第11行 私有修饰符private，表示后面的变量为私有变量，不能被其他类访问第12-16行 私有变量 _nIndex 区块索引值，第几个区块，从0开始计算， _nNonce 区块随机数， _sData 区块描述字符 _sHash 区块HASH值 _tTime 区块生成时间 第18行 _CalculateHash()，计算HASH值。使用const关键字，是为了确保函数的输出不能被修改，这在处理区块链时非常有用。 现在是在主项目文件夹中创建Blockchain.h头文件的时候了。让我们开始添加这些行（如果您使用CLion将所有代码#define TESTCHAIN_BLOCKCHAIN_H 和 #endif之间） #include &lt;cstdint&gt; #include &lt;vector&gt; #include &quot;Block.h&quot; using namespace std; 上面语句告知编译器包含cstdint和vector向量库，以及调用我们刚创建的Block.h头文件，并创建std namespace快捷方式。 区块链头结构 现在让我们创建区块链类，将以下代码行添加到Blockchain.h头文件中： class Blockchain { public: Blockchain(); void AddBlock(Block bNew); private: uint32_t _nDifficulty; vector&lt;Block&gt; _vChain; Block _GetLastBlock() const; }; 第1行 创建区块链类第2行 public修饰符第3行 默认构造函数第5行 AddBlock() 增加区块函数，参数为我们前面创建的Block类的对象bNew第7行 private修饰符，后面的变量和方法是私有的第8-9行 私有变量 _nDifficulty难度值 _vChain保存区块的变量第11行 _GetLastBlock()获取最新的区块，由const关键字，表示输出的内容不可更改 因为区块链使用密码学，所以我们区块链需要一些加密函数。 我们将使用SHA256哈希来创建块的哈希值，（我们可以编写自己的SHA256函数，但是没必要重复造轮子），为了让编码更加简单，引用了来自Zedwood的C++ sha256函数，该链接中有sha256.h，sha256.cpp和LICENSE.txt文件，我们将它们保存在项目文件夹中。（译者注：可以使用译者提供的centos系统可以变编译运行的代码） 好的，让我们继续 接下来我们的区块创建一个源文件Block.cpp并保存到主项目文件夹中首先添加这些行，告诉编译器包含我们之前添加的Block.h和sha256.h文件。 #include &quot;Block.h&quot; #include &quot;sha256.h&quot; 下面实现区块构造函数： Block::Block(uint32_t nIndexIn, const string &amp;sDataIn) : _nIndex(nIndexIn), _sData(sDataIn) { _nNonce = -1; _tTime = time(nullptr); } 第1行 将参数的内容赋值给变量_nIndex和_sData中。第2行 _nNonce变量设置为-1。第3行 _tTime变量设置为当前时间。 实现访问区块的HASH函数： string Block::GetHash() { return _sHash; } 第2行 返回私有变量_sHash的值 您可能已经清楚，比特币数字货币中设计区块链技术非常受欢迎，使得分类账不能被修改或者保密;这意味着，当一个用户将比特币发送给另一个用户时，比特币网络上的节点将转账交易写到区块链中的一个区块中。另一台计算机作为一个节点运行比特币软件（因为比特币网络是P2P，所以该节点可以是世界上任何一个人运行）;这个过程被称为“挖矿”，每当他们在区块链上成功创建一个有效的区块时，该节点将获得相应的比特币奖励。 如果想成功创建一个有效的区块并因此获得奖励，矿工必须创建一个有效的区块加密HASH添加到区块链中。 有效区块HASH是通过计算HASH开头零的数量来实现的；如果零的数量等于或大于网络设置的难度，则表示有效，否则将增加随机数后重新创建散列;直到生成一个有效的散列。 这个过程称为工作量证明（Proof of Work，PoW）。 挖矿过程-工作量证明 接下来，我们实现MineBlock方法来复现上述过程 void Block::MineBlock(uint32_t nDifficulty) { char cstr[nDifficulty + 1]; for (uint32_t i = 0; i &lt; nDifficulty; ++i) { cstr[i] = &#39;0&#39;; } cstr[nDifficulty] = &#39;\\0&#39;; string str(cstr); do { _nNonce++; _sHash = _CalculateHash(); } while (_sHash.substr(0, nDifficulty) != str); cout &lt;&lt; &quot;Block mined: &quot; &lt;&lt; _sHash &lt;&lt; endl; } 第1行 MineBlock函数在block.h文件中声明，参数nDifficulty为难度第2行 创建一个难度大于nDifficulty的值的字符数据第3-6行 用0填充数组，最后一个字符填充为终止符\\0第8行 将字符数组转换为string字符串第10-13行 循环增加随机数，并且计算HASH值保存到_sHash中。循环结束的条件是比较生成的HASH值和刚刚创建的零串，一旦匹配则跳出循环，否则继续生成HASH第15行 一旦找到匹配，就会向输出发送该区块的HASH值，表示该块已成功开采。 区块HASH计算 我们前面已经看到它好几次，所以接下来添加_CalculateHash方法： inline string Block::_CalculateHash() const { stringstream ss; ss &lt;&lt; _nIndex &lt;&lt; _tTime &lt;&lt; _sData &lt;&lt; _nNonce &lt;&lt; sPrevHash; return sha256(ss.str()); } 第1行 该函数在Block.h头文件中声明，inline关键字修饰，表示编译器编译时将该函数代码嵌入到其他函数中，减少了函数的调用开销（译者注：inline通常用在循环体内）第2行 创建一个字符串流ss。第3行 将_nIndex，_tTime，_sData，_nNonce和sPrevHash的值附加到流字符串流ss中。第5行 将字符串流ss的sha256值输出 增加区块链文件Blockchain.cpp到主项目文件夹中。 下面的代码编译器包含添加的Blockchain.h文件。 #include &quot;Blockchain.h&quot; 创世块的产生 接下来，我们实现区块链构造函数 Blockchain::Blockchain() { _vChain.emplace_back(Block(0, &quot;Genesis Block&quot;)); _nDifficulty = 3; } 第1行 区块链构造函数，生成“创世块”。因为将区块添加到区块链中时，需要添加前一个区块HASH值，所以区块链必须从某处开始，我们称最开始的那个区块为“创世块”。第2行 将生成的区块放在向量_vChain中。emplace_back()函数，在容器_vChain尾部添加一个元素，这个元素原地构造，不需要触发拷贝构造和转移构造。第3行 设置工作量POW的难度值（即区块HASH前面有多少个零） 添加区块 现在，我们实现区块增加函数 void Blockchain::AddBlock(Block bNew) { bNew.sPrevHash = _GetLastBlock().GetHash(); bNew.MineBlock(_nDifficulty); _vChain.push_back(bNew); } 第1行 该函数是在Blockchain.h文件中申明，参数为区块对象第2行 将上一区块的hash值（_vChain的最后一个区块HASH值）保存到sPrevHash中第3行 挖矿，参数为_nDifficulty难度值第4行 将新挖的区块保存到_vChain向量的末尾 让我们实现区块链的最后一个方法 Block Blockchain::_GetLastBlock() const { return _vChain.back(); } 第1行 该函数是在Blockchain.h头文件中声明第2行 返回向量_vChain的最后一个元素 主函数 新建main.cpp（挖掘三个区块后退出程序） #include &quot;Blockchain.h&quot; int main() { Blockchain bChain = Blockchain(); cout &lt;&lt; &quot;Mining block 1...&quot; &lt;&lt; endl; bChain.AddBlock(Block(1, &quot;Block 1 Data&quot;)); cout &lt;&lt; &quot;Mining block 2...&quot; &lt;&lt; endl; bChain.AddBlock(Block(2, &quot;Block 2 Data&quot;)); cout &lt;&lt; &quot;Mining block 3...&quot; &lt;&lt; endl; bChain.AddBlock(Block(3, &quot;Block 3 Data&quot;)); return 0; } 源码目录结构以及编译情况挖矿过程 请点击下载源码 源码介绍文档请阅读《一步步教小白使用C++构建区块链》 作者：davenash链接：http://davenash.com/2017/10/build-a-blockchain-with-c/版权声明：作者保留权利。文章为作者独立观点，不代表B链网立场。严禁修改，转载请注明原文链接 阅读更多","@type":"BlogPosting","url":"http://0.0.0.0:4000/2018/05/09/%E4%B8%80%E6%AD%A5%E6%AD%A5%E6%95%99%E5%B0%8F%E7%99%BD%E4%BD%BF%E7%94%A8C++%E6%9E%84%E5%BB%BA%E5%8C%BA%E5%9D%97%E9%93%BE.html","headline":"一步步教小白使用C++构建区块链","dateModified":"2018-05-09T00:00:00+08:00","datePublished":"2018-05-09T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/2018/05/09/%E4%B8%80%E6%AD%A5%E6%AD%A5%E6%95%99%E5%B0%8F%E7%99%BD%E4%BD%BF%E7%94%A8C++%E6%9E%84%E5%BB%BA%E5%8C%BA%E5%9D%97%E9%93%BE.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>

  </head>
  <body>
    <div class="wrapper">
      <header  class="without-description" >
        <h1>一步步教小白使用C++构建区块链</h1>
        
        
        <ul>
            <li><a href="https://blog.uzzz.org/" target="_blank"><strong>柚子社区<br/>(国际版)</strong></a></li>
            <li><a href="https://blog.uzzz.org.cn/" target="_blank"><strong>柚子社区<br/>(国内版)</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

      <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-e2445db1a8.css"> 
 <div class="htmledit_views"> 
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">&nbsp; &nbsp; &nbsp; &nbsp; 最近你可能听说过很多关于区块链的消息，想知道大家都在谈论什么。&nbsp;<span style="font-weight:700;">区块链是一种分类账本，它的实现原理使得很难改变它所包含的数据；</span>有人说区块链是不可改变的，它的目的是保持其正确的，不变性意味着永久性；但是硬盘上没有任何东西 永远可以被认为是永久性不变的；我们把这些哲学辩论留给非技术人员。而我现在要做的是向您展示如何使用C ++编写区块链。</p>
  <div class="markdown-toc editormd-markdown-toc" style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">
   <ul class="markdown-toc-list">
    <li><a class="toc-level-1" href="http://www.360bchain.com/article/117.html#%E5%8C%BA%E5%9D%97%E5%A4%B4%E7%BB%93%E6%9E%84" rel="nofollow" style="background-position:0px 0px;color:rgb(65,131,196);">区块头结构</a></li>
    <li><a class="toc-level-1" href="http://www.360bchain.com/article/117.html#%E5%8C%BA%E5%9D%97%E9%93%BE%E5%A4%B4%E7%BB%93%E6%9E%84" rel="nofollow" style="background-position:0px 0px;color:rgb(65,131,196);">区块链头结构</a></li>
    <li><a class="toc-level-1" href="http://www.360bchain.com/article/117.html#%E6%8C%96%E7%9F%BF%E8%BF%87%E7%A8%8B-%E5%B7%A5%E4%BD%9C%E9%87%8F%E8%AF%81%E6%98%8E" rel="nofollow" style="background-position:0px 0px;color:rgb(65,131,196);">挖矿过程-工作量证明</a></li>
    <li><a class="toc-level-1" href="http://www.360bchain.com/article/117.html#%E5%8C%BA%E5%9D%97HASH%E8%AE%A1%E7%AE%97" rel="nofollow" style="background-position:0px 0px;color:rgb(65,131,196);">区块HASH计算</a></li>
    <li><a class="toc-level-1" href="http://www.360bchain.com/article/117.html#%E5%88%9B%E4%B8%96%E5%9D%97%E7%9A%84%E4%BA%A7%E7%94%9F" rel="nofollow" style="background-position:0px 0px;color:rgb(65,131,196);">创世块的产生</a></li>
    <li><a class="toc-level-1" href="http://www.360bchain.com/article/117.html#%E6%B7%BB%E5%8A%A0%E5%8C%BA%E5%9D%97" rel="nofollow" style="background-position:0px 0px;color:rgb(65,131,196);">添加区块</a></li>
    <li><a class="toc-level-1" href="http://www.360bchain.com/article/117.html#%E4%B8%BB%E5%87%BD%E6%95%B0" rel="nofollow" style="background-position:0px 0px;color:rgb(65,131,196);">主函数</a></li>
    <li><a class="toc-level-1" href="http://www.360bchain.com/article/117.html#%E6%BA%90%E7%A0%81%E4%B8%8B%E8%BD%BD" rel="nofollow" style="background-position:0px 0px;color:rgb(65,131,196);">源码下载</a></li>
   </ul>
  </div>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">免责声明</p>
  <ul style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">
   <li>本教程是参考Savjee使用NodeJS编写一篇文章;</li>
   <li>有一段时间没有编写任何C ++代码，代码可能会有点生疏。（<em>译者注：运行该C++程序，可以生成区块并组成区块链，也具备工作量证明POW功能</em>）<br><img src="http://img.360bchain.com/pictures/OD/5af1a2b0cab1b.png" alt="" style="border:0px;vertical-align:middle;"></li>
  </ul>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">首先要做的是打开一个新的C++项目，我使用JetBrains中的CLion，但任何C++ IDE甚至文本编辑器都可以（译者注：译者使用的是VIM）。 我们将创建TestChain项目，继续下一步创建项目。<br>如果您使用CLion，您会看到main.cpp文件已经创建并打开; 我们暂时不使用该主函数文件。<br>在主项目文件夹中创建一个名为Block.h的文件，您应该可以通过右键单击项目工具窗口中的TestChain目录并选择：New&gt;C/C ++ Header File来新建。<br>在文件内部，添加下面的代码（如果您使用CLion将所有代码放在#define TESTCHAIN_BLOCK_H和#endif的行之间)(译者注：防止头文件被重复调用)</p>
  <pre class="prettyprint linenums prettyprinted" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;line-height:1.6;color:rgb(51,51,51);background:rgb(246,246,246);border-width:1px;border-style:solid;border-color:rgb(221,221,221);text-align:left;"></pre>
  <ol class="linenums" style="color:rgb(153,153,153);">
   <li class="L0"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="com" style="color:rgb(136,0,0);">#include</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="str" style="color:rgb(0,136,0);">&lt;cstdint&gt;</span></code></li>
   <li class="L1" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="com" style="color:rgb(136,0,0);">#include</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="str" style="color:rgb(0,136,0);">&lt;iostream&gt;</span></code></li>
  </ol>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">上面语句的意思是告诉编译器包含cstdint和iostream库。在它下面添加这一行：</p>
  <pre class="prettyprint linenums prettyprinted" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;line-height:1.6;color:rgb(51,51,51);background:rgb(246,246,246);border-width:1px;border-style:solid;border-color:rgb(221,221,221);text-align:left;"></pre>
  <ol class="linenums" style="color:rgb(153,153,153);">
   <li class="L0"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="kwd" style="color:rgb(0,0,136);">using</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">namespace</span><span class="pln" style="color:rgb(0,0,0);"> std</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li>
  </ol>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">上面语句是为std命名空间创建了一个快捷方式。其作用是不需要通过其使用全名引用std命名空间中的声明，例如，如果有上面语句则书写string就可以使用字符串，否则需要使用全名访问字符串，如std::string。</p>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">到现在为止感觉还挺好; 让我们进一步完善充实。</p>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">区块链由一系列包含数据的区块组成，每个区块都包含前一区块的加密HASH，这就表示很难改变某一个区块的内容，而后面的区块内容也同样发生改变（<span style="font-weight:700;">译者注：如果改变中间某个区块的内容，则这个区块之后的所有区块的内容都需要被改变才有效</span>）; 因此区块链被赋予了不变的特性。</p>
  <h1 style="font-size:2.25em;font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;line-height:1.2;color:rgb(51,51,51);border-bottom:1px solid rgb(238,238,238);text-align:left;"><a class="reference-link" style="background-position:0px 0px;color:rgb(65,131,196);"></a>区块头结构</h1>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">接下来我们创建我们的块类，将以下几行添加到Block.h头文件中：</p>
  <pre class="prettyprint linenums prettyprinted" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;line-height:1.6;color:rgb(51,51,51);background:rgb(246,246,246);border-width:1px;border-style:solid;border-color:rgb(221,221,221);text-align:left;"></pre>
  <ol class="linenums" style="color:rgb(153,153,153);">
   <li class="L0"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="kwd" style="color:rgb(0,0,136);">class</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="typ" style="color:rgb(102,0,102);">Block</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">{</span></code></li>
   <li class="L1" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="kwd" style="color:rgb(0,0,136);">public</span><span class="pun" style="color:rgb(102,102,0);">:</span></code></li>
   <li class="L2"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> string sPrevHash</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li>
   <li class="L3" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"></code></li>
   <li class="L4"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> </span><span class="typ" style="color:rgb(102,0,102);">Block</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="typ" style="color:rgb(102,0,102);">uint32_t</span><span class="pln" style="color:rgb(0,0,0);"> nIndexIn</span><span class="pun" style="color:rgb(102,102,0);">,</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">const</span><span class="pln" style="color:rgb(0,0,0);"> string </span><span class="pun" style="color:rgb(102,102,0);">&amp;</span><span class="pln" style="color:rgb(0,0,0);">sDataIn</span><span class="pun" style="color:rgb(102,102,0);">);</span></code></li>
   <li class="L5" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"></code></li>
   <li class="L6"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> string </span><span class="typ" style="color:rgb(102,0,102);">GetHash</span><span class="pun" style="color:rgb(102,102,0);">();</span></code></li>
   <li class="L7" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"></code></li>
   <li class="L8"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">void</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="typ" style="color:rgb(102,0,102);">MineBlock</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="typ" style="color:rgb(102,0,102);">uint32_t</span><span class="pln" style="color:rgb(0,0,0);"> nDifficulty</span><span class="pun" style="color:rgb(102,102,0);">);</span></code></li>
   <li class="L9" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"></code></li>
   <li class="L0"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="kwd" style="color:rgb(0,0,136);">private</span><span class="pun" style="color:rgb(102,102,0);">:</span></code></li>
   <li class="L1" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> </span><span class="typ" style="color:rgb(102,0,102);">uint32_t</span><span class="pln" style="color:rgb(0,0,0);"> _nIndex</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li>
   <li class="L2"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> </span><span class="typ" style="color:rgb(102,0,102);">int64_t</span><span class="pln" style="color:rgb(0,0,0);"> _nNonce</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li>
   <li class="L3" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> string _sData</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li>
   <li class="L4"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> string _sHash</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li>
   <li class="L5" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> </span><span class="typ" style="color:rgb(102,0,102);">time_t</span><span class="pln" style="color:rgb(0,0,0);"> _tTime</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li>
   <li class="L6"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"></code></li>
   <li class="L7" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> string </span><span class="typ" style="color:rgb(102,0,102);">_CalculateHash</span><span class="pun" style="color:rgb(102,102,0);">()</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">const</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li>
   <li class="L8"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pun" style="color:rgb(102,102,0);">};</span></code></li>
  </ol>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">不出所料，第1行 类Block第2行 公有修饰符 public第3行 公有变量sPrevHash,保存区块的前一个区块第5行 构造函数，需要的参数为nIndexIn和sDataInconst和&amp;一起使用，表示参数为引用传递，其值不可被修改，其目的是提高效率并且节省内存第7行 GetHash()函数,获得HASH值第9行 MineBlock()函数，挖矿，其参数nDifficulty表示指定的难度值第11行 私有修饰符private，表示后面的变量为私有变量，不能被其他类访问第12-16行 私有变量</p>
  <ul style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">
   <li>_nIndex 区块索引值，第几个区块，从0开始计算，</li>
   <li>_nNonce 区块随机数，</li>
   <li>_sData 区块描述字符</li>
   <li>_sHash 区块HASH值</li>
   <li>_tTime 区块生成时间</li>
  </ul>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">第18行 _CalculateHash()，计算HASH值。使用const关键字，是为了确保函数的输出不能被修改，这在处理区块链时非常有用。</p>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">现在是在主项目文件夹中创建Blockchain.h头文件的时候了。让我们开始添加这些行（如果您使用CLion将所有代码#define TESTCHAIN_BLOCKCHAIN_H 和 #endif之间）</p>
  <pre class="prettyprint linenums prettyprinted" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;line-height:1.6;color:rgb(51,51,51);background:rgb(246,246,246);border-width:1px;border-style:solid;border-color:rgb(221,221,221);text-align:left;"></pre>
  <ol class="linenums" style="color:rgb(153,153,153);">
   <li class="L0"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="com" style="color:rgb(136,0,0);">#include</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="str" style="color:rgb(0,136,0);">&lt;cstdint&gt;</span></code></li>
   <li class="L1" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="com" style="color:rgb(136,0,0);">#include</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="str" style="color:rgb(0,136,0);">&lt;vector&gt;</span></code></li>
   <li class="L2"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="com" style="color:rgb(136,0,0);">#include</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="str" style="color:rgb(0,136,0);">"Block.h"</span></code></li>
   <li class="L3" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"></code></li>
   <li class="L4"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="kwd" style="color:rgb(0,0,136);">using</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">namespace</span><span class="pln" style="color:rgb(0,0,0);"> std</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li>
  </ol>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">上面语句告知编译器包含cstdint和vector向量库，以及调用我们刚创建的Block.h头文件，并创建std namespace快捷方式。</p>
  <h1 style="font-size:2.25em;font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;line-height:1.2;color:rgb(51,51,51);border-bottom:1px solid rgb(238,238,238);text-align:left;"><a class="reference-link" style="background-position:0px 0px;color:rgb(65,131,196);"></a>区块链头结构</h1>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">现在让我们创建区块链类，将以下代码行添加到Blockchain.h头文件中：</p>
  <pre class="prettyprint linenums prettyprinted" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;line-height:1.6;color:rgb(51,51,51);background:rgb(246,246,246);border-width:1px;border-style:solid;border-color:rgb(221,221,221);text-align:left;"></pre>
  <ol class="linenums" style="color:rgb(153,153,153);">
   <li class="L0"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="kwd" style="color:rgb(0,0,136);">class</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="typ" style="color:rgb(102,0,102);">Blockchain</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">{</span></code></li>
   <li class="L1" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="kwd" style="color:rgb(0,0,136);">public</span><span class="pun" style="color:rgb(102,102,0);">:</span></code></li>
   <li class="L2"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> </span><span class="typ" style="color:rgb(102,0,102);">Blockchain</span><span class="pun" style="color:rgb(102,102,0);">();</span></code></li>
   <li class="L3" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"></code></li>
   <li class="L4"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">void</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="typ" style="color:rgb(102,0,102);">AddBlock</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="typ" style="color:rgb(102,0,102);">Block</span><span class="pln" style="color:rgb(0,0,0);"> bNew</span><span class="pun" style="color:rgb(102,102,0);">);</span></code></li>
   <li class="L5" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"></code></li>
   <li class="L6"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="kwd" style="color:rgb(0,0,136);">private</span><span class="pun" style="color:rgb(102,102,0);">:</span></code></li>
   <li class="L7" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> </span><span class="typ" style="color:rgb(102,0,102);">uint32_t</span><span class="pln" style="color:rgb(0,0,0);"> _nDifficulty</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li>
   <li class="L8"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> </span><span class="typ" style="color:rgb(102,0,102);">vector</span><span class="pun" style="color:rgb(102,102,0);">&lt;</span><span class="typ" style="color:rgb(102,0,102);">Block</span><span class="pun" style="color:rgb(102,102,0);">&gt;</span><span class="pln" style="color:rgb(0,0,0);"> _vChain</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li>
   <li class="L9" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"></code></li>
   <li class="L0"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> </span><span class="typ" style="color:rgb(102,0,102);">Block</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="typ" style="color:rgb(102,0,102);">_GetLastBlock</span><span class="pun" style="color:rgb(102,102,0);">()</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">const</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li>
   <li class="L1" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pun" style="color:rgb(102,102,0);">};</span></code></li>
  </ol>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">第1行 创建区块链类第2行 public修饰符第3行 默认构造函数第5行 AddBlock() 增加区块函数，参数为我们前面创建的Block类的对象bNew第7行 private修饰符，后面的变量和方法是私有的第8-9行 私有变量</p>
  <ul style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">
   <li>_nDifficulty难度值</li>
   <li>_vChain保存区块的变量第11行 _GetLastBlock()获取最新的区块，由const关键字，表示输出的内容不可更改</li>
  </ul>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">因为区块链使用密码学，所以我们区块链需要一些加密函数。 我们将使用SHA256哈希来创建块的哈希值，（我们可以编写自己的SHA256函数，但是没必要重复造轮子），为了让编码更加简单，引用了来自<a href="http://www.zedwood.com/article/cpp-sha256-function" rel="nofollow" title="Zedwood" style="background-position:0px 0px;color:rgb(65,131,196);">Zedwood</a>的C++ sha256函数，该链接中有sha256.h，sha256.cpp和LICENSE.txt文件，我们将它们保存在项目文件夹中。（译者注：<a href="http://forum.360bchain.com/comments.php?DiscussionID=128" rel="nofollow" title="可以使用译者提供的centos系统可以变编译运行的代码" style="background-position:0px 0px;color:rgb(65,131,196);">可以使用译者提供的centos系统可以变编译运行的代码</a>）</p>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">好的，让我们继续</p>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">接下来我们的区块创建一个源文件Block.cpp并保存到主项目文件夹中首先添加这些行，告诉编译器包含我们之前添加的Block.h和sha256.h文件。</p>
  <pre class="prettyprint linenums prettyprinted" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;line-height:1.6;color:rgb(51,51,51);background:rgb(246,246,246);border-width:1px;border-style:solid;border-color:rgb(221,221,221);text-align:left;"></pre>
  <ol class="linenums" style="color:rgb(153,153,153);">
   <li class="L0"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="com" style="color:rgb(136,0,0);">#include</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="str" style="color:rgb(0,136,0);">"Block.h"</span></code></li>
   <li class="L1" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="com" style="color:rgb(136,0,0);">#include</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="str" style="color:rgb(0,136,0);">"sha256.h"</span></code></li>
  </ol>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">下面实现区块构造函数：</p>
  <pre class="prettyprint linenums prettyprinted" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;line-height:1.6;color:rgb(51,51,51);background:rgb(246,246,246);border-width:1px;border-style:solid;border-color:rgb(221,221,221);text-align:left;"></pre>
  <ol class="linenums" style="color:rgb(153,153,153);">
   <li class="L0"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="typ" style="color:rgb(102,0,102);">Block</span><span class="pun" style="color:rgb(102,102,0);">::</span><span class="typ" style="color:rgb(102,0,102);">Block</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="typ" style="color:rgb(102,0,102);">uint32_t</span><span class="pln" style="color:rgb(0,0,0);"> nIndexIn</span><span class="pun" style="color:rgb(102,102,0);">,</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">const</span><span class="pln" style="color:rgb(0,0,0);"> string </span><span class="pun" style="color:rgb(102,102,0);">&amp;</span><span class="pln" style="color:rgb(0,0,0);">sDataIn</span><span class="pun" style="color:rgb(102,102,0);">)</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">:</span><span class="pln" style="color:rgb(0,0,0);"> _nIndex</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">nIndexIn</span><span class="pun" style="color:rgb(102,102,0);">),</span><span class="pln" style="color:rgb(0,0,0);"> _sData</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">sDataIn</span><span class="pun" style="color:rgb(102,102,0);">)</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">{</span></code></li>
   <li class="L1" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> _nNonce </span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">-</span><span class="lit" style="color:rgb(0,102,102);">1</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li>
   <li class="L2"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> _tTime </span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="pln" style="color:rgb(0,0,0);"> time</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="kwd" style="color:rgb(0,0,136);">nullptr</span><span class="pun" style="color:rgb(102,102,0);">);</span></code></li>
   <li class="L3" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pun" style="color:rgb(102,102,0);">}</span></code></li>
  </ol>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">第1行 将参数的内容赋值给变量_nIndex和_sData中。第2行 _nNonce变量设置为-1。第3行 _tTime变量设置为当前时间。</p>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">实现访问区块的HASH函数：</p>
  <pre class="prettyprint linenums prettyprinted" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;line-height:1.6;color:rgb(51,51,51);background:rgb(246,246,246);border-width:1px;border-style:solid;border-color:rgb(221,221,221);text-align:left;"></pre>
  <ol class="linenums" style="color:rgb(153,153,153);">
   <li class="L0"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);">string </span><span class="typ" style="color:rgb(102,0,102);">Block</span><span class="pun" style="color:rgb(102,102,0);">::</span><span class="typ" style="color:rgb(102,0,102);">GetHash</span><span class="pun" style="color:rgb(102,102,0);">()</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">{</span></code></li>
   <li class="L1" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">return</span><span class="pln" style="color:rgb(0,0,0);"> _sHash</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li>
   <li class="L2"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pun" style="color:rgb(102,102,0);">}</span></code></li>
  </ol>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">第2行 返回私有变量_sHash的值</p>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">您可能已经清楚，比特币数字货币中设计区块链技术非常受欢迎，使得分类账不能被修改或者保密;这意味着，当一个用户将比特币发送给另一个用户时，比特币网络上的节点将转账交易写到区块链中的一个区块中。另一台计算机作为一个节点运行比特币软件（因为比特币网络是P2P，所以该节点可以是世界上任何一个人运行）;这个过程被称为“挖矿”，每当他们在区块链上成功创建一个有效的区块时，该节点将获得相应的比特币奖励。</p>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">如果想成功创建一个有效的区块并因此获得奖励，矿工必须创建一个有效的区块加密HASH添加到区块链中。 有效区块HASH是通过计算HASH开头零的数量来实现的；如果零的数量等于或大于网络设置的难度，则表示有效，否则将增加随机数后重新创建散列;直到生成一个有效的散列。 这个过程称为工作量证明（Proof of Work，PoW）。</p>
  <h1 style="font-size:2.25em;font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;line-height:1.2;color:rgb(51,51,51);border-bottom:1px solid rgb(238,238,238);text-align:left;"><a class="reference-link" style="background-position:0px 0px;color:rgb(65,131,196);"></a>挖矿过程-工作量证明</h1>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">接下来，我们实现MineBlock方法来复现上述过程</p>
  <pre class="prettyprint linenums prettyprinted" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;line-height:1.6;color:rgb(51,51,51);background:rgb(246,246,246);border-width:1px;border-style:solid;border-color:rgb(221,221,221);text-align:left;"></pre>
  <ol class="linenums" style="color:rgb(153,153,153);">
   <li class="L0"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="kwd" style="color:rgb(0,0,136);">void</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="typ" style="color:rgb(102,0,102);">Block</span><span class="pun" style="color:rgb(102,102,0);">::</span><span class="typ" style="color:rgb(102,0,102);">MineBlock</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="typ" style="color:rgb(102,0,102);">uint32_t</span><span class="pln" style="color:rgb(0,0,0);"> nDifficulty</span><span class="pun" style="color:rgb(102,102,0);">)</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">{</span></code></li>
   <li class="L1" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">char</span><span class="pln" style="color:rgb(0,0,0);"> cstr</span><span class="pun" style="color:rgb(102,102,0);">[</span><span class="pln" style="color:rgb(0,0,0);">nDifficulty </span><span class="pun" style="color:rgb(102,102,0);">+</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="lit" style="color:rgb(0,102,102);">1</span><span class="pun" style="color:rgb(102,102,0);">];</span></code></li>
   <li class="L2"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">for</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="typ" style="color:rgb(102,0,102);">uint32_t</span><span class="pln" style="color:rgb(0,0,0);"> i </span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="lit" style="color:rgb(0,102,102);">0</span><span class="pun" style="color:rgb(102,102,0);">;</span><span class="pln" style="color:rgb(0,0,0);"> i </span><span class="pun" style="color:rgb(102,102,0);">&lt;</span><span class="pln" style="color:rgb(0,0,0);"> nDifficulty</span><span class="pun" style="color:rgb(102,102,0);">;</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">++</span><span class="pln" style="color:rgb(0,0,0);">i</span><span class="pun" style="color:rgb(102,102,0);">)</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">{</span></code></li>
   <li class="L3" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> cstr</span><span class="pun" style="color:rgb(102,102,0);">[</span><span class="pln" style="color:rgb(0,0,0);">i</span><span class="pun" style="color:rgb(102,102,0);">]</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="str" style="color:rgb(0,136,0);">'0'</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li>
   <li class="L4"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">}</span></code></li>
   <li class="L5" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> cstr</span><span class="pun" style="color:rgb(102,102,0);">[</span><span class="pln" style="color:rgb(0,0,0);">nDifficulty</span><span class="pun" style="color:rgb(102,102,0);">]</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="str" style="color:rgb(0,136,0);">'\0'</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li>
   <li class="L6"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"></code></li>
   <li class="L7" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> string str</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">cstr</span><span class="pun" style="color:rgb(102,102,0);">);</span></code></li>
   <li class="L8"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"></code></li>
   <li class="L9" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">do</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">{</span></code></li>
   <li class="L0"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> _nNonce</span><span class="pun" style="color:rgb(102,102,0);">++;</span></code></li>
   <li class="L1" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> _sHash </span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="typ" style="color:rgb(102,0,102);">_CalculateHash</span><span class="pun" style="color:rgb(102,102,0);">();</span></code></li>
   <li class="L2"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">}</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">while</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">_sHash</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">substr</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="lit" style="color:rgb(0,102,102);">0</span><span class="pun" style="color:rgb(102,102,0);">,</span><span class="pln" style="color:rgb(0,0,0);"> nDifficulty</span><span class="pun" style="color:rgb(102,102,0);">)</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">!=</span><span class="pln" style="color:rgb(0,0,0);"> str</span><span class="pun" style="color:rgb(102,102,0);">);</span></code></li>
   <li class="L3" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"></code></li>
   <li class="L4"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> cout </span><span class="pun" style="color:rgb(102,102,0);">&lt;&lt;</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="str" style="color:rgb(0,136,0);">"Block mined: "</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">&lt;&lt;</span><span class="pln" style="color:rgb(0,0,0);"> _sHash </span><span class="pun" style="color:rgb(102,102,0);">&lt;&lt;</span><span class="pln" style="color:rgb(0,0,0);"> endl</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li>
   <li class="L5" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pun" style="color:rgb(102,102,0);">}</span></code></li>
  </ol>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">第1行 MineBlock函数在block.h文件中声明，参数nDifficulty为难度第2行 创建一个难度大于nDifficulty的值的字符数据第3-6行 用0填充数组，最后一个字符填充为终止符\0第8行 将字符数组转换为string字符串第10-13行 循环增加随机数，并且计算HASH值保存到_sHash中。循环结束的条件是比较生成的HASH值和刚刚创建的零串，一旦匹配则跳出循环，否则继续生成HASH第15行 一旦找到匹配，就会向输出发送该区块的HASH值，表示该块已成功开采。</p>
  <h1 style="font-size:2.25em;font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;line-height:1.2;color:rgb(51,51,51);border-bottom:1px solid rgb(238,238,238);text-align:left;"><a class="reference-link" style="background-position:0px 0px;color:rgb(65,131,196);"></a>区块HASH计算</h1>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">我们前面已经看到它好几次，所以接下来添加_CalculateHash方法：</p>
  <pre class="prettyprint linenums prettyprinted" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;line-height:1.6;color:rgb(51,51,51);background:rgb(246,246,246);border-width:1px;border-style:solid;border-color:rgb(221,221,221);text-align:left;"></pre>
  <ol class="linenums" style="color:rgb(153,153,153);">
   <li class="L0"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="kwd" style="color:rgb(0,0,136);">inline</span><span class="pln" style="color:rgb(0,0,0);"> string </span><span class="typ" style="color:rgb(102,0,102);">Block</span><span class="pun" style="color:rgb(102,102,0);">::</span><span class="typ" style="color:rgb(102,0,102);">_CalculateHash</span><span class="pun" style="color:rgb(102,102,0);">()</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">const</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">{</span></code></li>
   <li class="L1" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> stringstream ss</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li>
   <li class="L2"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> ss </span><span class="pun" style="color:rgb(102,102,0);">&lt;&lt;</span><span class="pln" style="color:rgb(0,0,0);"> _nIndex </span><span class="pun" style="color:rgb(102,102,0);">&lt;&lt;</span><span class="pln" style="color:rgb(0,0,0);"> _tTime </span><span class="pun" style="color:rgb(102,102,0);">&lt;&lt;</span><span class="pln" style="color:rgb(0,0,0);"> _sData </span><span class="pun" style="color:rgb(102,102,0);">&lt;&lt;</span><span class="pln" style="color:rgb(0,0,0);"> _nNonce </span><span class="pun" style="color:rgb(102,102,0);">&lt;&lt;</span><span class="pln" style="color:rgb(0,0,0);"> sPrevHash</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li>
   <li class="L3" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"></code></li>
   <li class="L4"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">return</span><span class="pln" style="color:rgb(0,0,0);"> sha256</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">ss</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">str</span><span class="pun" style="color:rgb(102,102,0);">());</span></code></li>
   <li class="L5" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pun" style="color:rgb(102,102,0);">}</span></code></li>
  </ol>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">第1行 该函数在Block.h头文件中声明，inline关键字修饰，表示编译器编译时将该函数代码嵌入到其他函数中，减少了函数的调用开销（译者注：inline通常用在循环体内）<br>第2行 创建一个字符串流ss。<br>第3行 将_nIndex，_tTime，_sData，_nNonce和sPrevHash的值附加到流字符串流ss中。<br>第5行 将字符串流ss的sha256值输出</p>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">增加区块链文件Blockchain.cpp到主项目文件夹中。</p>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">下面的代码编译器包含添加的Blockchain.h文件。</p>
  <pre class="prettyprint linenums prettyprinted" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;line-height:1.6;color:rgb(51,51,51);background:rgb(246,246,246);border-width:1px;border-style:solid;border-color:rgb(221,221,221);text-align:left;"></pre>
  <ol class="linenums" style="color:rgb(153,153,153);">
   <li class="L0"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="com" style="color:rgb(136,0,0);">#include</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="str" style="color:rgb(0,136,0);">"Blockchain.h"</span></code></li>
  </ol>
  <h1 style="font-size:2.25em;font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;line-height:1.2;color:rgb(51,51,51);border-bottom:1px solid rgb(238,238,238);text-align:left;"><a class="reference-link" style="background-position:0px 0px;color:rgb(65,131,196);"></a>创世块的产生</h1>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">接下来，我们实现区块链构造函数</p>
  <pre class="prettyprint linenums prettyprinted" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;line-height:1.6;color:rgb(51,51,51);background:rgb(246,246,246);border-width:1px;border-style:solid;border-color:rgb(221,221,221);text-align:left;"></pre>
  <ol class="linenums" style="color:rgb(153,153,153);">
   <li class="L0"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="typ" style="color:rgb(102,0,102);">Blockchain</span><span class="pun" style="color:rgb(102,102,0);">::</span><span class="typ" style="color:rgb(102,0,102);">Blockchain</span><span class="pun" style="color:rgb(102,102,0);">()</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">{</span></code></li>
   <li class="L1" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> _vChain</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">emplace_back</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="typ" style="color:rgb(102,0,102);">Block</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="lit" style="color:rgb(0,102,102);">0</span><span class="pun" style="color:rgb(102,102,0);">,</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="str" style="color:rgb(0,136,0);">"Genesis Block"</span><span class="pun" style="color:rgb(102,102,0);">));</span></code></li>
   <li class="L2"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> _nDifficulty </span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="lit" style="color:rgb(0,102,102);">3</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li>
   <li class="L3" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pun" style="color:rgb(102,102,0);">}</span></code></li>
  </ol>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">第1行 区块链构造函数，生成“创世块”。<br>因为将区块添加到区块链中时，需要添加前一个区块HASH值，所以区块链必须从某处开始，我们称最开始的那个区块为“创世块”。<br>第2行 将生成的区块放在向量_vChain中。<br>emplace_back()函数，在容器_vChain尾部添加一个元素，这个元素原地构造，不需要触发拷贝构造和转移构造。<br>第3行 设置工作量POW的难度值（即区块HASH前面有多少个零）</p>
  <h1 style="font-size:2.25em;font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;line-height:1.2;color:rgb(51,51,51);border-bottom:1px solid rgb(238,238,238);text-align:left;"><a class="reference-link" style="background-position:0px 0px;color:rgb(65,131,196);"></a>添加区块</h1>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">现在，我们实现区块增加函数</p>
  <pre class="prettyprint linenums prettyprinted" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;line-height:1.6;color:rgb(51,51,51);background:rgb(246,246,246);border-width:1px;border-style:solid;border-color:rgb(221,221,221);text-align:left;"></pre>
  <ol class="linenums" style="color:rgb(153,153,153);">
   <li class="L0"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="kwd" style="color:rgb(0,0,136);">void</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="typ" style="color:rgb(102,0,102);">Blockchain</span><span class="pun" style="color:rgb(102,102,0);">::</span><span class="typ" style="color:rgb(102,0,102);">AddBlock</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="typ" style="color:rgb(102,0,102);">Block</span><span class="pln" style="color:rgb(0,0,0);"> bNew</span><span class="pun" style="color:rgb(102,102,0);">)</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">{</span></code></li>
   <li class="L1" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> bNew</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">sPrevHash </span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="typ" style="color:rgb(102,0,102);">_GetLastBlock</span><span class="pun" style="color:rgb(102,102,0);">().</span><span class="typ" style="color:rgb(102,0,102);">GetHash</span><span class="pun" style="color:rgb(102,102,0);">();</span></code></li>
   <li class="L2"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> bNew</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="typ" style="color:rgb(102,0,102);">MineBlock</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">_nDifficulty</span><span class="pun" style="color:rgb(102,102,0);">);</span></code></li>
   <li class="L3" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> _vChain</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">push_back</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">bNew</span><span class="pun" style="color:rgb(102,102,0);">);</span></code></li>
   <li class="L4"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pun" style="color:rgb(102,102,0);">}</span></code></li>
  </ol>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">第1行 该函数是在Blockchain.h文件中申明，参数为区块对象第2行 将上一区块的hash值（_vChain的最后一个区块HASH值）保存到sPrevHash中第3行 挖矿，参数为_nDifficulty难度值第4行 将新挖的区块保存到_vChain向量的末尾</p>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">让我们实现区块链的最后一个方法</p>
  <pre class="prettyprint linenums prettyprinted" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;line-height:1.6;color:rgb(51,51,51);background:rgb(246,246,246);border-width:1px;border-style:solid;border-color:rgb(221,221,221);text-align:left;"></pre>
  <ol class="linenums" style="color:rgb(153,153,153);">
   <li class="L0"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="typ" style="color:rgb(102,0,102);">Block</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="typ" style="color:rgb(102,0,102);">Blockchain</span><span class="pun" style="color:rgb(102,102,0);">::</span><span class="typ" style="color:rgb(102,0,102);">_GetLastBlock</span><span class="pun" style="color:rgb(102,102,0);">()</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">const</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">{</span></code></li>
   <li class="L1" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">return</span><span class="pln" style="color:rgb(0,0,0);"> _vChain</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">back</span><span class="pun" style="color:rgb(102,102,0);">();</span></code></li>
   <li class="L2"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pun" style="color:rgb(102,102,0);">}</span></code></li>
  </ol>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">第1行 该函数是在Blockchain.h头文件中声明<br>第2行 返回向量_vChain的最后一个元素</p>
  <h1 style="font-size:2.25em;font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;line-height:1.2;color:rgb(51,51,51);border-bottom:1px solid rgb(238,238,238);text-align:left;"><a class="reference-link" style="background-position:0px 0px;color:rgb(65,131,196);"></a>主函数</h1>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">新建main.cpp（挖掘三个区块后退出程序）</p>
  <pre class="prettyprint linenums prettyprinted" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;line-height:1.6;color:rgb(51,51,51);background:rgb(246,246,246);border-width:1px;border-style:solid;border-color:rgb(221,221,221);text-align:left;"></pre>
  <ol class="linenums" style="color:rgb(153,153,153);">
   <li class="L0"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="com" style="color:rgb(136,0,0);">#include</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="str" style="color:rgb(0,136,0);">"Blockchain.h"</span></code></li>
   <li class="L1" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="typ" style="color:rgb(102,0,102);">int</span><span class="pln" style="color:rgb(0,0,0);"> main</span><span class="pun" style="color:rgb(102,102,0);">()</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">{</span></code></li>
   <li class="L2"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> </span><span class="typ" style="color:rgb(102,0,102);">Blockchain</span><span class="pln" style="color:rgb(0,0,0);"> bChain </span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="typ" style="color:rgb(102,0,102);">Blockchain</span><span class="pun" style="color:rgb(102,102,0);">();</span></code></li>
   <li class="L3" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"></code></li>
   <li class="L4"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> cout </span><span class="pun" style="color:rgb(102,102,0);">&lt;&lt;</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="str" style="color:rgb(0,136,0);">"Mining block 1..."</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">&lt;&lt;</span><span class="pln" style="color:rgb(0,0,0);"> endl</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li>
   <li class="L5" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> bChain</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="typ" style="color:rgb(102,0,102);">AddBlock</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="typ" style="color:rgb(102,0,102);">Block</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="lit" style="color:rgb(0,102,102);">1</span><span class="pun" style="color:rgb(102,102,0);">,</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="str" style="color:rgb(0,136,0);">"Block 1 Data"</span><span class="pun" style="color:rgb(102,102,0);">));</span></code></li>
   <li class="L6"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"></code></li>
   <li class="L7" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> cout </span><span class="pun" style="color:rgb(102,102,0);">&lt;&lt;</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="str" style="color:rgb(0,136,0);">"Mining block 2..."</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">&lt;&lt;</span><span class="pln" style="color:rgb(0,0,0);"> endl</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li>
   <li class="L8"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> bChain</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="typ" style="color:rgb(102,0,102);">AddBlock</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="typ" style="color:rgb(102,0,102);">Block</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="lit" style="color:rgb(0,102,102);">2</span><span class="pun" style="color:rgb(102,102,0);">,</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="str" style="color:rgb(0,136,0);">"Block 2 Data"</span><span class="pun" style="color:rgb(102,102,0);">));</span></code></li>
   <li class="L9" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"></code></li>
   <li class="L0"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> cout </span><span class="pun" style="color:rgb(102,102,0);">&lt;&lt;</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="str" style="color:rgb(0,136,0);">"Mining block 3..."</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">&lt;&lt;</span><span class="pln" style="color:rgb(0,0,0);"> endl</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li>
   <li class="L1" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> bChain</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="typ" style="color:rgb(102,0,102);">AddBlock</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="typ" style="color:rgb(102,0,102);">Block</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="lit" style="color:rgb(0,102,102);">3</span><span class="pun" style="color:rgb(102,102,0);">,</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="str" style="color:rgb(0,136,0);">"Block 3 Data"</span><span class="pun" style="color:rgb(102,102,0);">));</span></code></li>
   <li class="L2"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"></code></li>
   <li class="L3" style="background:rgb(238,238,238);"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">return</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="lit" style="color:rgb(0,102,102);">0</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li>
   <li class="L4"><code class="lang-cpp" style="font-family:'YaHei Consolas Hybrid', Consolas, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Helvetica, monospace, monospace;color:inherit;background:0px 0px;border:none;line-height:inherit;"><span class="pun" style="color:rgb(102,102,0);">}</span></code></li>
  </ol>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">源码目录结构以及编译情况<br><img src="http://img.360bchain.com/pictures/3U/5af1b771797ed.png" alt="" style="border:0px;vertical-align:middle;"><br>挖矿过程<br><img src="http://img.360bchain.com/pictures/RW/5af1b7a927aae.png" alt="" style="border:0px;vertical-align:middle;"></p>
  <h1 style="font-size:2.25em;font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;line-height:1.2;color:rgb(51,51,51);border-bottom:1px solid rgb(238,238,238);text-align:left;"><a class="reference-link" style="background-position:0px 0px;color:rgb(65,131,196);"></a><a href="http://forum.360bchain.com/comments.php?DiscussionID=128" rel="nofollow" title="源码下载" style="background-position:0px 0px;color:rgb(65,131,196);">请点击下载源码</a></h1>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">源码介绍文档请阅读<a href="http://www.360bchain.com/article/117.html" rel="nofollow" title="《一步步教小白使用C++构建区块链》" style="background-position:0px 0px;color:rgb(65,131,196);">《一步步教小白使用C++构建区块链》</a></p>
  <p style="color:rgb(51,51,51);font-family:'Microsoft YaHei', Helvetica, 'Meiryo UI', 'Malgun Gothic', 'Segoe UI', 'Trebuchet MS', Monaco, monospace, Tahoma, STXihei, '华文细黑', STHeiti, 'Helvetica Neue', 'Droid Sans', 'wenquanyi micro hei', FreeSans, Arimo, Arial, SimSun, '宋体', Heiti, '黑体', sans-serif;font-size:14px;text-align:left;">作者：davenash<br>链接：<a href="http://davenash.com/2017/10/build-a-blockchain-with-c/" rel="nofollow" style="background-position:0px 0px;color:rgb(65,131,196);">http://davenash.com/2017/10/build-a-blockchain-with-c/</a><br>版权声明：作者保留权利。文章为作者独立观点，不代表B链网立场。严禁修改，转载请注明原文链接</p> 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/Tostick/article/details/80247856,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/Tostick/article/details/80247856,&quot;}">阅读更多</a> 
</div>
      <br />
        <a href="https://blog.uzzz.org/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://blog.uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://blog.uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?ee64533f3c6a7a284cd39a37ee732c8b";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
    
    <script>
    (function(){
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        }
        else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
    </script>

  </body>
</html>
