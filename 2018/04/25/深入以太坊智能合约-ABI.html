<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>深入以太坊智能合约 ABI | 有组织在！</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="深入以太坊智能合约 ABI" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="开发 DApp 时要调用在区块链上的以太坊智能合约，就需要智能合约的 ABI。本文希望更多了解 ABI，如为什么需要 ABI？如何解读 Ethereum 的智能合约 ABI？以及如何取得合约的 ABI？ 数字猫合约 ABI ABI（Application Binary Interface） 如果理解 API 就很容易了解 ABI。简单来说，API 是程序与程序间互动的接口。这个接口包含程序提供外界存取所需的 functions、variables 等。ABI 也是程序间互动的接口，但程序是被编译后的 binary code。所以同样的接口，但传递的是 binary 格式的信息。所以 ABI 就要描述如何 decode/encode 程序间传递的 binary 信息。下图以 Linux 为例，描述 Linux 中 API、ABI 和程序的关系。 Linux API and ABI 编译和部署智能合约 在 Ethereum 智能合约可以被大家使用前，必须先被部署到区块链上。 从智能合约的代码到使用智能合约，大概包含几个步骤： 编写智能合约的代码（一般是用 Solidity 写） 编译智能合约的代码变成可在 EVM 上执行的 bytecode（binary code）。同时可以通过编译取得智能合约的 ABI 部署智能合约，实际上是把 bytecode 存储在链上（通过一个transaction），并取得一个专属于这个合约的地址 如果要写个程序调用这个智能合约，就要把信息发送到这个合约的地址（一样的也是通过一个 transaction）。Ethereum 节点会根据输入的信息，选择要执行合约中的哪一个 function 和要输入的参数 而要如何知道這这个智能合约提供哪些 function 以及应该要传入什么样的参数呢？这些信息就是记录在智能合约的 ABI！ Ethereum 智能合约 ABI Ethereum 智能合约 ABI 用一个 array 表示，其中会包含数个用 JSON 格式表示的 Function 或 Event。根据最新的 Solidity 文件： Function 共有 7 个参数： name：a string，function 名称 type：a string，&quot;function&quot;, &quot;constructor&quot;, or &quot;fallback&quot; inputs：an array，function 输入的参数，包含： name：a string，参数名 type：a string，参数的 data type(e.g. uint256) components：an array，如果输入的参数是 tuple(struct) type 才会有这个参数。描述 struct 中包含的参数类型 outputs：an array，function 的返回值，和&nbsp;inputs&nbsp;使用相同表示方式。如果沒有返回值可忽略，值为&nbsp;[] payable：true，function 是否可收 Ether，预设为&nbsp;false constant：true，function 是否会改写区块链状态，反之为&nbsp;false stateMutability：a string，其值可能为以下其中之一：&quot;pure&quot;（不会读写区块链状态）、&quot;view&quot;（只读不写区块链状态）、&quot;payable&quot; and &quot;nonpayable&quot;（会改区块链状态，且如可收 Ether 为 &quot;payable&quot;，反之为 &quot;nonpayable&quot;） 仔细看会发现&nbsp;payable&nbsp;和&nbsp;constant&nbsp;这两个参数所描述的內容，似乎已包含在&nbsp;stateMutability&nbsp;中。 事实也确实是这样的，在&nbsp;Solidity v0.4.16&nbsp;中把&nbsp;constant&nbsp;这个修饰function 的 key words 分成：&nbsp;view（neither reads from nor writes to the state）和&nbsp;pure（does not modify the state），并从 v0.4.17 开始 Type Checker 会强制检查。constant&nbsp;改为只用来修饰不能被修改的 variable。并在 ABI 中加入&nbsp;stateMutability&nbsp;这个参数统一表示，payable&nbsp;和&nbsp;constant&nbsp;目前保留是为了向后兼容。这个改动详细的內容和讨论可参考：https://github.com/ethereum/solidity/issues/992 Event 共有 4 个参数： name: a string，event 的名称 type: a string，always &quot;event&quot; inputs: an array，输入参数，包含： name: a string，参数名称 type: a string，参数的 data type(e.g. uint256) components: an array，如果输入参数是 tuple(struct) type 才会有这个参数。描述 struct 中包含的信息类型 indexed:&nbsp;true，如果这个参数被定义为 indexed ，反之为&nbsp;false anonymous:&nbsp;true，如果 event 被定义为 anonymous 更新智能合约状态需要发送 transaction，transaction 需要等待验证，所以更新合约状态是非同步的，无法马上取得返回值。使用 Event 可以在状态更新成功后，将相关信息记录到 Log，并让监听这个 Event 的 DApp 或任何应用这个接口的程序收到通知。每笔 transaction 都有对应的 Log。 所以简单来说，Event 可用來：1. 取得 function 更新合约状态的返回值 2. 也可作为合约另外的存储空间。 Event 的参数分为：有&nbsp;indexed，和其他没有&nbsp;indexed&nbsp;的。有&nbsp;indexed&nbsp;的参数可以使用 filter，例如同一个 Event，我可以选择只监听从特定 address 发出来的交易。每笔 Log 的信息同样分为两个部分：Topics（长度最多为 4 的 array） 和 Data。有&nbsp;indexed&nbsp;的参数会存储存在 Log 的 Topics，其他的存在 Data。如果定义为&nbsp;anonymous，就不会产生以下示例中的 Topics[0]，其值为 Event signature 的 hash，作为這個 Event 的 ID。 Event event Set(address indexed _from, uint value) 用一个简单的智能合约举个例子 这个智能合约包含： data：一个可修改的 state variable，会自动产生一个只能读取的&nbsp;data()&nbsp;function set()：一个修改&nbsp;data&nbsp;值的 function Set()：一个在每次修写&nbsp;data&nbsp;时记录 Log 的 event 智能合约 Source Code： pragma solidity ^0.4.20; contract SimpleStorage { uint public data; event Set(address indexed _from, uint value); function set(uint x) public { data = x; Set(msg.sender, x); } } 智能合约 ABI： [{ &quot;constant&quot;: true, &quot;inputs&quot;: [], &quot;name&quot;: &quot;data&quot;, &quot;outputs&quot;: [{&quot;name&quot;: &quot;&quot;,&quot;type&quot;: &quot;uint256&quot;}], &quot;payable&quot;: false, &quot;stateMutabㄒility&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;anonymous&quot;: false, &quot;inputs&quot;: [{&quot;indexed&quot;: true,&quot;name&quot;: &quot;_from&quot;,&quot;type&quot;: &quot;address&quot;},{&quot;indexed&quot;: false,&quot;name&quot;: &quot;value&quot;,&quot;type&quot;: &quot;uint256&quot;}], &quot;name&quot;: &quot;Set&quot;, &quot;type&quot;: &quot;event&quot; }, { &quot;constant&quot;: false, &quot;inputs&quot;: [{&quot;name&quot;: &quot;x&quot;,&quot;type&quot;: &quot;uint256&quot;}], &quot;name&quot;: &quot;set&quot;, &quot;outputs&quot;: [], &quot;payable&quot;: false, &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }] 取得 Ethereum 智能合约 ABI Solidity Compiler 可以用 Solidity Compiler 取得合约 ABI，我使用 JavaScript 版本的 Compiler 为例。 安装： npm install solc -g 取得合约 ABI： solcjs simpleStorage.sol --abi 会生成一个 simpleStorage_sol_SimpleStorage.abi 文件，里面就是合约ABI 內容。 也可以取得合约的 binary code： solcjs your_contract.sol --bin Remix 同样的使用 Solidity Compiler，也可以用 Remix。在合约的 Details 可以看到完整的 ABI。可以在 Settings 中指定 Compiler 版本。 Remix Etherscan 许多知名合约会把合约 source code 放上 Etherscan 做验证，可以同时看到h 合约ABI。 Etherscan 另外 Etherscan 提供&nbsp;API，可用来取得经过验证的合约 ABI。 http://www.eho1460.cn/http://www.dyy3200.cn/http://www.tdw5546.cn/http://www.mtj9347.cn/http://www.osi0013.cn/http://www.bjb5476.cn/http://www.ghk5310.cn/http://www.xjy3902.cn/http://www.grp2563.cn/http://www.lkg4662.cn/http://www.vwb8311.cn/http://www.mmw6064.cn/http://www.cqz7056.cn/http://www.nlk4583.cn/http://www.adw2245.cn/http://www.alj9141.cn/http://www.vdf1425.cn/http://www.miv2453.cn/http://www.vdx0926.cn/http://www.smc5776.cn/http://www.ffn3573.cn/http://www.rdj9135.cn/http://www.mtu9335.cn/http://www.gzv8338.cn/http://www.xum5501.cn/http://www.jiq1934.cn/http://www.syh5891.cn/http://www.yvr8830.cn/http://www.aua2439.cn/http://www.ath0401.cn/http://www.gmx2930.cn/http://www.pzf7790.cn/http://www.ass0795.cn/http://www.mox2684.cn/http://www.oqc1977.cn/http://www.bcu6005.cn/http://www.ajj5951.cn/http://www.xwt5617.cn/http://www.rlv0165.cn/http://www.shg1037.cn/http://www.akj0836.cn/http://www.ipc6507.cn/http://www.kri6555.cn/http://www.mzj8672.cn/http://www.azq7227.cn/http://www.zce9839.cn/http://www.gjc9646.cn/http://www.myo1179.cn/http://www.ogr7085.cn/http://www.bah1564.cn/http://www.mjg4415.cn/http://www.dkk2480.cn/http://www.qru6126.cn/http://www.ocs5821.cn/http://www.wne9476.cn/http://www.xuh4863.cn/http://www.icb3050.cn/http://www.tfe0886.cn/ 阅读更多" />
<meta property="og:description" content="开发 DApp 时要调用在区块链上的以太坊智能合约，就需要智能合约的 ABI。本文希望更多了解 ABI，如为什么需要 ABI？如何解读 Ethereum 的智能合约 ABI？以及如何取得合约的 ABI？ 数字猫合约 ABI ABI（Application Binary Interface） 如果理解 API 就很容易了解 ABI。简单来说，API 是程序与程序间互动的接口。这个接口包含程序提供外界存取所需的 functions、variables 等。ABI 也是程序间互动的接口，但程序是被编译后的 binary code。所以同样的接口，但传递的是 binary 格式的信息。所以 ABI 就要描述如何 decode/encode 程序间传递的 binary 信息。下图以 Linux 为例，描述 Linux 中 API、ABI 和程序的关系。 Linux API and ABI 编译和部署智能合约 在 Ethereum 智能合约可以被大家使用前，必须先被部署到区块链上。 从智能合约的代码到使用智能合约，大概包含几个步骤： 编写智能合约的代码（一般是用 Solidity 写） 编译智能合约的代码变成可在 EVM 上执行的 bytecode（binary code）。同时可以通过编译取得智能合约的 ABI 部署智能合约，实际上是把 bytecode 存储在链上（通过一个transaction），并取得一个专属于这个合约的地址 如果要写个程序调用这个智能合约，就要把信息发送到这个合约的地址（一样的也是通过一个 transaction）。Ethereum 节点会根据输入的信息，选择要执行合约中的哪一个 function 和要输入的参数 而要如何知道這这个智能合约提供哪些 function 以及应该要传入什么样的参数呢？这些信息就是记录在智能合约的 ABI！ Ethereum 智能合约 ABI Ethereum 智能合约 ABI 用一个 array 表示，其中会包含数个用 JSON 格式表示的 Function 或 Event。根据最新的 Solidity 文件： Function 共有 7 个参数： name：a string，function 名称 type：a string，&quot;function&quot;, &quot;constructor&quot;, or &quot;fallback&quot; inputs：an array，function 输入的参数，包含： name：a string，参数名 type：a string，参数的 data type(e.g. uint256) components：an array，如果输入的参数是 tuple(struct) type 才会有这个参数。描述 struct 中包含的参数类型 outputs：an array，function 的返回值，和&nbsp;inputs&nbsp;使用相同表示方式。如果沒有返回值可忽略，值为&nbsp;[] payable：true，function 是否可收 Ether，预设为&nbsp;false constant：true，function 是否会改写区块链状态，反之为&nbsp;false stateMutability：a string，其值可能为以下其中之一：&quot;pure&quot;（不会读写区块链状态）、&quot;view&quot;（只读不写区块链状态）、&quot;payable&quot; and &quot;nonpayable&quot;（会改区块链状态，且如可收 Ether 为 &quot;payable&quot;，反之为 &quot;nonpayable&quot;） 仔细看会发现&nbsp;payable&nbsp;和&nbsp;constant&nbsp;这两个参数所描述的內容，似乎已包含在&nbsp;stateMutability&nbsp;中。 事实也确实是这样的，在&nbsp;Solidity v0.4.16&nbsp;中把&nbsp;constant&nbsp;这个修饰function 的 key words 分成：&nbsp;view（neither reads from nor writes to the state）和&nbsp;pure（does not modify the state），并从 v0.4.17 开始 Type Checker 会强制检查。constant&nbsp;改为只用来修饰不能被修改的 variable。并在 ABI 中加入&nbsp;stateMutability&nbsp;这个参数统一表示，payable&nbsp;和&nbsp;constant&nbsp;目前保留是为了向后兼容。这个改动详细的內容和讨论可参考：https://github.com/ethereum/solidity/issues/992 Event 共有 4 个参数： name: a string，event 的名称 type: a string，always &quot;event&quot; inputs: an array，输入参数，包含： name: a string，参数名称 type: a string，参数的 data type(e.g. uint256) components: an array，如果输入参数是 tuple(struct) type 才会有这个参数。描述 struct 中包含的信息类型 indexed:&nbsp;true，如果这个参数被定义为 indexed ，反之为&nbsp;false anonymous:&nbsp;true，如果 event 被定义为 anonymous 更新智能合约状态需要发送 transaction，transaction 需要等待验证，所以更新合约状态是非同步的，无法马上取得返回值。使用 Event 可以在状态更新成功后，将相关信息记录到 Log，并让监听这个 Event 的 DApp 或任何应用这个接口的程序收到通知。每笔 transaction 都有对应的 Log。 所以简单来说，Event 可用來：1. 取得 function 更新合约状态的返回值 2. 也可作为合约另外的存储空间。 Event 的参数分为：有&nbsp;indexed，和其他没有&nbsp;indexed&nbsp;的。有&nbsp;indexed&nbsp;的参数可以使用 filter，例如同一个 Event，我可以选择只监听从特定 address 发出来的交易。每笔 Log 的信息同样分为两个部分：Topics（长度最多为 4 的 array） 和 Data。有&nbsp;indexed&nbsp;的参数会存储存在 Log 的 Topics，其他的存在 Data。如果定义为&nbsp;anonymous，就不会产生以下示例中的 Topics[0]，其值为 Event signature 的 hash，作为這個 Event 的 ID。 Event event Set(address indexed _from, uint value) 用一个简单的智能合约举个例子 这个智能合约包含： data：一个可修改的 state variable，会自动产生一个只能读取的&nbsp;data()&nbsp;function set()：一个修改&nbsp;data&nbsp;值的 function Set()：一个在每次修写&nbsp;data&nbsp;时记录 Log 的 event 智能合约 Source Code： pragma solidity ^0.4.20; contract SimpleStorage { uint public data; event Set(address indexed _from, uint value); function set(uint x) public { data = x; Set(msg.sender, x); } } 智能合约 ABI： [{ &quot;constant&quot;: true, &quot;inputs&quot;: [], &quot;name&quot;: &quot;data&quot;, &quot;outputs&quot;: [{&quot;name&quot;: &quot;&quot;,&quot;type&quot;: &quot;uint256&quot;}], &quot;payable&quot;: false, &quot;stateMutabㄒility&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;anonymous&quot;: false, &quot;inputs&quot;: [{&quot;indexed&quot;: true,&quot;name&quot;: &quot;_from&quot;,&quot;type&quot;: &quot;address&quot;},{&quot;indexed&quot;: false,&quot;name&quot;: &quot;value&quot;,&quot;type&quot;: &quot;uint256&quot;}], &quot;name&quot;: &quot;Set&quot;, &quot;type&quot;: &quot;event&quot; }, { &quot;constant&quot;: false, &quot;inputs&quot;: [{&quot;name&quot;: &quot;x&quot;,&quot;type&quot;: &quot;uint256&quot;}], &quot;name&quot;: &quot;set&quot;, &quot;outputs&quot;: [], &quot;payable&quot;: false, &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }] 取得 Ethereum 智能合约 ABI Solidity Compiler 可以用 Solidity Compiler 取得合约 ABI，我使用 JavaScript 版本的 Compiler 为例。 安装： npm install solc -g 取得合约 ABI： solcjs simpleStorage.sol --abi 会生成一个 simpleStorage_sol_SimpleStorage.abi 文件，里面就是合约ABI 內容。 也可以取得合约的 binary code： solcjs your_contract.sol --bin Remix 同样的使用 Solidity Compiler，也可以用 Remix。在合约的 Details 可以看到完整的 ABI。可以在 Settings 中指定 Compiler 版本。 Remix Etherscan 许多知名合约会把合约 source code 放上 Etherscan 做验证，可以同时看到h 合约ABI。 Etherscan 另外 Etherscan 提供&nbsp;API，可用来取得经过验证的合约 ABI。 http://www.eho1460.cn/http://www.dyy3200.cn/http://www.tdw5546.cn/http://www.mtj9347.cn/http://www.osi0013.cn/http://www.bjb5476.cn/http://www.ghk5310.cn/http://www.xjy3902.cn/http://www.grp2563.cn/http://www.lkg4662.cn/http://www.vwb8311.cn/http://www.mmw6064.cn/http://www.cqz7056.cn/http://www.nlk4583.cn/http://www.adw2245.cn/http://www.alj9141.cn/http://www.vdf1425.cn/http://www.miv2453.cn/http://www.vdx0926.cn/http://www.smc5776.cn/http://www.ffn3573.cn/http://www.rdj9135.cn/http://www.mtu9335.cn/http://www.gzv8338.cn/http://www.xum5501.cn/http://www.jiq1934.cn/http://www.syh5891.cn/http://www.yvr8830.cn/http://www.aua2439.cn/http://www.ath0401.cn/http://www.gmx2930.cn/http://www.pzf7790.cn/http://www.ass0795.cn/http://www.mox2684.cn/http://www.oqc1977.cn/http://www.bcu6005.cn/http://www.ajj5951.cn/http://www.xwt5617.cn/http://www.rlv0165.cn/http://www.shg1037.cn/http://www.akj0836.cn/http://www.ipc6507.cn/http://www.kri6555.cn/http://www.mzj8672.cn/http://www.azq7227.cn/http://www.zce9839.cn/http://www.gjc9646.cn/http://www.myo1179.cn/http://www.ogr7085.cn/http://www.bah1564.cn/http://www.mjg4415.cn/http://www.dkk2480.cn/http://www.qru6126.cn/http://www.ocs5821.cn/http://www.wne9476.cn/http://www.xuh4863.cn/http://www.icb3050.cn/http://www.tfe0886.cn/ 阅读更多" />
<link rel="canonical" href="http://0.0.0.0:4000/2018/04/25/%E6%B7%B1%E5%85%A5%E4%BB%A5%E5%A4%AA%E5%9D%8A%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6-ABI.html" />
<meta property="og:url" content="http://0.0.0.0:4000/2018/04/25/%E6%B7%B1%E5%85%A5%E4%BB%A5%E5%A4%AA%E5%9D%8A%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6-ABI.html" />
<meta property="og:site_name" content="有组织在！" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-04-25T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"开发 DApp 时要调用在区块链上的以太坊智能合约，就需要智能合约的 ABI。本文希望更多了解 ABI，如为什么需要 ABI？如何解读 Ethereum 的智能合约 ABI？以及如何取得合约的 ABI？ 数字猫合约 ABI ABI（Application Binary Interface） 如果理解 API 就很容易了解 ABI。简单来说，API 是程序与程序间互动的接口。这个接口包含程序提供外界存取所需的 functions、variables 等。ABI 也是程序间互动的接口，但程序是被编译后的 binary code。所以同样的接口，但传递的是 binary 格式的信息。所以 ABI 就要描述如何 decode/encode 程序间传递的 binary 信息。下图以 Linux 为例，描述 Linux 中 API、ABI 和程序的关系。 Linux API and ABI 编译和部署智能合约 在 Ethereum 智能合约可以被大家使用前，必须先被部署到区块链上。 从智能合约的代码到使用智能合约，大概包含几个步骤： 编写智能合约的代码（一般是用 Solidity 写） 编译智能合约的代码变成可在 EVM 上执行的 bytecode（binary code）。同时可以通过编译取得智能合约的 ABI 部署智能合约，实际上是把 bytecode 存储在链上（通过一个transaction），并取得一个专属于这个合约的地址 如果要写个程序调用这个智能合约，就要把信息发送到这个合约的地址（一样的也是通过一个 transaction）。Ethereum 节点会根据输入的信息，选择要执行合约中的哪一个 function 和要输入的参数 而要如何知道這这个智能合约提供哪些 function 以及应该要传入什么样的参数呢？这些信息就是记录在智能合约的 ABI！ Ethereum 智能合约 ABI Ethereum 智能合约 ABI 用一个 array 表示，其中会包含数个用 JSON 格式表示的 Function 或 Event。根据最新的 Solidity 文件： Function 共有 7 个参数： name：a string，function 名称 type：a string，&quot;function&quot;, &quot;constructor&quot;, or &quot;fallback&quot; inputs：an array，function 输入的参数，包含： name：a string，参数名 type：a string，参数的 data type(e.g. uint256) components：an array，如果输入的参数是 tuple(struct) type 才会有这个参数。描述 struct 中包含的参数类型 outputs：an array，function 的返回值，和&nbsp;inputs&nbsp;使用相同表示方式。如果沒有返回值可忽略，值为&nbsp;[] payable：true，function 是否可收 Ether，预设为&nbsp;false constant：true，function 是否会改写区块链状态，反之为&nbsp;false stateMutability：a string，其值可能为以下其中之一：&quot;pure&quot;（不会读写区块链状态）、&quot;view&quot;（只读不写区块链状态）、&quot;payable&quot; and &quot;nonpayable&quot;（会改区块链状态，且如可收 Ether 为 &quot;payable&quot;，反之为 &quot;nonpayable&quot;） 仔细看会发现&nbsp;payable&nbsp;和&nbsp;constant&nbsp;这两个参数所描述的內容，似乎已包含在&nbsp;stateMutability&nbsp;中。 事实也确实是这样的，在&nbsp;Solidity v0.4.16&nbsp;中把&nbsp;constant&nbsp;这个修饰function 的 key words 分成：&nbsp;view（neither reads from nor writes to the state）和&nbsp;pure（does not modify the state），并从 v0.4.17 开始 Type Checker 会强制检查。constant&nbsp;改为只用来修饰不能被修改的 variable。并在 ABI 中加入&nbsp;stateMutability&nbsp;这个参数统一表示，payable&nbsp;和&nbsp;constant&nbsp;目前保留是为了向后兼容。这个改动详细的內容和讨论可参考：https://github.com/ethereum/solidity/issues/992 Event 共有 4 个参数： name: a string，event 的名称 type: a string，always &quot;event&quot; inputs: an array，输入参数，包含： name: a string，参数名称 type: a string，参数的 data type(e.g. uint256) components: an array，如果输入参数是 tuple(struct) type 才会有这个参数。描述 struct 中包含的信息类型 indexed:&nbsp;true，如果这个参数被定义为 indexed ，反之为&nbsp;false anonymous:&nbsp;true，如果 event 被定义为 anonymous 更新智能合约状态需要发送 transaction，transaction 需要等待验证，所以更新合约状态是非同步的，无法马上取得返回值。使用 Event 可以在状态更新成功后，将相关信息记录到 Log，并让监听这个 Event 的 DApp 或任何应用这个接口的程序收到通知。每笔 transaction 都有对应的 Log。 所以简单来说，Event 可用來：1. 取得 function 更新合约状态的返回值 2. 也可作为合约另外的存储空间。 Event 的参数分为：有&nbsp;indexed，和其他没有&nbsp;indexed&nbsp;的。有&nbsp;indexed&nbsp;的参数可以使用 filter，例如同一个 Event，我可以选择只监听从特定 address 发出来的交易。每笔 Log 的信息同样分为两个部分：Topics（长度最多为 4 的 array） 和 Data。有&nbsp;indexed&nbsp;的参数会存储存在 Log 的 Topics，其他的存在 Data。如果定义为&nbsp;anonymous，就不会产生以下示例中的 Topics[0]，其值为 Event signature 的 hash，作为這個 Event 的 ID。 Event event Set(address indexed _from, uint value) 用一个简单的智能合约举个例子 这个智能合约包含： data：一个可修改的 state variable，会自动产生一个只能读取的&nbsp;data()&nbsp;function set()：一个修改&nbsp;data&nbsp;值的 function Set()：一个在每次修写&nbsp;data&nbsp;时记录 Log 的 event 智能合约 Source Code： pragma solidity ^0.4.20; contract SimpleStorage { uint public data; event Set(address indexed _from, uint value); function set(uint x) public { data = x; Set(msg.sender, x); } } 智能合约 ABI： [{ &quot;constant&quot;: true, &quot;inputs&quot;: [], &quot;name&quot;: &quot;data&quot;, &quot;outputs&quot;: [{&quot;name&quot;: &quot;&quot;,&quot;type&quot;: &quot;uint256&quot;}], &quot;payable&quot;: false, &quot;stateMutabㄒility&quot;: &quot;view&quot;, &quot;type&quot;: &quot;function&quot; }, { &quot;anonymous&quot;: false, &quot;inputs&quot;: [{&quot;indexed&quot;: true,&quot;name&quot;: &quot;_from&quot;,&quot;type&quot;: &quot;address&quot;},{&quot;indexed&quot;: false,&quot;name&quot;: &quot;value&quot;,&quot;type&quot;: &quot;uint256&quot;}], &quot;name&quot;: &quot;Set&quot;, &quot;type&quot;: &quot;event&quot; }, { &quot;constant&quot;: false, &quot;inputs&quot;: [{&quot;name&quot;: &quot;x&quot;,&quot;type&quot;: &quot;uint256&quot;}], &quot;name&quot;: &quot;set&quot;, &quot;outputs&quot;: [], &quot;payable&quot;: false, &quot;stateMutability&quot;: &quot;nonpayable&quot;, &quot;type&quot;: &quot;function&quot; }] 取得 Ethereum 智能合约 ABI Solidity Compiler 可以用 Solidity Compiler 取得合约 ABI，我使用 JavaScript 版本的 Compiler 为例。 安装： npm install solc -g 取得合约 ABI： solcjs simpleStorage.sol --abi 会生成一个 simpleStorage_sol_SimpleStorage.abi 文件，里面就是合约ABI 內容。 也可以取得合约的 binary code： solcjs your_contract.sol --bin Remix 同样的使用 Solidity Compiler，也可以用 Remix。在合约的 Details 可以看到完整的 ABI。可以在 Settings 中指定 Compiler 版本。 Remix Etherscan 许多知名合约会把合约 source code 放上 Etherscan 做验证，可以同时看到h 合约ABI。 Etherscan 另外 Etherscan 提供&nbsp;API，可用来取得经过验证的合约 ABI。 http://www.eho1460.cn/http://www.dyy3200.cn/http://www.tdw5546.cn/http://www.mtj9347.cn/http://www.osi0013.cn/http://www.bjb5476.cn/http://www.ghk5310.cn/http://www.xjy3902.cn/http://www.grp2563.cn/http://www.lkg4662.cn/http://www.vwb8311.cn/http://www.mmw6064.cn/http://www.cqz7056.cn/http://www.nlk4583.cn/http://www.adw2245.cn/http://www.alj9141.cn/http://www.vdf1425.cn/http://www.miv2453.cn/http://www.vdx0926.cn/http://www.smc5776.cn/http://www.ffn3573.cn/http://www.rdj9135.cn/http://www.mtu9335.cn/http://www.gzv8338.cn/http://www.xum5501.cn/http://www.jiq1934.cn/http://www.syh5891.cn/http://www.yvr8830.cn/http://www.aua2439.cn/http://www.ath0401.cn/http://www.gmx2930.cn/http://www.pzf7790.cn/http://www.ass0795.cn/http://www.mox2684.cn/http://www.oqc1977.cn/http://www.bcu6005.cn/http://www.ajj5951.cn/http://www.xwt5617.cn/http://www.rlv0165.cn/http://www.shg1037.cn/http://www.akj0836.cn/http://www.ipc6507.cn/http://www.kri6555.cn/http://www.mzj8672.cn/http://www.azq7227.cn/http://www.zce9839.cn/http://www.gjc9646.cn/http://www.myo1179.cn/http://www.ogr7085.cn/http://www.bah1564.cn/http://www.mjg4415.cn/http://www.dkk2480.cn/http://www.qru6126.cn/http://www.ocs5821.cn/http://www.wne9476.cn/http://www.xuh4863.cn/http://www.icb3050.cn/http://www.tfe0886.cn/ 阅读更多","@type":"BlogPosting","url":"http://0.0.0.0:4000/2018/04/25/%E6%B7%B1%E5%85%A5%E4%BB%A5%E5%A4%AA%E5%9D%8A%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6-ABI.html","headline":"深入以太坊智能合约 ABI","dateModified":"2018-04-25T00:00:00+08:00","datePublished":"2018-04-25T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/2018/04/25/%E6%B7%B1%E5%85%A5%E4%BB%A5%E5%A4%AA%E5%9D%8A%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6-ABI.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-123344652-1');
    </script>

  </head>
  <body>
    <div class="wrapper">
      <header  class="without-description" >
        <h1>深入以太坊智能合约 ABI</h1>
        
        
        <ul>
            <li><a href="https://blog.uzzz.org/" target="_blank"><strong>柚子社区<br/>(国际版)</strong></a></li>
            <li><a href="https://blog.uzzz.org.cn/" target="_blank"><strong>柚子社区<br/>(国内版)</strong></a></li>
        </ul>
        
        
        
      </header>
      <section>

      <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-e2445db1a8.css"> 
 <div class="htmledit_views"> 
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">开发 DApp 时要调用在区块链上的以太坊智能合约，就需要智能合约的 ABI。本文希望更多了解 ABI，如为什么需要 ABI？如何解读 Ethereum 的智能合约 ABI？以及如何取得合约的 ABI？</p>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;background-color:rgb(255,255,255);text-align:center;"><img src="https://upload-images.jianshu.io/upload_images/11831773-f937422962fc1f94.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/700" alt="" style="border:0px;"></p>
  <div class="image-package" style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">
   <div class="image-caption" style="text-align:center;">
    数字猫合约 ABI
   </div>
  </div>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">ABI（Application Binary Interface）</p>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">如果理解 API 就很容易了解 ABI。简单来说，API 是程序与程序间互动的接口。这个接口包含程序提供外界存取所需的 functions、variables 等。ABI 也是程序间互动的接口，但程序是被编译后的 binary code。所以同样的接口，但传递的是 binary 格式的信息。所以 ABI 就要描述如何 decode/encode 程序间传递的 binary 信息。下图以 Linux 为例，描述 Linux 中 API、ABI 和程序的关系。</p>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;background-color:rgb(255,255,255);text-align:center;"><img src="https://upload-images.jianshu.io/upload_images/11831773-d07312035b86a7df.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/700" alt="" style="border:0px;"></p>
  <div class="image-package" style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">
   <div class="image-caption" style="text-align:center;">
    Linux API and ABI
   </div>
  </div>
  <h3 style="font-size:16px;line-height:1.5;color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;text-align:left;background-color:rgb(255,255,255);">编译和部署智能合约</h3>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">在 Ethereum 智能合约可以被大家使用前，必须先被部署到区块链上。</p>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">从智能合约的代码到使用智能合约，大概包含几个步骤：</p>
  <ol style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">
   <li>编写智能合约的代码（一般是用 Solidity 写）</li>
   <li>编译智能合约的代码变成可在 EVM 上执行的 bytecode（binary code）。同时可以通过编译取得智能合约的 ABI</li>
   <li>部署智能合约，实际上是把 bytecode 存储在链上（通过一个transaction），并取得一个专属于这个合约的地址</li>
   <li>如果要写个程序调用这个智能合约，就要把信息发送到这个合约的地址（一样的也是通过一个 transaction）。Ethereum 节点会根据输入的信息，选择要执行合约中的哪一个 function 和要输入的参数</li>
  </ol>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">而要如何知道這这个智能合约提供哪些 function 以及应该要传入什么样的参数呢？这些信息就是记录在智能合约的 ABI！</p>
  <h3 style="font-size:16px;line-height:1.5;color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;text-align:left;background-color:rgb(255,255,255);">Ethereum 智能合约 ABI</h3>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">Ethereum 智能合约 ABI 用一个 array 表示，其中会包含数个用 JSON 格式表示的 Function 或 Event。根据最新的 Solidity 文件：</p>
  <h4 style="font-size:14px;color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;text-align:left;background-color:rgb(255,255,255);">Function</h4>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">共有 7 个参数：</p>
  <ol style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">
   <li><p><code>name</code>：a string，function 名称</p></li>
   <li><p><code>type</code>：a string，"function", "constructor", or "fallback"</p></li>
   <li><p><code>inputs</code>：an array，function 输入的参数，包含：</p>
    <ul style="margin-left:30px;">
     <li style="margin-left:0px;list-style:disc;"><p><code>name</code>：a string，参数名</p></li>
     <li style="margin-left:0px;list-style:disc;"><p><code>type</code>：a string，参数的 data type(e.g. uint256)</p></li>
     <li style="margin-left:0px;list-style:disc;"><p><code>components</code>：an array，如果输入的参数是 tuple(struct) type 才会有这个参数。描述 struct 中包含的参数类型</p></li>
    </ul></li>
   <li><p><code>outputs</code>：an array，function 的返回值，和&nbsp;<code>inputs</code>&nbsp;使用相同表示方式。如果沒有返回值可忽略，值为&nbsp;<code>[]</code></p></li>
   <li><p><code>payable</code>：<code>true</code>，function 是否可收 Ether，预设为&nbsp;<code>false</code></p></li>
   <li><p><code>constant</code>：<code>true</code>，function 是否会改写区块链状态，反之为&nbsp;<code>false</code></p></li>
   <li><p><code>stateMutability</code>：a string，其值可能为以下其中之一："pure"（不会读写区块链状态）、"view"（只读不写区块链状态）、"payable" and "nonpayable"（会改区块链状态，且如可收 Ether 为 "payable"，反之为 "nonpayable"）</p></li>
  </ol>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">仔细看会发现&nbsp;<code>payable</code>&nbsp;和&nbsp;<code>constant</code>&nbsp;这两个参数所描述的內容，似乎已包含在&nbsp;<code>stateMutability</code>&nbsp;中。</p>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">事实也确实是这样的，在&nbsp;<a href="https://link.jianshu.com/?t=https%3A%2F%2Fgithub.com%2Fethereum%2Fsolidity%2Freleases" rel="nofollow" style="color:#000000;text-decoration:underline;">Solidity v0.4.16</a>&nbsp;中把&nbsp;<code>constant</code>&nbsp;这个修饰function 的 key words 分成：&nbsp;<code>view</code>（neither reads from nor writes to the state）和&nbsp;<code>pure</code>（does not modify the state），并从 v0.4.17 开始 Type Checker 会强制检查。<code>constant</code>&nbsp;改为只用来修饰不能被修改的 variable。并在 ABI 中加入&nbsp;<code>stateMutability</code>&nbsp;这个参数统一表示，<code>payable</code>&nbsp;和&nbsp;<code>constant</code>&nbsp;目前保留是为了向后兼容。这个改动详细的內容和讨论可参考：<a href="https://link.jianshu.com/?t=https%3A%2F%2Fgithub.com%2Fethereum%2Fsolidity%2Fissues%2F992" rel="nofollow" style="color:#000000;text-decoration:underline;">https://github.com/ethereum/solidity/issues/992</a></p>
  <h4 style="font-size:14px;color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;text-align:left;background-color:rgb(255,255,255);">Event</h4>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">共有 4 个参数：</p>
  <ol style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">
   <li><p><code>name</code>: a string，event 的名称</p></li>
   <li><p><code>type</code>: a string，always "event"</p></li>
   <li><p><code>inputs</code>: an array，输入参数，包含：</p>
    <ul style="margin-left:30px;">
     <li style="margin-left:0px;list-style:disc;"><p><code>name</code>: a string，参数名称</p></li>
     <li style="margin-left:0px;list-style:disc;"><p><code>type</code>: a string，参数的 data type(e.g. uint256)</p></li>
     <li style="margin-left:0px;list-style:disc;"><p><code>components</code>: an array，如果输入参数是 tuple(struct) type 才会有这个参数。描述 struct 中包含的信息类型</p></li>
     <li style="margin-left:0px;list-style:disc;"><p><code>indexed</code>:&nbsp;<code>true</code>，如果这个参数被定义为 indexed ，反之为&nbsp;<code>false</code></p></li>
    </ul></li>
   <li><p><code>anonymous</code>:&nbsp;<code>true</code>，如果 event 被定义为 anonymous</p></li>
  </ol>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">更新智能合约状态需要发送 transaction，transaction 需要等待验证，所以更新合约状态是非同步的，无法马上取得返回值。使用 Event 可以在状态更新成功后，将相关信息记录到 Log，并让监听这个 Event 的 DApp 或任何应用这个接口的程序收到通知。每笔 transaction 都有对应的 Log。</p>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">所以简单来说，Event 可用來：1. 取得 function 更新合约状态的返回值 2. 也可作为合约另外的存储空间。</p>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">Event 的参数分为：有&nbsp;<code>indexed</code>，和其他没有&nbsp;<code>indexed</code>&nbsp;的。有&nbsp;<code>indexed</code>&nbsp;的参数可以使用 filter，例如同一个 Event，我可以选择只监听从特定 address 发出来的交易。每笔 Log 的信息同样分为两个部分：Topics（长度最多为 4 的 array） 和 Data。有&nbsp;<code>indexed</code>&nbsp;的参数会存储存在 Log 的 Topics，其他的存在 Data。如果定义为&nbsp;<code>anonymous</code>，就不会产生以下示例中的 Topics[0]，其值为 Event signature 的 hash，作为這個 Event 的 ID。</p>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;background-color:rgb(255,255,255);text-align:center;"><img src="https://upload-images.jianshu.io/upload_images/11831773-fb419508dfc0d2bc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/700" alt="" style="border:0px;"></p>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;background-color:rgb(255,255,255);text-align:center;">Event</p>
  <div class="cnblogs_code" style="background-color:rgb(245,245,245);border:1px solid rgb(204,204,204);color:rgb(0,0,0);text-align:left;font-family:'Courier New';font-size:12px;">
   <pre style="font-family:'Courier New';"><span style="color:rgb(0,0,255);line-height:1.5;">event</span> Set(address indexed _from, <span style="color:rgb(0,0,255);line-height:1.5;">uint</span> value)</pre>
  </div>
  <h3 style="font-size:16px;line-height:1.5;color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;text-align:left;background-color:rgb(255,255,255);">用一个简单的智能合约举个例子</h3>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">这个智能合约包含：</p>
  <ul style="margin-left:30px;color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">
   <li style="margin-left:0px;"><code>data</code>：一个可修改的 state variable，会自动产生一个只能读取的&nbsp;<code>data()</code>&nbsp;function</li>
   <li style="margin-left:0px;"><code>set()</code>：一个修改&nbsp;<code>data</code>&nbsp;值的 function</li>
   <li style="margin-left:0px;"><code>Set()</code>：一个在每次修写&nbsp;<code>data</code>&nbsp;时记录 Log 的 event</li>
  </ul>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">智能合约 Source Code：</p>
  <div class="cnblogs_code" style="background-color:rgb(245,245,245);border:1px solid rgb(204,204,204);color:rgb(0,0,0);text-align:left;font-family:'Courier New';font-size:12px;">
   <div class="cnblogs_code_toolbar">
    <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:#000000;text-decoration:underline;border:none;"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
   </div>
   <pre style="font-family:'Courier New';">pragma solidity ^<span style="color:rgb(128,0,128);line-height:1.5;">0.4</span>.<span style="color:rgb(128,0,128);line-height:1.5;">20</span><span style="line-height:1.5;">;
contract SimpleStorage {
    </span><span style="color:rgb(0,0,255);line-height:1.5;">uint</span> <span style="color:rgb(0,0,255);line-height:1.5;">public</span><span style="line-height:1.5;"> data;
    </span><span style="color:rgb(0,0,255);line-height:1.5;">event</span> Set(address indexed _from, <span style="color:rgb(0,0,255);line-height:1.5;">uint</span><span style="line-height:1.5;"> value);
    function </span><span style="color:rgb(0,0,255);line-height:1.5;">set</span>(<span style="color:rgb(0,0,255);line-height:1.5;">uint</span> x) <span style="color:rgb(0,0,255);line-height:1.5;">public</span><span style="line-height:1.5;"> {
        data </span>=<span style="line-height:1.5;"> x;
        Set(msg.sender, x);
    }
}</span></pre>
   <div class="cnblogs_code_toolbar">
    <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:#000000;text-decoration:underline;border:none;"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
   </div>
  </div>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">智能合约 ABI：</p>
  <div class="cnblogs_code" style="background-color:rgb(245,245,245);border:1px solid rgb(204,204,204);color:rgb(0,0,0);text-align:left;font-family:'Courier New';font-size:12px;">
   <div class="cnblogs_code_toolbar">
    <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:#000000;text-decoration:underline;border:none;"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
   </div>
   <pre style="font-family:'Courier New';"><span style="line-height:1.5;">[{
        </span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">constant</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>: <span style="color:rgb(0,0,255);line-height:1.5;">true</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">inputs</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">: [],
        </span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">name</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>: <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">data</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">outputs</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>: [{<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">name</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>: <span style="color:rgb(128,0,0);line-height:1.5;">""</span>,<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">type</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>: <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">uint256</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">}],
        </span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">payable</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>: <span style="color:rgb(0,0,255);line-height:1.5;">false</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">stateMutabㄒility</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>: <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">view</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">type</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>: <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">function</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">
    },
    {
        </span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">anonymous</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>: <span style="color:rgb(0,0,255);line-height:1.5;">false</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">inputs</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>: [{<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">indexed</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>: <span style="color:rgb(0,0,255);line-height:1.5;">true</span>,<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">name</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>: <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">_from</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>,<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">type</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>: <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">address</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>},{<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">indexed</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>: <span style="color:rgb(0,0,255);line-height:1.5;">false</span>,<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">name</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>: <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">value</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>,<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">type</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>: <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">uint256</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">}],
        </span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">name</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>: <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">Set</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">type</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>: <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">event</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">
    },
    {
        </span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">constant</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>: <span style="color:rgb(0,0,255);line-height:1.5;">false</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">inputs</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>: [{<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">name</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>: <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">x</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>,<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">type</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>: <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">uint256</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">}],
        </span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">name</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>: <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">set</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">outputs</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">: [],
        </span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">payable</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>: <span style="color:rgb(0,0,255);line-height:1.5;">false</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">stateMutability</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>: <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">nonpayable</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">type</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>: <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">function</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">
}]</span></pre>
   <div class="cnblogs_code_toolbar">
    <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:#000000;text-decoration:underline;border:none;"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
   </div>
  </div>
  <h3 style="font-size:16px;line-height:1.5;color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;text-align:left;background-color:rgb(255,255,255);">取得 Ethereum 智能合约 ABI</h3>
  <h4 style="font-size:14px;color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;text-align:left;background-color:rgb(255,255,255);">Solidity Compiler</h4>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">可以用 Solidity Compiler 取得合约 ABI，我使用 JavaScript 版本的 Compiler 为例。</p>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">安装：</p>
  <div class="cnblogs_code" style="background-color:rgb(245,245,245);border:1px solid rgb(204,204,204);color:rgb(0,0,0);text-align:left;font-family:'Courier New';font-size:12px;">
   <pre style="font-family:'Courier New';">npm install solc -g</pre>
  </div>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">取得合约 ABI：</p>
  <div class="cnblogs_code" style="background-color:rgb(245,245,245);border:1px solid rgb(204,204,204);color:rgb(0,0,0);text-align:left;font-family:'Courier New';font-size:12px;">
   <pre style="font-family:'Courier New';">solcjs simpleStorage.sol --abi</pre>
  </div>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">会生成一个 simpleStorage_sol_SimpleStorage.abi 文件，里面就是合约ABI 內容。</p>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">也可以取得合约的 binary code：</p>
  <div class="cnblogs_code" style="background-color:rgb(245,245,245);border:1px solid rgb(204,204,204);color:rgb(0,0,0);text-align:left;font-family:'Courier New';font-size:12px;">
   <pre style="font-family:'Courier New';">solcjs your_contract.sol --bin</pre>
  </div>
  <h4 style="font-size:14px;color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;text-align:left;background-color:rgb(255,255,255);">Remix</h4>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">同样的使用 Solidity Compiler，也可以用 Remix。在合约的 Details 可以看到完整的 ABI。可以在 Settings 中指定 Compiler 版本。</p>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;background-color:rgb(255,255,255);text-align:center;"><img src="https://upload-images.jianshu.io/upload_images/11831773-4f94ee9fce3e3906.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/700" alt="" style="border:0px;"></p>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;background-color:rgb(255,255,255);text-align:center;">Remix</p>
  <h4 style="font-size:14px;color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;text-align:left;background-color:rgb(255,255,255);">Etherscan</h4>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">许多知名合约会把合约 source code 放上 Etherscan 做验证，可以同时看到h 合约ABI。</p>
  <div class="image-package" style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">
   <div class="image-container">
    <div class="image-view" style="text-align:center;">
     <img src="https://upload-images.jianshu.io/upload_images/11831773-6cd385bc69aca28c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/700" alt="" style="border:0px;">
    </div>
   </div>
   <div class="image-caption" style="text-align:center;">
    Etherscan
   </div>
  </div>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">另外 Etherscan 提供&nbsp;<a href="https://link.jianshu.com/?t=https%3A%2F%2Fetherscan.io%2Fapis%23contracts" rel="nofollow" style="color:#000000;text-decoration:underline;">API</a>，可用来取得经过验证的合约 ABI。</p>
  <p style="color:rgb(0,0,0);font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">http://www.eho1460.cn/<br>http://www.dyy3200.cn/<br>http://www.tdw5546.cn/<br>http://www.mtj9347.cn/<br>http://www.osi0013.cn/<br>http://www.bjb5476.cn/<br>http://www.ghk5310.cn/<br>http://www.xjy3902.cn/<br>http://www.grp2563.cn/<br>http://www.lkg4662.cn/<br>http://www.vwb8311.cn/<br>http://www.mmw6064.cn/<br>http://www.cqz7056.cn/<br>http://www.nlk4583.cn/<br>http://www.adw2245.cn/<br>http://www.alj9141.cn/<br>http://www.vdf1425.cn/<br>http://www.miv2453.cn/<br>http://www.vdx0926.cn/<br>http://www.smc5776.cn/<br>http://www.ffn3573.cn/<br>http://www.rdj9135.cn/<br>http://www.mtu9335.cn/<br>http://www.gzv8338.cn/<br>http://www.xum5501.cn/<br>http://www.jiq1934.cn/<br>http://www.syh5891.cn/<br>http://www.yvr8830.cn/<br>http://www.aua2439.cn/<br>http://www.ath0401.cn/<br>http://www.gmx2930.cn/<br>http://www.pzf7790.cn/<br>http://www.ass0795.cn/<br>http://www.mox2684.cn/<br>http://www.oqc1977.cn/<br>http://www.bcu6005.cn/<br>http://www.ajj5951.cn/<br>http://www.xwt5617.cn/<br>http://www.rlv0165.cn/<br>http://www.shg1037.cn/<br>http://www.akj0836.cn/<br>http://www.ipc6507.cn/<br>http://www.kri6555.cn/<br>http://www.mzj8672.cn/<br>http://www.azq7227.cn/<br>http://www.zce9839.cn/<br>http://www.gjc9646.cn/<br>http://www.myo1179.cn/<br>http://www.ogr7085.cn/<br>http://www.bah1564.cn/<br>http://www.mjg4415.cn/<br>http://www.dkk2480.cn/<br>http://www.qru6126.cn/<br>http://www.ocs5821.cn/<br>http://www.wne9476.cn/<br>http://www.xuh4863.cn/<br>http://www.icb3050.cn/<br>http://www.tfe0886.cn/<br></p> 
 </div> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/shunfa888/article/details/80073081,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/shunfa888/article/details/80073081,&quot;}">阅读更多</a> 
</div>
      <br />
        <a href="https://blog.uzzz.org/">更多精彩内容</a>
      </section>
      
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
        <ul style="display: block;">
          <li><a href="/" style="line-height: 40px;padding-top:0px;">回首页</a></li>
        </ul>
      </header>
      <header style="right: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://blog.uzzz.org.cn/imgqcode.png" style="width:160px;" />
      </header>
      
      <header style="left: 0;position: fixed;bottom: 60px;z-index: 100;background: none;border-bottom:none;">
          <img src="https://blog.uzzz.org.cn/hou_imgqcode.png" style="width:160px;">
      </header>
    </div>
    
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?ee64533f3c6a7a284cd39a37ee732c8b";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
    
    <script>
    (function(){
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        }
        else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
    </script>

  </body>
</html>
