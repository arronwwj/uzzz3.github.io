<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <div class="markdown_views"> 
  <h3 id="bzoj1492-noi2007货币兑换cash"><a href="https://www.lydsy.com/JudgeOnline/problem.php?id=1492" rel="nofollow">bzoj1492: [NOI2007]货币兑换Cash</a></h3> 
  <h4 id="description"><strong>Description</strong></h4> 
  <p>小Y最近在一家金券交易所工作。该金券交易所只发行交易两种金券：A纪念券（以下简称A券）和 B纪念券（以下 <br> 简称B券）。每个持有金券的顾客都有一个自己的帐户。金券的数目可以是一个实数。每天随着市场的起伏波动， <br> 两种金券都有自己当时的价值，即每一单位金券当天可以兑换的人民币数目。我们记录第 K 天中 A券 和 B券 的 <br> 价值分别为 AK 和 BK（元/单位金券）。为了方便顾客，金券交易所提供了一种非常方便的交易方式：比例交易法 <br> 。比例交易法分为两个方面：（a）卖出金券：顾客提供一个 [0,100] 内的实数 OP 作为卖出比例，其意义为：将 <br> OP% 的 A券和 OP% 的 B券 以当时的价值兑换为人民币；（b）买入金券：顾客支付 IP 元人民币，交易所将会兑 <br> 换给用户总价值为 IP 的金券，并且，满足提供给顾客的A券和B券的比例在第 K 天恰好为 RateK；例如，假定接 <br> 下来 3 天内的 Ak、Bk、RateK 的变化分别为： <br> <img src="https://www.lydsy.com/JudgeOnline/upload/201604/dd%281%29.png" alt="这里写图片描述" title=""> <br> 假定在第一天时，用户手中有 100元 人民币但是没有任何金券。用户可以执行以下的操作： <br> <img src="https://www.lydsy.com/JudgeOnline/upload/201604/dd%282%29.png" alt="这里写图片描述" title=""> <br> 注意到，同一天内可以进行多次操作。小Y是一个很有经济头脑的员工，通过较长时间的运作和行情测算，他已经 <br> 知道了未来N天内的A券和B券的价值以及Rate。他还希望能够计算出来，如果开始时拥有S元钱，那么N天后最多能 <br> 够获得多少元钱。</p> 
  <h4 id="input"><strong>Input</strong></h4> 
  <p>输入第一行两个正整数N、S，分别表示小Y能预知的天数以及初始时拥有的钱数。接下来N行，第K行三个实数AK、B <br> K、RateK，意义如题目中所述。对于100%的测试数据，满足：0</p> 
  <h4 id="output"><strong>Output</strong></h4> 
  <p>只有一个实数MaxProfit，表示第N天的操作结束时能够获得的最大的金钱数目。答案保留3位小数。</p> 
  <h4 id="sample-input"><strong>Sample Input</strong></h4> 
  <p>3 100 <br> 1 1 1 <br> 1 2 2 <br> 2 2 3</p> 
  <h4 id="sample-output"><strong>Sample Output</strong></h4> 
  <p>225.000</p> 
  <h3 id="分析"><strong>分析</strong></h3> 
  <p>如果某天的票券很优秀，那么咱们肯定全卖。 <br> 所以要么全买要么不买。 <br> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo stretchy=&quot;false&quot;>]</mo><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mi>f</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo><mo>+</mo><mfrac><mrow><mi>f</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></mrow><mrow><mi>a</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x2217;</mo><mi>r</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo><mo>+</mo><mi>b</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></mrow></mfrac><mo>&amp;#x2217;</mo><mi>a</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo stretchy=&quot;false&quot;>]</mo><mo>+</mo><mfrac><mrow><mi>f</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></mrow><mrow><mi>a</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo><mo>+</mo><mfrac><mrow><mi>b</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></mrow><mrow><mi>r</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></mrow></mfrac></mrow></mfrac><mo>&amp;#x2217;</mo><mi>b</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo stretchy=&quot;false&quot;>]</mo><mo>,</mo><mi>f</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-1" style="width: 31.102em; display: inline-block;"><span style="display: inline-block; position: relative; width: 24.852em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(0.953em 1024.8em 3.552em -999.998em); top: -2.198em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-5" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-6" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-7" style="font-family: MathJax_Main; padding-left: 0.302em;">=</span><span class="mi" id="MathJax-Span-8" style="font-family: MathJax_Math-italic; padding-left: 0.302em;">m</span><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-10" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-11" style="font-family: MathJax_Main;">{</span><span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-13" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-14" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-15" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-16" style="font-family: MathJax_Main; padding-left: 0.202em;">+</span><span class="mfrac" id="MathJax-Span-17" style="padding-left: 0.202em;"><span style="display: inline-block; position: relative; width: 4.053em; height: 0px; margin-right: 0.102em; margin-left: 0.102em;"><span style="position: absolute; clip: rect(3.302em 1001em 4.353em -999.998em); top: -4.598em; left: 50%; margin-left: -0.547em;"><span class="mrow" id="MathJax-Span-18"><span class="mi" id="MathJax-Span-19" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-20" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-21" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-22" style="font-size: 70.7%; font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.302em 1003.85em 4.353em -999.998em); top: -3.548em; left: 50%; margin-left: -1.998em;"><span class="mrow" id="MathJax-Span-23"><span class="mi" id="MathJax-Span-24" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-25" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-26" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-27" style="font-size: 70.7%; font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-28" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span class="mi" id="MathJax-Span-29" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-30" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-31" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-32" style="font-size: 70.7%; font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-33" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-34" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-35" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-36" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-37" style="font-size: 70.7%; font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(0.853em 1004.05em 1.203em -999.998em); top: -1.248em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.053em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.052em;"></span></span></span></span><span class="mo" id="MathJax-Span-38" style="font-family: MathJax_Main; padding-left: 0.202em;">∗</span><span class="mi" id="MathJax-Span-39" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">a</span><span class="mo" id="MathJax-Span-40" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-41" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-42" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-43" style="font-family: MathJax_Main; padding-left: 0.202em;">+</span><span class="mfrac" id="MathJax-Span-44" style="padding-left: 0.202em;"><span style="display: inline-block; position: relative; width: 2.802em; height: 0px; margin-right: 0.102em; margin-left: 0.102em;"><span style="position: absolute; clip: rect(3.302em 1001em 4.353em -999.998em); top: -4.598em; left: 50%; margin-left: -0.547em;"><span class="mrow" id="MathJax-Span-45"><span class="mi" id="MathJax-Span-46" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-47" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-48" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-49" style="font-size: 70.7%; font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.002em 1002.7em 4.652em -999.998em); top: -3.248em; left: 50%; margin-left: -1.347em;"><span class="mrow" id="MathJax-Span-50"><span class="mi" id="MathJax-Span-51" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-52" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-53" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-54" style="font-size: 70.7%; font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-55" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mfrac" id="MathJax-Span-56"><span style="display: inline-block; position: relative; width: 0.853em; height: 0px; margin-right: 0.102em; margin-left: 0.102em;"><span style="position: absolute; clip: rect(3.502em 1000.65em 4.303em -999.998em); top: -4.447em; left: 50%; margin-left: -0.348em;"><span class="mrow" id="MathJax-Span-57"><span class="mi" id="MathJax-Span-58" style="font-size: 50%; font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-59" style="font-size: 50%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-60" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-61" style="font-size: 50%; font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.502em 1000.65em 4.303em -999.998em); top: -3.647em; left: 50%; margin-left: -0.348em;"><span class="mrow" id="MathJax-Span-62"><span class="mi" id="MathJax-Span-63" style="font-size: 50%; font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-64" style="font-size: 50%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-65" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-66" style="font-size: 50%; font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(0.853em 1000.85em 1.203em -999.998em); top: -1.198em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.853em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.052em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(0.853em 1002.8em 1.203em -999.998em); top: -1.248em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.802em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.052em;"></span></span></span></span><span class="mo" id="MathJax-Span-67" style="font-family: MathJax_Main; padding-left: 0.202em;">∗</span><span class="mi" id="MathJax-Span-68" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">b</span><span class="mo" id="MathJax-Span-69" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-70" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-71" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-72" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-73" style="font-family: MathJax_Math-italic; padding-left: 0.152em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-74" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-75" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-76" style="font-family: MathJax_Main; padding-left: 0.202em;">−</span><span class="mn" id="MathJax-Span-77" style="font-family: MathJax_Main; padding-left: 0.202em;">1</span><span class="mo" id="MathJax-Span-78" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-79" style="font-family: MathJax_Main;">}</span></span><span style="display: inline-block; width: 0px; height: 2.202em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.003em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <mi>
       f
      </mi>
      <mo stretchy="false">
       [
      </mo>
      <mi>
       i
      </mi>
      <mo stretchy="false">
       ]
      </mo>
      <mo>
       =
      </mo>
      <mi>
       m
      </mi>
      <mi>
       a
      </mi>
      <mi>
       x
      </mi>
      <mo fence="false" stretchy="false">
       {
      </mo>
      <mi>
       f
      </mi>
      <mo stretchy="false">
       [
      </mo>
      <mi>
       j
      </mi>
      <mo stretchy="false">
       ]
      </mo>
      <mo>
       +
      </mo>
      <mfrac>
       <mrow>
        <mi>
         f
        </mi>
        <mo stretchy="false">
         [
        </mo>
        <mi>
         j
        </mi>
        <mo stretchy="false">
         ]
        </mo>
       </mrow>
       <mrow>
        <mi>
         a
        </mi>
        <mo stretchy="false">
         [
        </mo>
        <mi>
         j
        </mi>
        <mo stretchy="false">
         ]
        </mo>
        <mo>
         ∗
        </mo>
        <mi>
         r
        </mi>
        <mo stretchy="false">
         [
        </mo>
        <mi>
         j
        </mi>
        <mo stretchy="false">
         ]
        </mo>
        <mo>
         +
        </mo>
        <mi>
         b
        </mi>
        <mo stretchy="false">
         [
        </mo>
        <mi>
         j
        </mi>
        <mo stretchy="false">
         ]
        </mo>
       </mrow>
      </mfrac>
      <mo>
       ∗
      </mo>
      <mi>
       a
      </mi>
      <mo stretchy="false">
       [
      </mo>
      <mi>
       i
      </mi>
      <mo stretchy="false">
       ]
      </mo>
      <mo>
       +
      </mo>
      <mfrac>
       <mrow>
        <mi>
         f
        </mi>
        <mo stretchy="false">
         [
        </mo>
        <mi>
         j
        </mi>
        <mo stretchy="false">
         ]
        </mo>
       </mrow>
       <mrow>
        <mi>
         a
        </mi>
        <mo stretchy="false">
         [
        </mo>
        <mi>
         j
        </mi>
        <mo stretchy="false">
         ]
        </mo>
        <mo>
         +
        </mo>
        <mfrac>
         <mrow>
          <mi>
           b
          </mi>
          <mo stretchy="false">
           [
          </mo>
          <mi>
           j
          </mi>
          <mo stretchy="false">
           ]
          </mo>
         </mrow>
         <mrow>
          <mi>
           r
          </mi>
          <mo stretchy="false">
           [
          </mo>
          <mi>
           j
          </mi>
          <mo stretchy="false">
           ]
          </mo>
         </mrow>
        </mfrac>
       </mrow>
      </mfrac>
      <mo>
       ∗
      </mo>
      <mi>
       b
      </mi>
      <mo stretchy="false">
       [
      </mo>
      <mi>
       i
      </mi>
      <mo stretchy="false">
       ]
      </mo>
      <mo>
       ,
      </mo>
      <mi>
       f
      </mi>
      <mo stretchy="false">
       [
      </mo>
      <mi>
       i
      </mi>
      <mo>
       −
      </mo>
      <mn>
       1
      </mn>
      <mo stretchy="false">
       ]
      </mo>
      <mo fence="false" stretchy="false">
       }
      </mo>
     </math></span></span><script type="math/tex" id="MathJax-Element-1">f[i] = max\{f[j]+\frac{f[j]}{a[j]*r[j]+b[j]}*a[i]+\frac{f[j]}{a[j]+\frac{b[j]}{r[j]}}*b[i],f[i-1]\}</script> <br> 然后<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo><mo>=</mo><mfrac><mrow><mi>f</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></mrow><mrow><mi>a</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x2217;</mo><mi>r</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo><mo>+</mo><mi>b</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></mrow></mfrac><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo><mo>=</mo><mfrac><mrow><mi>f</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></mrow><mrow><mi>a</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo><mo>+</mo><mfrac><mrow><mi>b</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></mrow><mrow><mi>r</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></mrow></mfrac></mrow></mfrac></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-80" style="width: 16.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.353em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(0.953em 1013.35em 3.552em -999.998em); top: -2.198em; left: 0em;"><span class="mrow" id="MathJax-Span-81"><span class="mi" id="MathJax-Span-82" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-83" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-84" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-85" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-86" style="font-family: MathJax_Main; padding-left: 0.302em;">=</span><span class="mfrac" id="MathJax-Span-87" style="padding-left: 0.302em;"><span style="display: inline-block; position: relative; width: 4.053em; height: 0px; margin-right: 0.102em; margin-left: 0.102em;"><span style="position: absolute; clip: rect(3.302em 1001em 4.353em -999.998em); top: -4.598em; left: 50%; margin-left: -0.547em;"><span class="mrow" id="MathJax-Span-88"><span class="mi" id="MathJax-Span-89" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-90" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-91" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-92" style="font-size: 70.7%; font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.302em 1003.85em 4.353em -999.998em); top: -3.548em; left: 50%; margin-left: -1.998em;"><span class="mrow" id="MathJax-Span-93"><span class="mi" id="MathJax-Span-94" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-95" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-96" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-97" style="font-size: 70.7%; font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-98" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span class="mi" id="MathJax-Span-99" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-100" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-101" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-102" style="font-size: 70.7%; font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-103" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-104" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-105" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-106" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-107" style="font-size: 70.7%; font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(0.853em 1004.05em 1.203em -999.998em); top: -1.248em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.053em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.052em;"></span></span></span></span><span class="mo" id="MathJax-Span-108" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-109" style="font-family: MathJax_Math-italic; padding-left: 0.152em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-110" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-111" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-112" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-113" style="font-family: MathJax_Main; padding-left: 0.302em;">=</span><span class="mfrac" id="MathJax-Span-114" style="padding-left: 0.302em;"><span style="display: inline-block; position: relative; width: 2.802em; height: 0px; margin-right: 0.102em; margin-left: 0.102em;"><span style="position: absolute; clip: rect(3.302em 1001em 4.353em -999.998em); top: -4.598em; left: 50%; margin-left: -0.547em;"><span class="mrow" id="MathJax-Span-115"><span class="mi" id="MathJax-Span-116" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-117" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-118" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-119" style="font-size: 70.7%; font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.002em 1002.7em 4.652em -999.998em); top: -3.248em; left: 50%; margin-left: -1.347em;"><span class="mrow" id="MathJax-Span-120"><span class="mi" id="MathJax-Span-121" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-122" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-123" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-124" style="font-size: 70.7%; font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-125" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mfrac" id="MathJax-Span-126"><span style="display: inline-block; position: relative; width: 0.853em; height: 0px; margin-right: 0.102em; margin-left: 0.102em;"><span style="position: absolute; clip: rect(3.502em 1000.65em 4.303em -999.998em); top: -4.447em; left: 50%; margin-left: -0.348em;"><span class="mrow" id="MathJax-Span-127"><span class="mi" id="MathJax-Span-128" style="font-size: 50%; font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-129" style="font-size: 50%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-130" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-131" style="font-size: 50%; font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.502em 1000.65em 4.303em -999.998em); top: -3.647em; left: 50%; margin-left: -0.348em;"><span class="mrow" id="MathJax-Span-132"><span class="mi" id="MathJax-Span-133" style="font-size: 50%; font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-134" style="font-size: 50%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-135" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-136" style="font-size: 50%; font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(0.853em 1000.85em 1.203em -999.998em); top: -1.198em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.853em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.052em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(0.853em 1002.8em 1.203em -999.998em); top: -1.248em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.802em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.052em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.202em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.003em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <mi>
       x
      </mi>
      <mo stretchy="false">
       [
      </mo>
      <mi>
       j
      </mi>
      <mo stretchy="false">
       ]
      </mo>
      <mo>
       =
      </mo>
      <mfrac>
       <mrow>
        <mi>
         f
        </mi>
        <mo stretchy="false">
         [
        </mo>
        <mi>
         j
        </mi>
        <mo stretchy="false">
         ]
        </mo>
       </mrow>
       <mrow>
        <mi>
         a
        </mi>
        <mo stretchy="false">
         [
        </mo>
        <mi>
         j
        </mi>
        <mo stretchy="false">
         ]
        </mo>
        <mo>
         ∗
        </mo>
        <mi>
         r
        </mi>
        <mo stretchy="false">
         [
        </mo>
        <mi>
         j
        </mi>
        <mo stretchy="false">
         ]
        </mo>
        <mo>
         +
        </mo>
        <mi>
         b
        </mi>
        <mo stretchy="false">
         [
        </mo>
        <mi>
         j
        </mi>
        <mo stretchy="false">
         ]
        </mo>
       </mrow>
      </mfrac>
      <mo>
       ,
      </mo>
      <mi>
       y
      </mi>
      <mo stretchy="false">
       [
      </mo>
      <mi>
       j
      </mi>
      <mo stretchy="false">
       ]
      </mo>
      <mo>
       =
      </mo>
      <mfrac>
       <mrow>
        <mi>
         f
        </mi>
        <mo stretchy="false">
         [
        </mo>
        <mi>
         j
        </mi>
        <mo stretchy="false">
         ]
        </mo>
       </mrow>
       <mrow>
        <mi>
         a
        </mi>
        <mo stretchy="false">
         [
        </mo>
        <mi>
         j
        </mi>
        <mo stretchy="false">
         ]
        </mo>
        <mo>
         +
        </mo>
        <mfrac>
         <mrow>
          <mi>
           b
          </mi>
          <mo stretchy="false">
           [
          </mo>
          <mi>
           j
          </mi>
          <mo stretchy="false">
           ]
          </mo>
         </mrow>
         <mrow>
          <mi>
           r
          </mi>
          <mo stretchy="false">
           [
          </mo>
          <mi>
           j
          </mi>
          <mo stretchy="false">
           ]
          </mo>
         </mrow>
        </mfrac>
       </mrow>
      </mfrac>
     </math></span></span><script type="math/tex" id="MathJax-Element-2">x[j]=\frac{f[j]}{a[j]*r[j]+b[j]},y[j]=\frac{f[j]}{a[j]+\frac{b[j]}{r[j]}}</script>这俩分别代表那天可以买进的最多票券。 <br> 于是方程就变成了 <br> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo stretchy=&quot;false&quot;>]</mo><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mi>x</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x2217;</mo><mi>a</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo stretchy=&quot;false&quot;>]</mo><mo>+</mo><mi>y</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x2217;</mo><mi>b</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo stretchy=&quot;false&quot;>]</mo><mo>,</mo><mi>f</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-137" style="width: 22.352em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.852em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.302em 1017.8em 2.603em -999.998em); top: -2.198em; left: 0em;"><span class="mrow" id="MathJax-Span-138"><span class="mi" id="MathJax-Span-139" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-140" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-141" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-142" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-143" style="font-family: MathJax_Main; padding-left: 0.302em;">=</span><span class="mi" id="MathJax-Span-144" style="font-family: MathJax_Math-italic; padding-left: 0.302em;">m</span><span class="mi" id="MathJax-Span-145" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-146" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-147" style="font-family: MathJax_Main;">{</span><span class="mi" id="MathJax-Span-148" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-149" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-150" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-151" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-152" style="font-family: MathJax_Main; padding-left: 0.202em;">∗</span><span class="mi" id="MathJax-Span-153" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">a</span><span class="mo" id="MathJax-Span-154" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-155" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-156" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-157" style="font-family: MathJax_Main; padding-left: 0.202em;">+</span><span class="mi" id="MathJax-Span-158" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-159" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-160" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-161" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-162" style="font-family: MathJax_Main; padding-left: 0.202em;">∗</span><span class="mi" id="MathJax-Span-163" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">b</span><span class="mo" id="MathJax-Span-164" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-165" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-166" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-167" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-168" style="font-family: MathJax_Math-italic; padding-left: 0.152em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-169" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-170" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-171" style="font-family: MathJax_Main; padding-left: 0.202em;">−</span><span class="mn" id="MathJax-Span-172" style="font-family: MathJax_Main; padding-left: 0.202em;">1</span><span class="mo" id="MathJax-Span-173" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-174" style="font-family: MathJax_Main;">}</span></span><span style="display: inline-block; width: 0px; height: 2.202em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <mi>
       f
      </mi>
      <mo stretchy="false">
       [
      </mo>
      <mi>
       i
      </mi>
      <mo stretchy="false">
       ]
      </mo>
      <mo>
       =
      </mo>
      <mi>
       m
      </mi>
      <mi>
       a
      </mi>
      <mi>
       x
      </mi>
      <mo fence="false" stretchy="false">
       {
      </mo>
      <mi>
       x
      </mi>
      <mo stretchy="false">
       [
      </mo>
      <mi>
       j
      </mi>
      <mo stretchy="false">
       ]
      </mo>
      <mo>
       ∗
      </mo>
      <mi>
       a
      </mi>
      <mo stretchy="false">
       [
      </mo>
      <mi>
       i
      </mi>
      <mo stretchy="false">
       ]
      </mo>
      <mo>
       +
      </mo>
      <mi>
       y
      </mi>
      <mo stretchy="false">
       [
      </mo>
      <mi>
       j
      </mi>
      <mo stretchy="false">
       ]
      </mo>
      <mo>
       ∗
      </mo>
      <mi>
       b
      </mi>
      <mo stretchy="false">
       [
      </mo>
      <mi>
       i
      </mi>
      <mo stretchy="false">
       ]
      </mo>
      <mo>
       ,
      </mo>
      <mi>
       f
      </mi>
      <mo stretchy="false">
       [
      </mo>
      <mi>
       i
      </mi>
      <mo>
       −
      </mo>
      <mn>
       1
      </mn>
      <mo stretchy="false">
       ]
      </mo>
      <mo fence="false" stretchy="false">
       }
      </mo>
     </math></span></span><script type="math/tex" id="MathJax-Element-3">f[i] = max\{x[j]*a[i]+y[j]*b[i],f[i-1] \}</script> <br> 这是个斜率Dp的形式。 <br> 化斜截 <br> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo><mo>=</mo><mfrac><mrow><mi>f</mi><mo stretchy=&quot;false&quot;>[</mo><mi>i</mi><mo stretchy=&quot;false&quot;>]</mo></mrow><mrow><mi>b</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></mrow></mfrac><mo>&amp;#x2212;</mo><mfrac><mrow><mi>a</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></mrow><mrow><mi>b</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></mrow></mfrac><mo>&amp;#x2217;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-175" style="width: 11.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.152em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(0.953em 1009.05em 2.952em -999.998em); top: -2.198em; left: 0em;"><span class="mrow" id="MathJax-Span-176"><span class="mi" id="MathJax-Span-177" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-178" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-179" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-180" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-181" style="font-family: MathJax_Main; padding-left: 0.302em;">=</span><span class="mfrac" id="MathJax-Span-182" style="padding-left: 0.302em;"><span style="display: inline-block; position: relative; width: 1.153em; height: 0px; margin-right: 0.102em; margin-left: 0.102em;"><span style="position: absolute; clip: rect(3.302em 1000.95em 4.353em -999.998em); top: -4.598em; left: 50%; margin-left: -0.497em;"><span class="mrow" id="MathJax-Span-183"><span class="mi" id="MathJax-Span-184" style="font-size: 70.7%; font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.053em;"></span></span><span class="mo" id="MathJax-Span-185" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-186" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-187" style="font-size: 70.7%; font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.302em 1000.9em 4.353em -999.998em); top: -3.548em; left: 50%; margin-left: -0.497em;"><span class="mrow" id="MathJax-Span-188"><span class="mi" id="MathJax-Span-189" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-190" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-191" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-192" style="font-size: 70.7%; font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(0.853em 1001.15em 1.203em -999.998em); top: -1.248em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.153em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.052em;"></span></span></span></span><span class="mo" id="MathJax-Span-193" style="font-family: MathJax_Main; padding-left: 0.202em;">−</span><span class="mfrac" id="MathJax-Span-194" style="padding-left: 0.202em;"><span style="display: inline-block; position: relative; width: 1.203em; height: 0px; margin-right: 0.102em; margin-left: 0.102em;"><span style="position: absolute; clip: rect(3.302em 1000.95em 4.353em -999.998em); top: -4.598em; left: 50%; margin-left: -0.547em;"><span class="mrow" id="MathJax-Span-195"><span class="mi" id="MathJax-Span-196" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-197" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-198" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-199" style="font-size: 70.7%; font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(3.302em 1000.9em 4.353em -999.998em); top: -3.548em; left: 50%; margin-left: -0.497em;"><span class="mrow" id="MathJax-Span-200"><span class="mi" id="MathJax-Span-201" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-202" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-203" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-204" style="font-size: 70.7%; font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 4.002em;"></span></span><span style="position: absolute; clip: rect(0.853em 1001.2em 1.203em -999.998em); top: -1.248em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.203em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.052em;"></span></span></span></span><span class="mo" id="MathJax-Span-205" style="font-family: MathJax_Main; padding-left: 0.202em;">∗</span><span class="mi" id="MathJax-Span-206" style="font-family: MathJax_Math-italic; padding-left: 0.202em;">x</span><span class="mo" id="MathJax-Span-207" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-208" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-209" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.202em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.809em; border-left: 0px solid; width: 0px; height: 2.253em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <mi>
       y
      </mi>
      <mo stretchy="false">
       [
      </mo>
      <mi>
       j
      </mi>
      <mo stretchy="false">
       ]
      </mo>
      <mo>
       =
      </mo>
      <mfrac>
       <mrow>
        <mi>
         f
        </mi>
        <mo stretchy="false">
         [
        </mo>
        <mi>
         i
        </mi>
        <mo stretchy="false">
         ]
        </mo>
       </mrow>
       <mrow>
        <mi>
         b
        </mi>
        <mo stretchy="false">
         [
        </mo>
        <mi>
         j
        </mi>
        <mo stretchy="false">
         ]
        </mo>
       </mrow>
      </mfrac>
      <mo>
       −
      </mo>
      <mfrac>
       <mrow>
        <mi>
         a
        </mi>
        <mo stretchy="false">
         [
        </mo>
        <mi>
         j
        </mi>
        <mo stretchy="false">
         ]
        </mo>
       </mrow>
       <mrow>
        <mi>
         b
        </mi>
        <mo stretchy="false">
         [
        </mo>
        <mi>
         j
        </mi>
        <mo stretchy="false">
         ]
        </mo>
       </mrow>
      </mfrac>
      <mo>
       ∗
      </mo>
      <mi>
       x
      </mi>
      <mo stretchy="false">
       [
      </mo>
      <mi>
       j
      </mi>
      <mo stretchy="false">
       ]
      </mo>
     </math></span></span><script type="math/tex" id="MathJax-Element-4">y[j]=\frac{f[i]}{b[j]}-\frac{a[j]}{b[j]}*x[j]</script> <br> 也就是对于一些固定点<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>[</mo><mi>j</mi><mo stretchy=&quot;false&quot;>]</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-210" style="width: 5.202em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.152em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.302em 1004.05em 2.603em -999.998em); top: -2.198em; left: 0em;"><span class="mrow" id="MathJax-Span-211"><span class="mo" id="MathJax-Span-212" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-213" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-214" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-215" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-216" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-217" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-218" style="font-family: MathJax_Math-italic; padding-left: 0.152em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-219" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-220" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-221" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-222" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.202em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <mo stretchy="false">
       (
      </mo>
      <mi>
       x
      </mi>
      <mo stretchy="false">
       [
      </mo>
      <mi>
       j
      </mi>
      <mo stretchy="false">
       ]
      </mo>
      <mo>
       ,
      </mo>
      <mi>
       y
      </mi>
      <mo stretchy="false">
       [
      </mo>
      <mi>
       j
      </mi>
      <mo stretchy="false">
       ]
      </mo>
      <mo stretchy="false">
       )
      </mo>
     </math></span></span><script type="math/tex" id="MathJax-Element-5">(x[j],y[j])</script> 我们有一条固定斜率的直线要去截他们，要使得纵截距最大。 <br> 搞凸包就好了。 <br> 如果横坐标单调的话，一个斜率优化Dp就可以了。 <br> 然而这里不是单调的，需要动态维护凸包。 <br> 但是有一种更神奇的方法，就是cdq分治。 <br> 指考虑左区间对右区间的影响。我们可以把左区间按照横坐标排序(一个归并)，这样的话搞凸包就是线性的。 <br> 然后右区间按照斜率排序，转移。 <br> 最后递归右区间，归并。 <br> 复杂度每层只会跑一个线性，所以是<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;">
    <nobr aria-hidden="true">
     <span class="math" id="MathJax-Span-223" style="width: 5.103em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.053em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.302em 1003.95em 2.603em -999.998em); top: -2.198em; left: 0em;"><span class="mrow" id="MathJax-Span-224"><span class="mi" id="MathJax-Span-225" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-226" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-227" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-228" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-229" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-230" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-231" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-232" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.202em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span>
    </nobr><span class="MJX_Assistive_MathML" role="presentation">
     <math xmlns="http://www.w3.org/1998/Math/MathML">
      <mi>
       O
      </mi>
      <mo stretchy="false">
       (
      </mo>
      <mi>
       n
      </mi>
      <mi>
       l
      </mi>
      <mi>
       o
      </mi>
      <mi>
       g
      </mi>
      <mi>
       n
      </mi>
      <mo stretchy="false">
       )
      </mo>
     </math></span></span><script type="math/tex" id="MathJax-Element-6">O(nlogn)</script></p> 
  <h4 id="模板"><strong>模板</strong></h4> 
  <blockquote> 
   <p>1.递归左区间 <br> 2.线性求出左区间凸包 <br> 3.左区间转移到右区间 <br> 4.递归右区间 <br> 5.归并排序</p> 
  </blockquote> 
  <h3 id="代码"><strong>代码</strong></h3> 
  <pre class="prettyprint"><code class=" hljs perl"><span class="hljs-comment">#include&lt;cstdio&gt;</span>
<span class="hljs-comment">#include&lt;algorithm&gt;</span>
<span class="hljs-comment">#include&lt;cmath&gt;</span>
const <span class="hljs-keyword">int</span> N = <span class="hljs-number">1</span>e5 + <span class="hljs-number">10</span>; const double eps = <span class="hljs-number">1</span>e-<span class="hljs-number">10</span>;
<span class="hljs-keyword">int</span> n, h[N]; double f[N];
struct data {
    double a, b, <span class="hljs-keyword">x</span>, <span class="hljs-keyword">y</span>, k, r; <span class="hljs-keyword">int</span> id;
    void In(<span class="hljs-keyword">int</span> i) {scanf(<span class="hljs-string">"<span class="hljs-variable">%lf</span><span class="hljs-variable">%lf</span><span class="hljs-variable">%lf</span>"</span>, &amp;a, &amp;b, &amp;r); k = -a / b; id = i;}
    void Get() {<span class="hljs-keyword">y</span> = f[id] / (a * r + b); <span class="hljs-keyword">x</span> = <span class="hljs-keyword">y</span> * r;}
    void Tra(data j) {f[id] = std::max(f[id], j.<span class="hljs-keyword">x</span> * a + j.<span class="hljs-keyword">y</span> * b);}
    bool operator &lt; (data b) {<span class="hljs-keyword">return</span> fabs(<span class="hljs-keyword">x</span> - b.<span class="hljs-keyword">x</span>) &lt; eps ? <span class="hljs-keyword">y</span> &lt; b.<span class="hljs-keyword">y</span> : <span class="hljs-keyword">x</span> &lt; b.<span class="hljs-keyword">x</span>;}
}p[N], <span class="hljs-string">q[N]</span>;
bool cmp(data a, data b) {<span class="hljs-keyword">return</span> a.k &gt; b.k;}
double K(<span class="hljs-keyword">int</span> i, <span class="hljs-keyword">int</span> j) {
    double dx = p[i].<span class="hljs-keyword">x</span> - p[j].<span class="hljs-keyword">x</span>, dy = p[i].<span class="hljs-keyword">y</span> - p[j].<span class="hljs-keyword">y</span>;
    <span class="hljs-keyword">return</span> !j ? -<span class="hljs-number">1</span>e2<span class="hljs-number">0</span> : (fabs(dx) &lt; eps ? <span class="hljs-number">1</span>e2<span class="hljs-number">0</span> : dy / dx);
}
void Solve(<span class="hljs-keyword">int</span> L, <span class="hljs-keyword">int</span> R) {
    <span class="hljs-keyword">if</span>(L == R) {f[L] = std::max(f[L], f[L - <span class="hljs-number">1</span>]); <span class="hljs-keyword">return</span> p[L].Get();}
    <span class="hljs-keyword">int</span> <span class="hljs-keyword">m</span> = L + R &gt;&gt; <span class="hljs-number">1</span>, <span class="hljs-keyword">s</span> = L, t = <span class="hljs-keyword">m</span> + <span class="hljs-number">1</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = L; i &lt;= R; ++i) p[i].id &lt;= <span class="hljs-keyword">m</span> ? <span class="hljs-string">q[s++]</span> = p[i] : <span class="hljs-string">q[t++]</span> = p[i];
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = L; i &lt;= R; ++i) p[i] = <span class="hljs-string">q[i]</span>;
    Solve(L, <span class="hljs-keyword">m</span>); <span class="hljs-keyword">int</span> tp = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = L;i &lt;= <span class="hljs-keyword">m</span>; ++i) {
        <span class="hljs-keyword">for</span>(;tp &gt; <span class="hljs-number">1</span> &amp;&amp; K(h[tp], i) + eps &gt; K(h[tp], h[tp - <span class="hljs-number">1</span>]);) --tp; 
        h[++tp] = i;
    }
    h[tp + <span class="hljs-number">1</span>] = <span class="hljs-number">0</span>; tp = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-keyword">m</span> + <span class="hljs-number">1</span>; i &lt;= R; ++i) {
        <span class="hljs-keyword">for</span>(;K(h[tp], h[tp + <span class="hljs-number">1</span>]) + eps &gt; p[i].k ;) ++tp;
        p[i].Tra(p[h[tp]]);
    }
    Solve(<span class="hljs-keyword">m</span> + <span class="hljs-number">1</span>, R); <span class="hljs-keyword">s</span> = L, t = <span class="hljs-keyword">m</span> + <span class="hljs-number">1</span>; tp = L;
    <span class="hljs-keyword">for</span>(;<span class="hljs-keyword">s</span> &lt;= <span class="hljs-keyword">m</span> &amp;&amp; t &lt;= R; ) p[<span class="hljs-keyword">s</span>] &lt; p[t] ? <span class="hljs-string">q[tp++]</span> = p[<span class="hljs-keyword">s</span>++] : <span class="hljs-string">q[tp++]</span> = p[t++];
    <span class="hljs-keyword">for</span>(;<span class="hljs-keyword">s</span> &lt;= <span class="hljs-keyword">m</span>;) <span class="hljs-string">q[tp++]</span> = p[<span class="hljs-keyword">s</span>++]; <span class="hljs-keyword">for</span>(;t &lt;= R;) <span class="hljs-string">q[tp++]</span> = p[t++];
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = L;i &lt;= R; ++i) p[i] = <span class="hljs-string">q[i]</span>;
}
<span class="hljs-keyword">int</span> main() {
    scanf(<span class="hljs-string">"<span class="hljs-variable">%d</span><span class="hljs-variable">%lf</span>"</span>, &amp;n, &amp;f[<span class="hljs-number">0</span>]);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>;i &lt;= n; ++i) p[i].In(i);
    std::<span class="hljs-keyword">sort</span>(p + <span class="hljs-number">1</span>, p + n + <span class="hljs-number">1</span>, cmp);
    Solve(<span class="hljs-number">1</span>, n); <span class="hljs-keyword">printf</span>(<span class="hljs-string">"<span class="hljs-variable">%.</span>3lf\n"</span>, f[n]);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
?</code></pre> 
 </div> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/markdown_views-ea0013b516.css"> 
</div> 
<div class="hide-article-box text-center"> 
 <a class="btn btn-red-hollow" id="btn-readmore" data-track-view="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/lvzelong2014/article/details/81065723,&quot;}" data-track-click="{&quot;mod&quot;:&quot;popu_376&quot;,&quot;con&quot;:&quot;,https://blog.csdn.net/lvzelong2014/article/details/81065723,&quot;}">阅读更多</a> 
</div>